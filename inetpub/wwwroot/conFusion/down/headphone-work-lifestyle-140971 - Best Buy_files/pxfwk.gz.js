/*!
 * 24/7 Customer, Inc. Confidential, Do Not Distribute. This is an
 * unpublished, proprietary work which is fully protected under
 * copyright law. This code may only be used pursuant to a valid
 * license from 24/7 Customer, Inc.
 */
function $A(a){if(!a)return[];var b=a.length||0,c=new Array(b);while(b--)c[b]=a[b];return c}function $w(a){return typeof a!="string"?[]:(a=a.replace(/^\s+/,"").replace(/\s+$/,""),a?a.split(/\s+/):[])}function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}return typeof a=="string"&&(a=document.getElementById(a)),Element.extend(a)}function $H(a){return new Hash(a)}function $undefined(a){return Object.isUndefined(a)}function $undefinedOrNull(a){return SN.Utils.isUndefinedOrNull(a)}function $isArray(a){return Object.isArray(a)}function $isNumber(a){return Object.isNumber(a)}function $isFunction(a){return Object.isFunction(a)}function $isString(a){return Object.isString(a)}function $isEmpty(a){return SN.Utils.isEmpty(a)}function $startsWith(a,b){return SN.Utils.patternMatch(a,b+".*")}function $endsWith(a,b){return SN.Utils.patternMatch(a,".*"+b)}function $contains(a,b){return SN.Utils.patternMatch(a,".*"+b+".*")}function $patternMatch(a,b){return SN.Utils.patternMatch(a,b)}function $appendHTMLTag(a,b,c,d){return SN.Utils.appendHTMLTag(a,b,c,d)}function $timeOnSite(){return SN.Utils.getTimeOnSite()}function $averageTimeOnPage(){return SN.Utils.getAverageTimeOnPage()}function $isRepeatVisitor(){var a=SN.Constants,b=SN.StoreManager.getValueFromStore(a.SN_VI_STORE_NAME,SN.Constants.PREVIOUS_ACTIVE_SESSION_TIME);if($undefinedOrNull(b))return!1;var c=(new Date).getTime(),d=c-b;return d<SN.ConfigurationManager.getRepeatVisitorLifetime()?!0:!1}function $getMetaTagInformation(a){var b=parent.document.getElementsByTagName("meta");for(var c=0;c<b.length;c++)try{if(b[c].name&&b[c].name==a||b[c]["http=equiv"]&&b[c]["http=equiv"]==a)return b[c].content}catch(d){SN.Utils.error("Unable to capture the metatag value",d)}return null}function $getActiveSessionStartTime(){return SN.StoreManager.getValueFromStore(SN.Constants.SN_VI_STORE_NAME,SN.Constants.ACTIVE_SESSION_START_TIME)}function $getPreviousActiveSessionStartTime(){return SN.StoreManager.getValueFromStore(SN.Constants.SN_VI_STORE_NAME,SN.Constants.PREVIOUS_ACTIVE_SESSION_TIME)}function $getClientTimeStamp(){return SN.Utils.getClientTimeStamp()}function $getClientTimeZoneOffsetInMilliSeconds(){return SN.Utils.getClientTimeZoneOffsetInMilliSeconds()}function $getGeoPrivateIp(){return SN.Utils.getGeoPrivateIp()}function $getGeoLatitudeBrowser(){var a=window.localStorage.getItem(SN.Constants.BROWSER_GEO_LOCATION);return a==null?"null":a.split(SN.Constants.KEY_SEPERATOR)[0].split(SN.Constants.KEY_VALUE_SEPERATOR)[1]}function $getGeoLongitudeBrowser(){var a=window.localStorage.getItem(SN.Constants.BROWSER_GEO_LOCATION);return a==null?"null":a.split(SN.Constants.KEY_SEPERATOR)[1].split(SN.Constants.KEY_VALUE_SEPERATOR)[1]}function $getGeoBrowserLocationError(){var a=window.localStorage.getItem(SN.Constants.BROWSER_GEO_LOCATION);return a==null?"ue":a.split(SN.Constants.KEY_SEPERATOR)[0].split(SN.Constants.KEY_VALUE_SEPERATOR)[1]}function $geoCountry(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.country}function $geoCity(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.city}function $geoRegion(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.region}function $geoPostalCode(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.zipcode}function $geoLatitude(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.lat}function $geoLongitude(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.lon}function $geoMetro(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.metro}function $geoArea(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.area}function $geoIsp(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.isp))return;return a.isp.name}function $geoIPAddress(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.isp))return;return a.isp.ip}function $geoOrganization(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.isp))return;return a.isp.org}function $geoCountryCode(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.location))return;return a.location.countryCode}function $geoBandwidth(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.isp))return;return a.isp.bandwidth}function $geoHost(){var a=SN.ConfigurationManager.getGeoInfo();if($undefinedOrNull(a)||$undefinedOrNull(a.isp))return;return a.isp.hostname}function $cookieExists(a){var b=new SN.CookieManager;return!$undefinedOrNull(b.readCookie(a))}function $cookieGet(a){var b=new SN.CookieManager;return b.readCookie(a)}function $cookieSet(a,b,c){var d=new SN.CookieManager;return d.createCookie(a,b,c)}function $onGetDataFromServer(a,b){SN.ServerStoremanager.onGetDataFromServer(a,b)}function $getData(a){return SN.StoreManager.getValueFromStore("sn.vc",a)}function $setData(a,b){SN.StoreManager.setValueInStore("sn.vc",a,b)}function $removeData(a){SN.StoreManager.deleteValueFromStore("sn.vc",a)}function $lastExitLink(){return SN.ExitHistory.getLastExitLink()}function startSessionAsync(a,b,c){if(a.fireflyAPI.startAPI!=null){apiKey=b.apiKey,cobrowseMode=b.cobrowseMode,fieldMaskingConfig=b.fieldMaskingConfig;try{var d=a.eventListeners[CobrowseVendor.Events.COBROWSE_INITIALIZED],e=a.eventListeners[CobrowseVendor.Events.COBROWSE_STARTED],f=a.eventListeners[CobrowseVendor.Events.COBROWSE_SESSION_UPDATED],g=a.eventListeners[CobrowseVendor.Events.COBROWSE_ENDED],h=a.eventListeners[CobrowseVendor.Events.COBROWSE_PARTICIPANT_JOINED];a.fireflyAPI.on("cobrowsingRequested",e),a.fireflyAPI.on("sessionDataUpdated",f),a.fireflyAPI.on("cobrowsingEnded",g),a.fireflyAPI.on("cobrowsingStarted",h),fieldMaskingConfig&&a.fireflyAPI.set("masking",JSON.parse(fieldMaskingConfig)),b.secureUrl!=null&&a.fireflyAPI.set("secureUrl",b.secureUrl),a.fireflyAPI.startAPI(apiKey,d)}catch(i){}}else{if(c==0)return;setTimeout(function(){startSessionAsync(a,b,--c)},1e3)}}function start247SessionAsync(a,b,c){typeof parent.isInit=="boolean"&&parent.isInit==1&&typeof parent.CreateSession=="function"?b.cobrowseMode=="CO_BROWSE"?parent.CreateSession("cobrowse",a.eventListeners[CobrowseVendor.Events.COBROWSE_INITIALIZED],a.eventListeners[CobrowseVendor.Events.COBROWSE_STARTED],this.coBrowse247API.sessionTimeout):parent.CreateSession("coview",a.eventListeners[CobrowseVendor.Events.COBROWSE_INITIALIZED],a.eventListeners[CobrowseVendor.Events.COBROWSE_STARTED],this.coBrowse247API.sessionTimeout):c!=0&&setTimeout(function(){start247SessionAsync(a,b,--c)},1e3)}function continueSessionAsync(a,b,c){if(a.continueSession!=null)a.continueSession(b);else{if(c==0)return;setTimeout(function(){continueSessionAsync(a,b,--c)},1e3)}}function continue247SessionAsync(a,b,c){typeof parent.isInit=="boolean"&&parent.isInit==1&&typeof parent.ContinueSession=="function"?parent.ContinueSession(b):c!=0&&setTimeout(function(){continue247SessionAsync(a,b,--c)},1e3)}function getPageIdExpression(){var a=location.host.indexOf("espanol")==0?"espanol":"english";return parent.document.getElementById("px-span-chat-now")&&parent.document.getElementById("px-mobile-misc")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-chat-now","px-mobile-misc"]),"bestbuySpanChatNowAndMobile"):parent.document.getElementById("px-mobile-help")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-mobile-help"]),"bestbuyMobileHelp"):parent.document.getElementById("px-span-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-chat-now"]),"bestbuySpanChatNow"):parent.document.getElementById("px-span-checkout1-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout1-chat-now"]),"bestbuyCheckout1ChatNow"):parent.document.getElementById("px-span-checkout2-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout2-chat-now"]),"bestbuyCheckout2ChatNow"):parent.document.getElementById("px-chat-online")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-chat-online"]),"bestbuyChatOnline"):parent.document.getElementById("px-span-checkout4-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout4-chat-now"]),"bestbuyCheckout4ChatNow"):parent.document.getElementById("px-span-checkout3-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout3-chat-now"]),"bestbuyCheckout3ChatNow"):parent.document.getElementById("px-mobile-misc")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-mobile-misc"]),"bestbuyMobileMisc"):parent.document.getElementById("px-span-checkout5-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout5-chat-now"]),"bestbuyCheckout5ChatNow"):parent.document.getElementById("px-span-checkout6-chat-now")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-span-checkout6-chat-now"]),"bestbuyCheckout6ChatNow"):parent.document.getElementById("px-computing")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-computing"]),"bestbuyComputing"):parent.document.getElementById("px-tablets-ereaders")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-tablets-ereaders"]),"bestbuyTabletsEreaders"):parent.document.getElementById("px-home-theater")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-home-theater"]),"bestbuyHomeTheater"):parent.document.getElementById("px-appliances")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-appliances"]),"bestbuyAppliances"):parent.document.getElementById("px-services")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-services"]),"bestbuyServices"):parent.document.getElementById("px-gift")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-gift"]),"bestbuyGift"):parent.document.getElementById("px-scheduler")&&a=="english"?(SN.CustomScript.setQueueId("en",["px-scheduler"]),"bestbuyScheduler"):parent.location.href.indexOf("247chat.html#")>0&&parent.location.href.indexOf("r=directchat.gz.js")>0&&parent.location.href.indexOf("id=scheduler")>0?($setData("queue","bestbuy-Scheduler-queue"),"bestbuy_directchat_window"):parent.location.href.indexOf("247chat.html#")>0&&parent.location.href.indexOf("r=directchat.gz.js")>0&&parent.location.href.indexOf("id=trainingApp")>0?($setData("queue","bestbuy-Training"),"bestbuy_directchat_window"):parent.location.href.indexOf("247chat.html#")>0&&parent.location.href.indexOf("r=directchat.gz.js")>0?($setData("queue","bestbuy-Service-Queue"),"bestbuy_directchat_window"):parent.document.getElementById("px-expertService")&&a=="english"?($setData("queue","expertSerivice-queue"),"bestbuyExpertService"):parent.document.getElementById("px-button-chat")&&a=="english"?($setData("queue","bestbuy-BBFB-Sales-queue"),"bbfb_tagged_page"):parent.document.getElementById("px-button-chat-gs")&&a=="english"?($setData("queue","bestbuy-BBFB-Sales-queue"),"bbfb_tagged_page_gs"):"bestbuy_tagged_page"}function getPageDivId(){var a=["px-span-chat-now","px-mobile-misc","px-span-checkout1-chat-now","px-span-checkout2-chat-now","px-chat-online","px-span-checkout4-chat-now","px-span-checkout3-chat-now","px-mobile-help","px-span-checkout5-chat-now","px-span-checkout6-chat-now","px-service-page-chat","px-my-account","px-product-launch","px-appliance-1","px-appliance-2","px-computing","px-tablets-ereaders","px-home-theater","px-appliances","px-pe-entertainment","px-services","px-gift","px-scheduler","px-expertService","px-button-chat","px-button-chat-gs"];for(var b=0,c=a.length;b<c;b++)if(parent.document.getElementById(a[b]))return a[b];return""}function updatePageDivId(){var a=getPageDivId();$setData("divId",a)}function getWebTrackIdExpression(){return"wti"}function $keepAliveActiveSession(){SN.SessionManager.getGlobalSession().keepAliveActiveSession()}function $activeSessionId(){return SN.SessionManager.getGlobalSession().getActiveSessionId()}function $activeSessionCount(){return SN.SessionManager.getGlobalSession().getActiveSessionId()}var Prototype={Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a)}}(),BrowserFeatures:{ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!a&&!!a.prototype}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!="undefined")return!0;var a=document.createElement("div"),b=document.createElement("form"),c=!1;return a.__proto__&&a.__proto__!==b.__proto__&&(c=!0),a=b=null,c}()},emptyFunction:function(){},K:function(a){return a}},Class=function(){function a(){}function b(){function d(){this.initialize.apply(this,arguments)}var b=null,c=$A(arguments);Object.isFunction(c[0])&&(b=c.shift()),Object.extend(d,Class.Methods),d.superclass=b,d.subclasses=[],b&&(a.prototype=b.prototype,d.prototype=new a,b.subclasses.push(d));for(var e=0;e<c.length;e++)d.addMethods(c[e]);return d.prototype.initialize||(d.prototype.initialize=Prototype.emptyFunction),d.prototype.constructor=d,d}function c(a){var b=this.superclass&&this.superclass.prototype,c=Object.keys(a);Object.keys({toString:!0}).length||(a.toString!=Object.prototype.toString&&c.push("toString"),a.valueOf!=Object.prototype.valueOf&&c.push("valueOf"));for(var d=0,e=c.length;d<e;d++){var f=c[d],g=a[f];if(b&&Object.isFunction(g)&&g.argumentNames().first()=="$super"){var h=g;g=function(a){return function(){return b[a].apply(this,arguments)}}(f).wrap(h),g.valueOf=h.valueOf.bind(h),g.toString=h.toString.bind(h)}this.prototype[f]=g}return this}return{create:b,Methods:{addMethods:c}}}(),JSON;(function(){function extend(a,b){for(var c in b)a[c]=b[c];return a}function clone(a){return extend({},a)}function isElement(a){return!!a&&a.nodeType==1}function isArray(a){return _toString.call(a)=="[object Array]"}function isHash(a){return a instanceof Hash}function isFunction(a){return typeof a=="function"}function isString(a){return _toString.call(a)=="[object String]"}function isNumber(a){return _toString.call(a)=="[object Number]"}function isUndefined(a){return typeof a=="undefined"}function keys(a){var b=[];for(var c in a)b.push(c);return b}var _toString=Object.prototype.toString;JSON=function(){function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d=="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}function stringify(a,b,c){var d;gap="",indent="";if(a!=null&&typeof a=="object"&&typeof a.length=="number")return a.toJSON();if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}function parse(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;return JSON&&JSON.stringify&&JSON.parse?{stringify:JSON.stringify,parse:JSON.parse}:{stringify:stringify,parse:parse}}(),extend(Object,{keys:keys,extend:extend,isElement:isElement,isUndefined:isUndefined,isNumber:isNumber,isString:isString,isArray:isArray,isHash:isHash,isFunction:isFunction,clone:clone,toJSON:JSON.stringify})})(),Object.extend(Function.prototype,function(){function b(a,b){var c=a.length,d=b.length;while(d--)a[c+d]=b[d];return a}function c(c,d){return c=a.call(c,0),b(c,d)}function d(){var a=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return a.length==1&&!a[0]?[]:a}function e(){if(!arguments.length)return this;var b=this,d=a.call(arguments,0);return function(){var a=c(d,arguments);return b.apply(this,a)}}function f(b){if(arguments.length<2&&typeof arguments[0]=="undefined")return this;var d=this,e=a.call(arguments,1);return function(){var a=c(e,arguments);return d.apply(b,a)}}function g(c){var d=this,e=a.call(arguments,1);return function(a){var f=b([a||window.event],e);return d.apply(c,f)}}function h(){if(this._methodized)return this._methodized;var a=this;return this._methodized=function(){var c=b([this],arguments);return a.apply(null,c)}}var a=Array.prototype.slice;return{argumentNames:d,bind:f,bindAsEventListener:g,methodize:h,curry:e}}()),Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'},RegExp.prototype.match=RegExp.prototype.test,RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}}),Object.extend(String.prototype,function(){function inspect(a){var b=this.replace(/[\x00-\x1f\\]/g,function(a){return a in String.specialChar?String.specialChar[a]:"\\u00"+a.charCodeAt().toPaddedString(2,16)});return a?'"'+b.replace(/"/g,'\\"')+'"':"'"+b.replace(/'/g,"\\'")+"'"}function toJSON(){return this.inspect(!0)}function unfilterJSON(a){return this.replace(a||Prototype.JSONFilter,"$1")}function isJSON(){var a=this;return a==""?!1:(a=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""),/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(a))}function evalJSON(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){throw new SyntaxError("Badly formed JSON string: "+this.inspect())}}return{toJSON:toJSON,isJSON:isJSON,evalJSON:evalJSON,unfilterJSON:unfilterJSON,inspect:inspect}}());var $break={},Enumerable=function(){function a(a,b){var c=0;try{this._each(function(d){a.call(b,d,c++)})}catch(d){if(d!=$break)throw d}return this}function b(a,b){var c;return this.each(function(d,e){if(a.call(b,d,e))throw c=d,$break}),c}function c(a,b){var c=[];return this.each(function(d,e){a.call(b,d,e)&&c.push(d)}),c}function d(a,b,c){return this.each(function(d,e){a=b.call(c,a,d,e)}),a}function e(a){if(Object.isFunction(this.indexOf)&&this.indexOf(a)!=-1)return!0;var b=!1;return this.each(function(c){if(c==a)throw b=!0,$break}),b}function f(a){var b=[];return this.each(function(c){b.push(c[a])}),b}return{each:a,inject:d,pluck:f,include:e,find:b,detect:b,select:c}}();Array.from=$A,function(){function d(a){return(a!==!1?this:this.toArray())._reverse()}function e(a){for(var b=0,c=this.length;b<c;b++)a(this[b])}function f(a,b){b||(b=0);var c=this.length;b<0&&(b=c+b);for(;b<c;b++)if(this[b]===a)return b;return-1}function g(){var a=b.call(arguments,0);return this.select(function(b){return a.indexOf(b)==-1})}function h(a,b){b=isNaN(b)?this.length:(b<0?this.length+b:b)+1;var c=this.slice(0,b).reverse().indexOf(a);return c<0?c:b-c-1}var a=Array.prototype,b=a.slice,c=a.forEach;c||(c=e),Object.extend(a,Enumerable),a._reverse||(a._reverse=a.reverse),Object.extend(a,{_each:c,reverse:d,without:g}),a.indexOf||(a.indexOf=f),a.lastIndexOf||(a.lastIndexOf=h)}();var Hash=Class.create(Enumerable,function(){function a(a){this._object=Object.isHash(a)?a.toObject():Object.clone(a)}function b(a){for(var b in this._object){var c=this._object[b],d=[b,c];d.key=b,d.value=c,a(d)}}function c(a,b){return this._object[a]=b}function d(a){if(this._object[a]!==Object.prototype[a])return this._object[a]}function e(){return Object.clone(this._object)}function f(){return new Hash(this)}return{initialize:a,_each:b,set:c,get:d,toJSON:JSON.stringify,clone:f}}());Hash.from=$H,Object.extend(Number.prototype,function(){function a(a,b){var c=this.toString(b||10),d="";for(;d.length<a-c.length;d+="0");return d+c}return{toPaddedString:a,toJSON:JSON.stringify}}());var ObjectRange=Class.create(Enumerable,function(){function a(a,b,c){this.start=a,this.end=b,this.exclusive=c}function b(a){var b=this.start;while(this.include(b))a(b),b=b.succ()}function c(a){return a<this.start?!1:this.exclusive?a<this.end:a<=this.end}return{initialize:a,_each:b,include:c}}());if(!window.Node)var Node={};Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),function(a){var b=function(){var a=document.createElement("form"),b=document.createElement("input"),c=document.documentElement;b.setAttribute("name","test"),a.appendChild(b),c.appendChild(a);var d=a.elements?typeof a.elements.test=="undefined":null;return c.removeChild(a),a=b=null,d}(),c=a.Element;a.Element=function(a,c){c=c||{},a=a.toLowerCase();var d=Element.cache;return b&&c.name?(a="<"+a+' name="'+c.name+'">',delete c.name,Element.writeAttribute(document.createElement(a),c)):(d[a]||(d[a]=Element.extend(document.createElement(a))),Element.writeAttribute(d[a].cloneNode(!1),c))},Object.extend(a.Element,c||{}),c&&(a.Element.prototype=c.prototype)}(this),Element.cache={},Element.idCounter=1,Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){return a=$(a),Element[Element.visible(a)?"hide":"show"](a),a},hide:function(a){return a=$(a),a.style.display="none",a},show:function(a){return a=$(a),a.style.display="",a},remove:function(a){return a=$(a),a.parentNode.removeChild(a),a},insert:function(a,b){a=$(a);if((typeof b).match(/(number|string)/)!=null||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,d,e,f;for(var g in b){c=b[g],g=g.toLowerCase(),d=Element._insertionTranslations[g];if(Object.isElement(c)){d(a,c);continue}c=String(c)||"",e=(g=="before"||g=="after"?a.parentNode:a).tagName.toUpperCase(),f=Element._getContentFromAnonymousElement(e,c),(g=="top"||g=="after")&&f.reverse(),f.forEach(d.curry(a))}return a},writeAttribute:function(a,b,c){a=$(a);var d={},e=Element._attributeTranslations.write;typeof b=="object"?d=b:d[b]=Object.isUndefined(c)?!0:c;for(var f in d)b=e.names[f]||f,c=d[f],e.values[f]&&(b=e.values[f](a,c)),c===!1||c===null?a.removeAttribute(b):c===!0?a.setAttribute(b,b):a.setAttribute(b,c);return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},hasClassName:function(a,b){if(!(a=$(a)))return;var c=a.className;return c.length>0&&(c==b||(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(c))},addClassName:function(a,b){if(!(a=$(a)))return;return Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b),a},removeClassName:function(a,b){if(!(a=$(a)))return;return a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip(),a},toggleClassName:function(a,b){if(!(a=$(a)))return;return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},empty:function(a){return $(a).innerHTML==""},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);return window.scrollTo(b[0],b[1]),a},getStyle:function(a,b){a=$(a),b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];if(!c||c=="auto"){var d=document.defaultView.getComputedStyle(a,null);c=d?d[b]:null}return b=="opacity"?c?parseFloat(c):1:c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b){a=$(a);var c=a.style,d;if(Object.isString(b))return a.style.cssText+=";"+b,b.indexOf("opacity")>-1?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var e in b)e=="opacity"?a.setOpacity(b[e]):c[e=="float"||e=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":e]=b[e];return a},setOpacity:function(a,b){return a=$(a),a.style.opacity=b==1||b===""?"":b<1e-5?0:b,a},getDimensions:function(a){a=$(a);var b=Element.getStyle(a,"display");if(b!="none"&&b!=null)return{width:a.offsetWidth,height:a.offsetHeight};var c=a.style,d=c.visibility,e=c.position,f=c.display;c.visibility="hidden",e!="fixed"&&(c.position="absolute"),c.display="block";var g=a.clientWidth,h=a.clientHeight;return c.display=f,c.position=e,c.visibility=d,{width:g,height:h}},cumulativeOffset:function(a){var b=0,c=0;do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a);return Element._returnOffset(c,b)}},Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}},Element._returnOffset=function(a,b){var c=[a,b];return c.left=a,c.top=b,c},Element._getContentFromAnonymousElement=function(a,b){var c=new Element("div"),d=Element._insertionTranslations.tags[a];return d?(c.innerHTML=d[0]+b+d[1],d[2].times(function(){c=c.firstChild})):c.innerHTML=b,$A(c.childNodes)};var _T_="<table><tbody>",__T_="</tbody></table>";Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:[_T_,__T_,2],TR:[_T_+"<tr>","</tr>"+__T_,3],TD:[_T_+"<tr><td>","</td></tr>"+__T_,4],SELECT:["<select>","</select>",1]}},function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})}(),Object.extend(Element,Element.Methods),function(a){!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__&&(window.HTMLElement={},window.HTMLElement.prototype=a.__proto__,Prototype.BrowserFeatures.ElementExtensions=!0),a=null}(document.createElement("div")),Element.extend=function(){function a(a){if(typeof window.Element!="undefined"){var b=window.Element.prototype;if(b){var c="_"+(Math.random()+"").slice(2),d=document.createElement(a);b[c]="x";var e=d[c]!=="x";return delete b[c],d=null,e}}return!1}function b(a,b){for(var c in b){var d=b[c];typeof d=="function"&&!(c in a)&&(a[c]=d.methodize())}}var c=a("object");if(Prototype.BrowserFeatures.SpecificElementExtensions)return c?function(a){if(a&&typeof a._extendedByPrototype=="undefined"){var c=a.tagName;c&&/^(?:object|applet|embed)$/i.test(c)&&b(a,Element.Methods)}return a}:Prototype.K;var d={},e=Object.extend(function(a){if(!a||typeof a._extendedByPrototype!="undefined"||a.nodeType!=1||a==window)return a;var c=Object.clone(d),e=a.tagName.toUpperCase();return b(a,c),a._extendedByPrototype=Prototype.emptyFunction,a},{refresh:function(){Prototype.BrowserFeatures.ElementExtensions||Object.extend(d,Element.Methods)}});return e.refresh(),e}(),Element.addMethods=function(a){function d(a){a=a.toUpperCase()}function e(a,b,c){c=c||!1;for(var d in a){var e=a[d];if(typeof e!="function")continue;if(!c||!(d in b))b[d]=e.methodize()}}function f(a){var b,c="Heading",d="TableSection",e={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:c,H2:c,H3:c,H4:c,H5:c,H6:c,Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:d,TFOOT:d,TBODY:d,TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};e[a]&&(b="HTML"+e[a]+"Element");if(window[b])return window[b];b="HTML"+a+"Element";if(window[b])return window[b];b="HTML"+a.capitalize()+"Element";if(window[b])return window[b];var f=document.createElement(a),g=f.__proto__||f.constructor.prototype;return f=null,g}var b=Prototype.BrowserFeatures;if(arguments.length==2){var c=a;a=arguments[1]}c?c.length!=null?c.forEach(d):d(c):Object.extend(Element.Methods,a||{});var g=window.HTMLElement?HTMLElement.prototype:Element.prototype;b.ElementExtensions&&e(Element.Methods,g),Object.extend(Element,Element.Methods),Element.extend.refresh&&Element.extend.refresh(),Element.cache={}},document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}}},function(a){function f(){return b.WebKit&&!c.evaluate?document:b.Opera&&window.parseFloat(window.opera.version())<9.5?document.body:document.documentElement}function g(b){return d||(d=f()),e[b]="client"+b,a["get"+b]=function(){return d[e[b]]},a["get"+b]()}var b=Prototype.Browser,c=document,d,e={};a.getWidth=g.curry("Width"),a.getHeight=g.curry("Height")}(document.viewport),Element.Storage={UID:1},Element.addMethods({getStorage:function(a){if(!(a=$(a)))return;var b;return a===window?b=0:(typeof a._prototypeUID=="undefined"&&(a._prototypeUID=[Element.Storage.UID++]),b=a._prototypeUID[0]),Element.Storage[b]||(Element.Storage[b]=$H()),Element.Storage[b]},retrieve:function(a,b,c){if(!(a=$(a)))return;var d=Element.getStorage(a),e=d.get(b);return typeof e=="undefined"&&(d.set(b,c),e=c),e},clone:function(a,b){if(!(a=$(a)))return;var c=a.cloneNode(b);return Element.extend(c)}}),function(){function d(b){b=a.extend(b);var c=b.target,d=b.type,e=b.currentTarget;return e&&e.tagName&&(d==="load"||d==="error"||d==="click"&&e.tagName.toLowerCase()==="input"&&e.type==="radio")&&(c=e),c.nodeType==Node.TEXT_NODE&&(c=c.parentNode),Element.extend(c)}function e(a){return{x:f(a),y:g(a)}}function f(a){var b=document.documentElement,c=document.body||{scrollLeft:0};return a.pageX||a.clientX+(b.scrollLeft||c.scrollLeft)-(b.clientLeft||0)}function g(a){var b=document.documentElement,c=document.body||{scrollTop:0};return a.pageY||a.clientY+(b.scrollTop||c.scrollTop)-(b.clientTop||0)}function h(b){a.extend(b),b.preventDefault(),b.stopPropagation(),b.stopped=!0}function k(b,d,e){var f=Element.retrieve(b,"prototype_event_registry");Object.isUndefined(f)&&(m.push(b),f=Element.retrieve(b,"prototype_event_registry",$H()));var g=f.get(d);Object.isUndefined(g)&&(g=[],f.set(d,g));if(g.pluck("handler").include(e))return!1;var h;if(d.indexOf(":")>-1)h=function(c){if(Object.isUndefined(c.eventName))return!1;if(c.eventName!==d)return!1;a.extend(c,b),e.call(b,c)};else if(!!c||d!=="mouseenter"&&d!=="mouseleave")h=function(c){a.extend(c,b),e.call(b,c)};else if(d==="mouseenter"||d==="mouseleave")h=function(c){a.extend(c,b);var d=c.relatedTarget;while(d&&d!==b)try{d=d.parentNode}catch(f){d=b}if(d===b)return;e.call(b,c)};return h.handler=e,g.push(h),h}function l(){for(var b=0,c=m.length;b<c;b++)a.stopObserving(m[b]),m[b]=null}function o(a,b,c){a=$(a);var d=k(a,b,c);if(!d)return a;if(b.indexOf(":")>-1)a.addEventListener?a.addEventListener("dataavailable",d,!1):(a.attachEvent("ondataavailable",d),a.attachEvent("onfilterchange",d));else{var e=n(b);a.addEventListener?a.addEventListener(e,d,!1):a.attachEvent("on"+e,d)}return a}function p(a,b,c){a=$(a);var d=Element.retrieve(a,"prototype_event_registry");if(Object.isUndefined(d))return a;if(b&&!c){var e=d.get(b);return Object.isUndefined(e)?a:(e.each(function(c){Element.stopObserving(a,b,c.handler)}),a)}if(!b)return d.each(function(b){var c=b.key,d=b.value;d.each(function(b){Element.stopObserving(a,c,b.handler)})}),a;var e=d.get(b);if(!e)return;var f=e.find(function(a){return a.handler===c});if(!f)return a;var g=n(b);return b.indexOf(":")>-1?a.removeEventListener?a.removeEventListener("dataavailable",f,!1):(a.detachEvent("ondataavailable",f),a.detachEvent("onfilterchange",f)):a.removeEventListener?a.removeEventListener(g,f,!1):a.detachEvent("on"+g,f),d.set(b,e.without(f)),a}function q(b,c,d,e){b=$(b),Object.isUndefined(e)&&(e=!0),b==document&&document.createEvent&&!b.dispatchEvent&&(b=document.documentElement);var f;return document.createEvent?(f=document.createEvent("HTMLEvents"),f.initEvent("dataavailable",!0,!0)):(f=document.createEventObject(),f.eventType=e?"ondataavailable":"onfilterchange"),f.eventName=c,f.memo=d||{},document.createEvent?b.dispatchEvent(f):b.fireEvent(f.eventType,f),a.extend(f)}var a={},b=document.documentElement,c="onmouseenter"in b&&"onmouseleave"in b;a.Methods={element:d,pointer:e,pointerX:f,pointerY:g,stop:h};var i=Object.keys(a.Methods).inject({},function(b,c){return b[c]=a.Methods[c].methodize(),b});if(Prototype.Browser.IE){function j(a){var b;switch(a.type){case"mouseover":b=a.fromElement;break;case"mouseout":b=a.toElement;break;default:return null}return Element.extend(b)}Object.extend(i,{stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.returnValue=!1},inspect:function(){return"[object Event]"}}),a.extend=function(b,c){if(!b)return!1;if(b._extendedByPrototype)return b;b._extendedByPrototype=Prototype.emptyFunction;var d=a.pointer(b);return Object.extend(b,{target:b.srcElement||c,relatedTarget:j(b),pageX:d.x,pageY:d.y}),Object.extend(b,i)}}else a.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__,Object.extend(a.prototype,i),a.extend=Prototype.K;var m=[];Prototype.Browser.IE&&window.attachEvent("onunload",l),Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,!1);var n=Prototype.K;c||(n=function(a){var b={mouseenter:"mouseover",mouseleave:"mouseout"};return a in b?b[a]:a}),Object.extend(a,a.Methods),Object.extend(a,{fire:q,observe:o,stopObserving:p}),Element.addMethods({fire:q,observe:o,stopObserving:p}),Object.extend(document,{fire:q.methodize(),observe:o.methodize(),stopObserving:p.methodize(),loaded:!1}),window.Event?Object.extend(window.Event,a):window.Event=a}(),Element.addMethods(),typeof SN=="undefined"&&(SN={}),SN.Constants=function(){var a={"sn.vi":31536e6,"sn.ui":31536e6,"sn.vc":31536e6,"sn.wt":36e5,"sn.eh":31536e6,"sn.as":36e5,"sn.rn":6048e5},b={UNDEFINED_STR:"undefined",KEY_VALUE_SEPERATOR:"||",KEY_SEPERATOR:"~",LOCALSTORAGE_KEY_SEPARATOR:"#",LOCALSTORAGE_VALUE_SEPARATOR:"+",PROXY_NAME:"/247xd.html",ACTION_PAGE_NAME:"webchat/js/247action.html",TP_RANDOM_NUMBER:"rt",VG_RANDOM_NUMBER:"rv",ACTIVE_SESSION:"as",ACTIVE_SESSION_LIFE_TIME:"aslt",CUSTOM_TRACKING_ENABLED:"cte",BROWSER_GEO_LOCATION:"bgl",RANDOM_NO_LIFE_TIME:"rnlt",MAX_UI_ENTRIES:"mui",VID_LIFETIME:"vilt",UI_STORE_LIFETIME:"uilt",WS_STORE_LIFETIME:"wslt",WT_STORE_LIFETIME:"wtlt",VARIABLE_STORE_LIFETIME:"vclt",EXIT_HISTORY_LIFETIME:"exlt",REPEAT_VISITOR_LIFETIME:"rvlt",PAGE_LOAD_COUNTER:"c",ACTIVE_SESSION_START_TIME:"st",PREVIOUS_ACTIVE_SESSION_TIME:"pat",CURRENT_ACTIVE_SESSION_TIME:"cat",SAMPLING_STORAGE:"smplscope",SAMPLING_STORE_STORAGE:"sp",BROWSER_SESSION_SCOPE:"bs",VISITOR_ID:"vi",BROWSER_DETAILS:"bd",DC_CODE:"dc",AS_CODE:"as",SERVER_CALL_ID_PREFIX:"sn-ss-",STATE_KEY:"st",TEST_STAGE:"t",SN_AS_STORE_NAME:"sn.as",SN_UI_STORE_NAME:"sn.ui",SN_VI_STORE_NAME:"sn.vi",PARAM_KEY_DATA_STORE:"ds",PARAM_KEY_CDN_VERSION:"vc",SN_RN_STORE_NAME:"sn.rn",SN_EXIT_HISTORY_STORE_NAME:"sn.eh",SN_VARIABLE_STORE_NAME:"sn.vc",SN_WEBTRACKER_STORE_NAME:"sn.wt",VI_BUCKET_CUSTOM_DATA_KEY:"cd",PSP_CONTEXT:"/psp",WEBCONTENT_CONTEXT:"/webcontent",PROTOCOL_HTTP:"http:",PROTOCOL_HTTPS:"https:",CDN_VERSION:"cv",PSP_VERSION:"pv",PAGE_ACTION_EVENT:"pageactionevent",EVENT_HANDLER_CHAT_INVITE:"SHOW_CHAT_INVITE",UPDATE_SN_AS_EVENT:"UPDATE_SN_AS_EVENT",EVENT_HANDLER_WOWPX:"START_WOWPX_APP",EVENT_HANDLER_ADP:"START_ADP_APP",WIDGET_EVENT:"widgetevent",ACTION_COMPLETED:"completed",ACTION_DISRUPTED:"disrupted",EXCEPTION_EVENT:"exceptionevent",UPDATE_FSMVARIABLES_EVENT:"updatefsmvariables",INTERNAL_ERROR:500,BOOTSTRAP_COMPLETED_EVENT:"bootstrapDone",BOOTSTRAP_UPDATE_COMPLETED_EVENT:"bootstrapUpdateDone",UI_UPDATE_EVENT:"uiUpdateDone",CUSTOM_INITIALIZATION_COMPLETED:"customInitializationCompleted",CONST_PERIODICAL_EXECUTION_TIMER_EVENT:"periodicexecutionevent",BOOTSTRAP_TARGET_ERROR_CODE:903,BOOTSTRAP_VISITOR_GROUP_NOT_FOUND:901,LOGLEVEL_ERROR:"e",LOGLEVEL_WARN:"w",LOGLEVEL_DEBUG:"d",LOGLEVEL_INFO:"i",SHOW_UI:"show",INTERNAL_INVITATION_EVENT:"internalinvitationevent",INVITE_ACCEPTED:"accepted",INVITE_DECLINED:"declined",INVITE_IGNORED:"ignored",INVITE_OFFERED:"shown",INVITATION_EVENT:"INVITATION_EVENT",RULE_ENGINE_EVENT:"RULE_ENGINE_EVENT",VISITOR_EVENT:"VISITOR_EVENT",SESSION_START_EVENT:"SESSION_START_EVENT",EVENT_SOURCE:"chatcontroller",CUSTOM_EVENT:"CUSTOM_EVENT",CUSTOM_EVENT_FIRED:6e5,LP_CHAT_INVITE_OFFERED:56e4,LP_CHAT_INVITE_ACCEPTED:560001,LP_CHAT_INVITE_DECLINED:560002,EXIT_LINK_EVENT:100010,SEQUENCE_ID:"s",SOURCE_SEQUENCE_ID:"ssi",RULE_ID:"ruleId",EVENT_ID:"eventId",RULE_CONFIG:"ruleconfig",KEY_IS_PRESENT:"isPresent",PARAM_TYPE_HANDLER:"handler",PARAM_TYPE_CUSTOM:"custom",PARAM_TO_IS:"paramsToIS",EVENT_TYPE:"eventType",TIME_STAMP:"ts",EVENT:"evt",CUSTOMER_ID:"cui",PLATFORM_CONFIG_IABLE_NAME:"pc",ACTION_CONTEXT:"ctxt",ACTION_CHAT_CTXT:"sn_chat_window",SN_KEY:"key",HANDLER_CONFIG_KEY:"handlerConfig",PARAM_TYPE_FSMVARS:"f",PARAM_TYPE_RULEVARS:"r",DOMLOADED:"domloaded",IFRAME_LOADED:"iframeLoaded",PSP_KEY:"key",VERSION:"v",EVENT_HANDLER_SHOW_CHAT_WINDOW:"SHOW_CHAT_WINDOW",IFRAME_TYPE:"iframeType",IFRAME_TYPE_EXCEPTION:"exception",ACCOUNT_ID:"ai",TRANSPORT_PARAMS:"transportparams",SOURCE_SEQ_ID:"ssi",XD_EVENT:"xdevent",PAGE_EVENT_INITIALIZE:"initialize",PAGE_EVENT:"pageevent",IFRAME_NAME:"childiframe",IFRAME_ID:"childiframeid",ELEMENT_NOT_PRESENT:!1,ELEMENT_PRESENT:!0,PSP_STATIC_SERVER_ID:"pspStaticRoot",BEFORE_UNLOAD_EVENT:"beforePageUnload",EVENT_HANDLER_CHAT:"SHOW_CHAT",EVENT_HANDLER_VIDEO:"SHOW_VIDEO",EVENT_HANDLER_PP:"SHOW_PP",EVENT_HANDLER_SCC:"SHOW_SCC",UI_TYPE_CHAT:"chat",PARAM_KEY_ACC_KEY:"key",PARAM_KEY_HOST:"host",PARAM_KEY_PAGEID:"pageid",PARAM_KEY_URL_ID:"ud",FINGER_PRINT_ID:"fpid",PARAM_KEY_VI_MAINTAINANCE:"shouldMaintainVi",PARAM_KEY_UNIQUE_TIMESTAMP:"uniqueTimestamp",PSP_ROOT_KEY:"psproot",CONTEXT_PARAM:"ctxt",START_TIME:"st",END_TIME:"et",EVENT_STATUS:"status",EVENT_OUTPUT:"output",EVENT_SRC_PAGE_ID:"pageid",KEY_RULE_STATE:"rulestate",ACTION_IN_PROGRESS:"inprogress",EVENT_PREFIX:"SN:",EVENT_HANDLER_JS:"EXECUTE_JS",PAGE_TRIGGER:"pagetrigger",BOOTSTRAP_RECEIVED_EVENT:"bootstrapRecvd",PERIODICAL_EXECUTION_TIMER_EVENT:"periodicexecutionevent",XD_RULE_EVENT:"ruleevent",XD_UPDATE_SESSION:"updatesession",XD_SAVE_STATE:"savestate",XD_BOOTSTRAP:"bootstrap",XD_WIDGET_CMD:"widgetcmd",XD_REDIRECT:"redirect",XD_PP_CHAT_ACCEPTED:"ppchataccepted",PAGE_EVENT_BOOTSTRAP:"bootstrap",PAGE_EVENT_STATE_CHANGE_UPDATE:"statechangeupdate",PAGE_EVENT_VISIT_TO_TAGGED_PAGE:100001,SESSION_START_EVENT_ID:100002,CUSTOM_RULE_TRIGGERED:110001,CUSTOM_RULE_TRIGGER_EVENT:"CUSTOM_TRIGGER_EVENT",RULES_TRIGGERED:11e4,RULE_TRIGGERED_EXCEPTION_EVENT:110002,PAGE_EVENT_RULE_TRIGGER_DROPPED:120003,PARAM_UUIT:"ut",PARAM_ACTION_CONTEXT:"actionctxt",SHOULD_START_RE:"startRE",BOOTSTRAP_ID_PREFIX:"sn-bootstrap-",BOOTSTRAP_CONTEXT:"/bootstrap.js?",SET_VC_CONTEXT:"/v0/serverdata/set?",SEND_SERVER_DATA:"sendServerData",LOCAL_STORE:"localstore",BOOTSRTAP_RETRY_INTERVALS:[1e3,2e3,3e3],STATE_CHANGE_COMPLETED_EVENT:"statechangecompleted",STATECHANGE_ID_PREFIX:"sn-statechange-",STATECHANGE_CONTEXT:"/statechange?",PARENT_DOMAIN:"parentdomain",PSP_VERSION_KEY:"pspv",IE_STORAGE:"ie",REFERENCE_LOADED_ITEM:"refloaded",GET_LOCAL_STORAGE_ITEM:"getlocalstorageitem",SET_LOCAL_STORAGE_ITEM:"setlocalstorageitem",REMOVE_LOCAL_STORAGE_ITEM:"removelocalstorageitem",REFERENCE_IFRAME_ID:"sn-pspxd-iframe",REFERENCE_IFRAME_NAME:"sn-pspxd-iframe-name",UI_INVITE_ACCEPTED:"a",UI_INVITE_IGNORED:"i",UI_INVITE_DECLINED:"d",UI_INVITE_OFFERED:"o",UI_INVITATION_IN_PROGRESS:"ip",TRUE:"t",FALSE:"f",CONST_INVITATION_OFERED_TIME_STAMP:"it",EXIT_LINK:"el",NEWTAB_EXIT_LINK:"ntel",MAX_XD_RETRY_COUNT:5,XD_RETRY_INTERVAL:330,SET_XD_DATA:"setXdData",CONST_URL_SEPARATOR:"|",DEFAULT_STORE_LIFETIME_MAP:a,POLLER_TIMEOUT:9e5,CLIENT_KEY:"clientKey",BUCKET_KEY:"bucketKey",BUCKET_VALUE:"bucketValue",SEND_SERVER_DATA_CALL:"/v0/data/pxoe/set",GET_SERVER_DATA_CALL:"/v0/data/pxoe/get"},c={};getWowpxPath=function(a){var b=a||window.document.domain;return c[b]},getDocumentDomain=function(){var a=document.location.href,b=a.split("#"),c=b[1].split("&");for(var d=0;d<c.length;d++)if(c[d].indexOf("documentDomain")!=-1){var e=c[d].split("="),f=e[1];if(f!=document.domain)return f;break}};var d=window.documentDomain;return d&&document.domain!=d&&(document.domain=d),b}(),typeof SN=="undefined"&&(SN={});try{window.pspSNTrackingId=(new String((new Date).getTime())).valueOf()+"-"+Math.floor(Math.random()*1e6)}catch(err){console.log("Error while constructing trackingId",err)}SN.loadTrackingScript=function(a,b,c,d,e,f){var g=SN.Constants;try{var h=new String((new Date).getTime()),i=document.createElement("script");i.type="text/javascript";var j="id="+window.pspSNTrackingId+"&type="+a+"&ts="+h;typeof b!==g.UNDEFINED_STR&&b!=null&&(j=j+"&vid="+b);var k=parent.document.location.href;k.length>200&&(k=k.substr(0,200)),j=j+"&u="+encodeURIComponent(k),j=j+"&ll="+f,typeof c!==g.UNDEFINED_STR&&c!=null&&c!=""&&(j=j+"&ed="+c),j.length>2e3&&(j=j.substr(0,2e3)),i.id="track-js"+h,i.src=document.location.protocol+"//"+parent.SN.Conf.getCpxtDomain()+"/psp/"+e+"/"+SN.Conf.CONST_PSP_VERSION+"/cpxt.js?"+j,document.body.appendChild(i)}catch(l){console.log("Error while sending custom tracking data",l)}},typeof SN=="undefined"&&(SN={}),SN.Utils=function(){function T(a){G=a,I=(new Date).getTime(),J=G-I}function U(a){R=a,H=G-a;var b=new Date,c=-(b.getTimezoneOffset()*60*1e3),d=a,e=d-c,f=new Date((new Date).getTime()+e);P=f.getHours(),Q=f.getMinutes()}function V(){return P+":"+Q}function W(){return R}function X(){return $undefinedOrNull(J)?null:J}function Y(a){var b=[].slice.call(a,0);for(var c=0;c<b.length;c++){var d=b[c];$isArray(d)?b[c]=d.join(","):$isString(d)||(b[c]=JSON.stringify(d))}return b.join(" ")}function Z(a,b){var c=[];return c.push(a),c.push("="),c.push(b),c.join("")}function _(a){m=a}function ab(){return m}function bb(){if(!g||m>j)return;typeof console.warn!=a.UNDEFINED_STR&&(Prototype.Browser.Gecko?console.warn.apply(console,arguments):console.warn(Y(arguments)))}function cb(){if(!g||m>i)return;typeof console.error!=a.UNDEFINED_STR&&(Prototype.Browser.Gecko?console.error.apply(console,arguments):console.error(Y(arguments)))}function db(){if(!g||m>l)return;typeof console.info!=a.UNDEFINED_STR&&(Prototype.Browser.Gecko?console.info.apply(console,arguments):console.info(Y(arguments)))}function eb(){if(!g||m>k)return;typeof console.debug!=a.UNDEFINED_STR?Prototype.Browser.Gecko?console.debug.apply(console,arguments):console.log(Y(arguments)):hc()&&console.log(n+Y(arguments))}function fb(a,b){var c={};$undefined(b)||(c.id=b),c.href=a,c.rel="stylesheet",c.type="text/css",f.appendChild(new Element("link",c))}function gb(a,b){var c={};$undefined(b)||(c.id=b),c.src=a,c.type="text/javascript",c.async=!0,f.appendChild(new Element("script",c))}function hb(a,b){var c={};$undefined(b)||(c.id=b),c.src=a,c.type="text/javascript",document.body.appendChild(new Element("script",c))}function ib(a,b,c){var d={};$undefined(b)||(d.id=b),d.src=a;var e=new Element("iframe",d);return c==1&&e.hide(),document.body.appendChild(e)}function jb(a,b,c){var d={};$undefined(b)||(d.id=b),d.src=a;var e=new Element("img",d);c==1&&e.hide(),document.body.appendChild(e)}function kb(a,b){var c=a.length>0&&a.charAt(a.length-1)!="?";for(var d in b)c==1?a+="&":c=!0,typeof b[d]=="object"||$isArray(b)?a+=d+"="+encodeURIComponent(JSON.stringify(b[d])):a+=d+"="+encodeURIComponent(b[d]);return a}function lb(){return $undefined(window.innerWidth)?!$undefined(document.documentElement)&&!$undefined(document.documentElement.clientWidth)&&document.documentElement.clientWidth!=0?parent.document.documentElement.clientWidth:parent.document.getElementsByTagName("body")[0].clientWidth:parent.window.innerWidth}function mb(){return $undefined(window.innerHeight)?!$undefined(document.documentElement)&&!$undefined(document.documentElement.clientHeight)&&document.documentElement.clientHeight!=0?parent.document.documentElement.clientHeight:parent.document.getElementsByTagName("body")[0].clientHeight:parent.window.innerHeight}function nb(a){var b=new RegExp("[\\?&#]"+a+"=([^&#]*)"),c=b.exec(location.href);return $isEmpty(c)?"":decodeURIComponent(c[1])}function ob(a){$isEmpty(a)&&(a=location.href);var b=a.indexOf("?");b!=-1&&b<a.length-1&&(a=a.substring(0,b));var c=a.lastIndexOf("/");return c!=-1&&c<a.length-1?a.substring(0,c):a}function pb(a){$isEmpty(a)&&(a=top.location.href);var b=a.indexOf("https")==0?9:8,c=a.indexOf("/",b);return c>0?a.substring(0,c):a}function qb(b){return undefined===b?a.UNDEFINED_STR:null===b?null:{}.toString.call(b).slice(8,-1)}function rb(a){return Object.isUndefined(a)||a==null||a==="null"}function sb(a){return a==null||a==""}function tb(b,c){var d=c;if($undefined(d)||$isEmpty(d))d=nb("host"),$isEmpty(d)&&(d=top.location.href);var e=pb(d);b==null&&(b="");var f={};return b=f[c],new SN.XD.Sender(e+"/"+b+a.PROXY_NAME)}function ub(b){if(b!=null)return b;var c=nb("host");$isEmpty(c)&&(c=top.location.href);var d=pb(c);return d+"/"+a.ACTION_PAGE_NAME}function vb(a,b,c){var d=parent.document.createElement("form");Element.writeAttribute(d,"id",c+"-form"),Element.writeAttribute(d,"method","post"),Element.writeAttribute(d,"action",a),Element.writeAttribute(d,"target",c),parent.document.body.appendChild(d);for(var e in b){var f=parent.document.createElement("input");Element.writeAttribute(f,"id",c+"-input-"+e),Element.writeAttribute(f,"type","hidden"),Element.writeAttribute(f,"name",e),Element.writeAttribute(f,"value",String(b[e])),Element.insert(d,f)}d.submit(),window.setTimeout(function(){Element.remove(d)},1e3)}function wb(a,b,c){var d=new Element("iframe",{id:b,src:a});d.setStyle({left:"-1000px",position:"absolute"}),Element.hide(d),document.body.appendChild(d);if(c!=null&&c!="")try{var e=c-0,f=window.setTimeout(function(){Element.remove(d)},e)}catch(g){bb("invalid integer: "+c,g)}}function xb(a,b,c){$undefinedOrNull(c)&&(c="_blank");var d=new Element("form",{method:"post",action:a,target:c});document.body.appendChild(d);for(var e in b){var f=new Element("input",{id:c+"-input-"+e,type:"hidden",name:e,value:String(b[e])});d.appendChild(f)}d.submit()}function yb(a,b){var c=new RegExp(b,"");return c.test(a)}function zb(a,b){if(a>=b)throw"Invalid range: "+a+">="+b;return Math.floor(Math.random()*(b-a+1))+a}function Ab(a,b){var c=a.indexOf(b);return c>=0&&c+b.length==a.length?!0:!1}function Bb(a){d=a}function Cb(a){c=a}function Db(a){x=a}function Eb(){return x}function Fb(a){y=a}function Gb(){return y}function Hb(){return d}function Ib(){var a=parent.SN.Conf.CONST_PSP_VERSION;$undefinedOrNull(a)&&(a=t);if(a=="d"||a=="default")return"default";if(a=="t"||a=="test")return"test"}function Jb(){return c}function Kb(){var a=parent.SN.Conf.CONST_CDN_VERSION;return $undefinedOrNull(a)&&(a=u),a}function Lb(a){p=a}function Mb(a){q=a}function Nb(){return q}function Ob(a){s=a}function Pb(){return s}function Qb(){return Tb()+"//"+Hb()+a.PSP_CONTEXT}function Rb(){var b="https:";return b+"//"+Hb()+a.PSP_CONTEXT}function Sb(){return Tb()+"//"+Jb()+a.PSP_CONTEXT}function Tb(){var b=a.PROTOCOL_HTTPS;return location.protocol.indexOf(a.PROTOCOL_HTTPS)==-1&&(b=a.PROTOCOL_HTTP),b}function Ub(){return Tb()+"//"+Hb()+a.WEBCONTENT_CONTEXT}function Vb(a,b){var c=new Array;return c.push(a),c.push(b),c.join("=")}function Wb(a,b,c,d){var e;a=="parent"?e=parent.document:e=document;var f=e.createElement(c);for(var g in d)f[g]=d[g];return b.appendChild(f),null}function Xb(a,b,c){return window.open(a,b,c),!1}function Yb(){var a={},b=parent.SN.Browser||{};b.type==b.MSIE?(a.x=parent.window.screenTop-100,a.y=parent.window.screenLeft):b.type==b.FF?(a.x=parent.window.screenX,a.y=parent.window.screenY):b.type==b.CHROME&&(a.x=parent.window.screenX,a.y=parent.window.screenY);var c={};b.type==b.MSIE?(c.x=8,c.y=125):b.type==b.FF?(c.x=parent.window.outerWidth-parent.window.innerWidth,c.y=parent.window.outerHeight-parent.window.innerHeight):b.type==b.CHROME&&(c.x=parent.window.outerWidth-parent.window.innerWidth,c.y=parent.window.outerHeight-parent.window.innerHeight);var d={};d.distanceFromTopBar=70,d.distanceFromRightBoundary=150,d.width=285;var e={};e.y=d.distanceFromTopBar,b.type==b.MSIE?e.x=parent.document.documentElement.clientWidth+8-d.distanceFromRightBoundary-d.width:b.type==b.FF?e.x=parent.window.outerWidth-d.distanceFromRightBoundary-d.width:b.type==b.CHROME&&(e.x=parent.window.outerWidth-d.distanceFromRightBoundary-d.width);var f={x:a.x+c.x+e.x,y:a.y+c.y+e.y};return f}function Zb(a){return a.indexOf("http://")!=-1&&(a=a.replace("http://","https://")),a}function $b(a){r=a}function _b(){return r}function ac(){var a=parent.window.name;if(!$undefinedOrNull(a)&&!$isEmpty(a))return a}function bc(a){parent.window.name=a}function cc(b,c){if(o>k)return;var d=!1;gc(b,c,d,a.LOGLEVEL_INFO)}function dc(b,c){!(o>j);var d=!1;gc(b,c,d,a.LOGLEVEL_WARN)}function ec(b,c){if(o>l)return;var d=!1;gc(b,c,d,a.LOGLEVEL_DEBUG)}function fc(b,c){if(o>i)return;var d=!1,e="";if(typeof c!=a.UNDEFINED_STR){var f=JSON.stringify(c),g=f.length>750?750:f.length;e=encodeURIComponent(f.substr(0,g))}var h={};gc("msg: "+b+" Error: "+e,h,d,a.LOGLEVEL_ERROR)}function gc(b,c,d,e){if(!rb(N)&&N=="false")return;if(rb(N)){window.localStorage?N=window.localStorage.getItem(a.CUSTOM_TRACKING_ENABLED):N=window[a.CUSTOM_TRACKING_ENABLED];if(rb(N))N=="true";else if(N=="false")return}try{var f="";if(typeof c=="undefined"||c==null)c={};try{for(var g in c){var h=c[g],i=JSON.stringify(h);$undefinedOrNull(i)||(i.indexOf("http://")!=-1||i.indexOf("https://")!=-1)&&i.length>500&&(h=i.substr(0,500))}var j;typeof SN.SessionManager!=a.UNDEFINED_STR&&SN.SessionManager!=null&&(j=SN.SessionManager.getGlobalSession()),typeof j!=a.UNDEFINED_STR&&j!=null&&(f=j.getVisitorId());if(typeof f=="undefined"||f==null)f=""}catch(k){cb("Error in processing variables map",k)}var l=encodeURIComponent(JSON.stringify(c));if(!$undefinedOrNull(d)&&d==1){var m={};m.vid=f,m.bsid=c.bsid,m.ed=c,m.si="CUSTOM_TRACK",document.fire("SN:CUSTOM_TRACK_EVENT",m)}typeof SN.loadTrackingScript!="undefined"?SN.loadTrackingScript(b,f,l,x,q,e):typeof parent.SN.loadTrackingScript!="undefined"&&parent.SN.loadTrackingScript(b,f,l,x,q,e)}catch(k){cb("error in making custom tracking call!!",k)}}function hc(){return z.indexOf(A)!=-1?!0:!1}function ic(a){o=a}function jc(a,b){if($undefinedOrNull(a))return;for(var c in a)$undefinedOrNull(a[c])||(b[c]=a[c])}function kc(){return Math.random().toString().substring(2,18)+"-"+(new Date).getTime()}function lc(){return w}function mc(a){w=a}function nc(a){return v[a]}function oc(a,b){v[a]=b*1e3}function pc(){var a=location.href;return a.indexOf(D)!=-1?a:a.indexOf(B)!=-1?a.replace(B,D):F}function qc(){var a=location.href;return a.indexOf(C)!=-1?a:a.indexOf(B)!=-1?a.replace(B,C):E}function rc(a){var b=document.getElementById(a);if(b){var c=document.getElementsByTagName("head").item(0);setTimeout(function(){try{c.removeChild(b)}catch(a){SN.Utils.error("Could not remove tracking.js - ",a)}},2e3)}}function sc(){return SN.StoreManager.getValueFromStore(a.SN_VI_STORE_NAME,a.CONST_INVITATION_OFERED_TIME_STAMP)}function tc(b){var c=X();c!=null&&SN.StoreManager.setValueInStore(a.SN_VI_STORE_NAME,a.CONST_INVITATION_OFERED_TIME_STAMP,b+c),SN.StoreManager.setItValueInServer()}function uc(){return K}function vc(a){K=a}function wc(){var b=SN.StoreManager.getValueFromStore(a.SN_VI_STORE_NAME,a.ACTIVE_SESSION_START_TIME);if($undefinedOrNull(b))return 0;try{var c=(new Date).getTime()-parseInt(b);return c<0?0:Math.round(c/1e3)}catch(d){return cb("Error in processing time on site",d),0}}function xc(a){L=a}function yc(){return L}function zc(){var b=null;parent.SN.Conf.dataStore=="server"?b=$getTotalVisitCount():b=SN.StoreManager.getValueFromStore(a.SN_VI_STORE_NAME,a.PAGE_LOAD_COUNTER);if($undefinedOrNull(b))return 0;try{b=parseInt(b);var c=wc();return Math.round(c/b)}catch(d){return cb("Error in processing average time on site",d),0}}function Ac(a){M=a}function Bc(){return M}function Cc(a){var b={};for(var c=a.length-1;c>=0;c--)b[a[c]]?a.splice(c,1):b[a[c]]=!0;return a}function Dc(a){O=a}function Ec(){return O}function Fc(){return S}function Gc(a){S=a}var a=SN.Constants,b="ps",c=null,d=null,e=null,f=document.getElementsByTagName("head")[0],g=typeof console!=a.UNDEFINED_STR,h=1e3,i=400,j=300,k=200,l=100,m=h,n="INFO: ",o=i,p=null,q=null,r=null,s=null,t="d",u="v0.1",v={},w=5,x="cdn.247ilabs.com",y=!0,z=navigator.userAgent,A="MSIE",B="247SN",C="247XD",D="247Action",E="http://"+parent.SN.Conf.CONST_PSP_ROOT+"/psp247/247XD.html",F="http://"+parent.SN.Conf.CONST_PSP_ROOT+"/psp247/247Action.html",G,H,I,J,K=!1,L=!1,M="/pspxd.html",N=null,O=null,P=null,Q=null,R,S=null;Event.observe(window,"load",function(){var b=parent.SN.Conf.CONST_PSP_STAGE;b==a.TEST_STAGE&&(m=k)});var $=0,Hc={setLogLevel:_,getLogLevel:ab,warn:bb,error:cb,debug:db,info:eb,loadCss:fb,loadJs:gb,loadJsInline:hb,loadIFrame:ib,loadImg:jb,appendUrlParams:kb,getWidth:lb,getHeight:mb,readParam:nb,getContext:ob,getRootContext:pb,typeOf:qb,isUndefinedOrNull:rb,isEmpty:sb,createXDSender:tb,getActionPageURL:ub,postToIframe:vb,createHiddenIframe:wb,postToWindow:xb,patternMatch:yb,getRandom:zb,getPSPRoot:Qb,getPSPCDNRoot:Sb,getPSPCDNVersion:Kb,getPSPVersion:Ib,setPSPServerName:Bb,setPSPCDNServerName:Cb,getPSPServerName:Hb,getPSPWebContentUrl:Ub,convertToHttps:Zb,setPSPVisitorPercentage:Lb,setClientKey:Mb,getClientKey:Nb,setProxyServer:Ob,getProxyServer:Pb,parameterize:Vb,appendHTMLTag:Wb,openWin:Xb,getWindowPosition:Yb,getPSPServerUrl:_b,setPSPServerUrl:$b,getWindowName:ac,setWindowName:bc,copyParams:jc,getUniqueId:kc,getStoreLifetime:nc,setStoreLifetime:oc,setMaxUIEntries:mc,getMaxUIEntries:lc,setCustomTrackServer:Db,getCustomTrackServer:Eb,setEventFireRequired:Fb,infoTrack:cc,debugTrack:ec,errorTrack:fc,warnTrack:dc,setCustomTrackingLevel:ic,getSecurePSPRoot:Rb,getEventFireRequired:Gb,isIE:hc,get247ActionUrl:pc,get247XDUrl:qc,removeElement:rc,setLastInvitationOfferedTimestamp:tc,getLastInvitationOfferedTimestamp:sc,setServerTimeStamp:T,isCrossDomainSupported:uc,setCrossDomainSupported:vc,isSubDomain:Ab,setDomready:xc,isDomready:yc,getTimeOnSite:wc,getAverageTimeOnPage:zc,setPsdxdPath:Ac,getPsdxdPath:Bc,setAvailableStore:Dc,getAvailableStore:Ec,removeDuplicates:Cc,getTimeStampDiff:X,setClientTimeStamp:U,getClientTimeZoneOffsetInMilliSeconds:W,getClientTimeStamp:V,setGeoPrivateIp:Gc,getGeoPrivateIp:Fc,augmentKeyValuePair:Z};return Hc}(),typeof SN=="undefined"&&(SN={}),SN.Base64Encoder=function(){function b(b){var c="",e,f,g,h,i,j,k,l=0;b=d(b);while(l<b.length)e=b.charCodeAt(l++),f=b.charCodeAt(l++),g=b.charCodeAt(l++),h=e>>2,i=(e&3)<<4|f>>4,j=(f&15)<<2|g>>6,k=g&63,isNaN(f)?j=k=64:isNaN(g)&&(k=64),c=c+a.charAt(h)+a.charAt(i)+a.charAt(j)+a.charAt(k);return c}function c(b){var c="",d,f,g,h,i,j,k,l=0;b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<b.length)h=a.indexOf(b.charAt(l++)),i=a.indexOf(b.charAt(l++)),j=a.indexOf(b.charAt(l++)),k=a.indexOf(b.charAt(l++)),d=h<<2|i>>4,f=(i&15)<<4|j>>2,g=(j&3)<<6|k,c+=String.fromCharCode(d),j!=64&&(c+=String.fromCharCode(f)),k!=64&&(c+=String.fromCharCode(g));return c=e(c),c}function d(a){a=a.replace(/\r\n/g,"\n");var b="";for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(d&63|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(d&63|128))}return b}function e(a){var b="",c=0,d=0,e=0,f=0;while(c<a.length)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(e=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|e&63),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63),c+=3);return b}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f={encode:b,decode:c};return f}(),SN.WebPageFilter=function(){function i(a){d=a}function j(a){e=a}function k(a){f=a}function l(a){g=a}function m(a){h=a}function n(a){switch(Number(d)){case c.BOTH:return p(a)?!1:o(a)?!0:!1;case c.EXCLUSION:return!p(a);case c.INCLUSION:return o(a);case c.NONE:return!0}return!1}function o(a){return b.encode(a)in e||q(a)?!0:!1}function p(a){return b.encode(a)in f||r(a)?!0:!1}function q(c){for(var d=0;d<g.length;d++){var e=new RegExp(b.decode(g[d]),a);if(e.test(c))return!0}return!1}function r(c){for(var d=0;d<h.length;d++){var e=new RegExp(b.decode(h[d]),a);if(e.test(c))return!0}return!1}var a="i",b=SN.Base64Encoder,c={INCLUSION:0,EXCLUSION:1,BOTH:2,NONE:3},d=null,e=null,f=null,g=null,h=null,s={shouldServeURL:n,filterTypeEnum:c,setFilterType:i,setInfilters:j,setOutfilters:k,setInfilterRegexList:l,setOutfilterRegexList:m};return s}(),typeof SN=="undefined"&&(SN={}),SN.ConfigurationManager=function(){function getRuntimeFSMVarValue(a){return runtimeFSMVariables[a]}function setRuntimeFSMVarValue(a,b){runtimeFSMVariables[a]=b}function isActionPage(){var a=getActionPageURL(),b=utils.getActionPageURL(a);return utils.getRootContext()+parent.location.pathname==b}function getActionContext(){return SN.ChildWindowController.getContext()}function setBootstrapParams(a){bootstrapParams=a}function getBootstrapParams(){return bootstrapParams}function saveInitConfiguration(a){initConfig=a,initPageId(initConfig[INIT_JS_PAGE_ID]),initTrackId(initConfig[INIT_JS_TRACK_ID]),pspKey=initConfig[INIT_JS_PSP_KEY],pageConfigs=initConfig[INIT_JS_PAGE_CONFIGS],widgetConfigs=initConfig[INIT_JS_WIDGET_CONFIGS],sccAppConfigs=initConfig[INIT_JS_SCC_APP_CONFIGS],sccModuleConfigs=initConfig[INIT_JS_SCC_MODULE_CONFIGS],wowpxAppConfigs=initConfig[INIT_JS_WOWPX_APP_CONFIGS],initializeMappedRuleVariables(initConfig[INIT_JS_MAPPED_RULE_VARIABLES])}function saveBootstrapConfiguration(a){bootstrapConfig=a.bsdata,parent.SN.Conf.dataStore=="server"&&(serverData=a.serverData);if($undefinedOrNull(bootstrapConfig)){utils.warn("bootstrap configuration is undefined");return}clientTs=(new Date).getTime(),visitorId=bootstrapConfig[BOOTSTRAP_JS_VISITOR_ID],visitorGroup=bootstrapConfig[BOOTSTRAP_JS_VISITOR_GROUP],serverTimeStamp=bootstrapConfig[BOOTSTRAP_JS_SERVER_TIME_STAMP],SN.Utils.setServerTimeStamp(serverTimeStamp),clientTimeZoneOffset=bootstrapConfig[BOOTSTRAP_JS_CLIENT_TIMEZONE_OFFSET],SN.Utils.setClientTimeStamp(clientTimeZoneOffset),targetPopulationId=bootstrapConfig[BOOTSTRAP_JS_TARGET_POPULATION_ID],tpRandomNumber=bootstrapConfig[SN_CONSTANTS.TP_RANDOM_NUMBER],vgRandomNumber=bootstrapConfig[SN_CONSTANTS.VG_RANDOM_NUMBER],asLifeTime=bootstrapConfig[SN_CONSTANTS.ACTIVE_SESSION_LIFE_TIME],rnLifeTime=bootstrapConfig[SN_CONSTANTS.RANDOM_NO_LIFE_TIME],samplingStorage=bootstrapConfig[SN_CONSTANTS.SAMPLING_STORAGE],targetId=bootstrapConfig[BOOTSTRAP_JS_TARGET_ID],repeatVisitorLifetime=bootstrapConfig[SN_CONSTANTS.REPEAT_VISITOR_LIFETIME],utils.setStoreLifetime(SN_CONSTANTS.SN_RN_STORE_NAME,bootstrapConfig[SN_CONSTANTS.RANDOM_NO_LIFE_TIME]),utils.setStoreLifetime(SN_CONSTANTS.SN_AS_STORE_NAME,bootstrapConfig[SN_CONSTANTS.ACTIVE_SESSION_LIFE_TIME]),utils.setStoreLifetime(SN_CONSTANTS.SN_VI_STORE_NAME,bootstrapConfig[SN_CONSTANTS.VID_LIFETIME]),utils.setStoreLifetime(SN_CONSTANTS.SN_WEBTRACKER_STORE_NAME,bootstrapConfig[SN_CONSTANTS.WT_STORE_LIFETIME]),utils.setStoreLifetime(SN_CONSTANTS.SN_VARIABLE_STORE_NAME,bootstrapConfig[SN_CONSTANTS.VARIABLE_STORE_LIFETIME]),utils.setMaxUIEntries(bootstrapConfig[SN_CONSTANTS.MAX_UI_STORE_ENTRIES]),utils.setStoreLifetime(SN_CONSTANTS.SN_EXIT_HISTORY_STORE_NAME,bootstrapConfig[SN_CONSTANTS.EXIT_HISTORY_LIFETIME]),startRE=bootstrapConfig[BOOTSTRAP_JS_START_RE];var b=bootstrapConfig[BOOTSTRAP_JS_GEO];$undefinedOrNull(b)||(geo=b,$undefinedOrNull(geo.isp)||$undefinedOrNull(geo.isp.geoPrivateIp)||utils.setGeoPrivateIp(geo.isp.geoPrivateIp)),pollingInterval=bootstrapConfig[BOOTSTRAP_JS_POLLING_INTERVAL],$undefinedOrNull(pollingInterval)&&(pollingInterval=1e3),ruleConfigs=bootstrapConfig[BOOTSTRAP_JS_RULE_CONFIGS],ruleGroupId=bootstrapConfig[BOOTSTRAP_JS_RULE_GROUP_ID],eventOnLoad=bootstrapConfig[BOOTSTRAP_JS_EVENT_ON_LOAD],fsmUpdateVariables=bootstrapConfig[BOOTSTRAP_JS_UPDATES]||[],fsmDeleteVariables=bootstrapConfig[BOOTSTRAP_JS_DELETES]||[],trackableEventMetadatas=bootstrapConfig[BOOTSRAP_JS_TRACKABLE_EVENT_CONFIGS],trackableEvents=bootstrapConfig[BOOTSTAP_JS_TRACKABLE_EVENTS],bootstrapCachingOn=bootstrapConfig[BOOTSTRAP_JS_CACHING_ON]}function saveGetRulesConfiguration(a){var b=a.ruledata;rules=b[GET_RULES_RULES],initializeGeneratedRuleVariables(b[GET_GENERATED_RULES_VARIABLES])}function getFSMUpdateVariables(){return fsmUpdateVariables}function getFSMDeleteVariables(){return fsmDeleteVariables}function getRules(){return rules}function getRuleCustomData(a){return $undefinedOrNull(rules)||$undefinedOrNull(rules[a])?null:rules[a].customdata}function getGeneratedRuleVariables(){return generatedRuleVariables}function getGeneratedRuleVariableValue(a){var b=null;return $undefinedOrNull(generatedRuleVariables[a])||(b=generatedRuleVariables[a].value),b}function updateGeneratedRuleVariable(a,b){if($undefinedOrNull(generatedRuleVariables)||$undefinedOrNull(generatedRuleVariables[a]))return;generatedRuleVariables[a].value=b}function updateMappedRuleVariables(a,b){var c=a.mappedvariables;if($undefinedOrNull(c)||$undefinedOrNull(b))return;for(var d=0;d<c.length;d++){var e=c[d],f=e.name;if(!$undefinedOrNull(f)){var g=mappedRuleVariables[f];$undefinedOrNull(g)||(a.rollingcount>0?e.mappingindex<b.length&&(g.value=b[e.mappingindex]):g.value=b)}}}function getHandlerConfig(a){var b=ruleConfigs[a];return b==null||b.handlerConfig==null?{}:b.handlerConfig}function getEventhandlerConfig(a){if(a==null)return{};var b=initConfig[INIT_JS_PLATFORM_CONFIGS],c=initConfig[INIT_JS_PRECHAT_CONFIGS],d={};a.platformConfigName!=null&&(d.platformConfig=b[a.platformConfigName]);var e=a.preChatConfigName;return e!=null&&c!=null&&(d.preChatConfig=c[e]),d.handlerType=a.handlerType,d}function getWowpxAppConfigs(){return wowpxAppConfigs}function getTrackableRuleVariables(a,b){var c=getEventMetadata(a);if(!$undefinedOrNull(b)){var d=overrideByRuleEventMetadata(b,a);$undefinedOrNull(d)||(c=d)}return $undefinedOrNull(c)&&(c={ruleVarsToTrack:"r"}),getTrackingRuleVariablesMap(c.ruleVarsToTrack,b)}function getTrackableFSMVariables(a,b){var c=getEventMetadata(a);if(!$undefinedOrNull(b)){var d=overrideByRuleEventMetadata(b,a);$undefinedOrNull(d)||(c=d)}if($undefinedOrNull(c)||$undefinedOrNull(c.variables))return null;var e=c.variables,f={},g=e.length,h=SN.SessionManager;for(var i=0;i<g;i++){var j=fsmUpdateVariables.length;for(var k=0;k<j;k++){var l=fsmUpdateVariables[k];if(e[i].key==l.key){var m=h.doGetFSMVariable(l);if(!$undefinedOrNull(m))if(typeof m=="object")try{for(var n in m)m[n]==undefined||m[n]==null||m[n]==="undefined"||m[n]==="null"||m[n]===""?delete m[n]:m[n]=encodeURIComponent(m[n]);f[l.key]=m}catch(o){utils.errorTrack("ErrorInConstructingMapOfMapInFSMVariable ",o)}else f[l.key]=encodeURIComponent(m)}}}return f}function overrideByRuleEventMetadata(a,b){var c=getRuleConfig(a);if($undefinedOrNull(c))return null;var d=c[RULE_TRACKABLE_EVENTS];if($undefinedOrNull(d))return null;var e=d[b];if($undefinedOrNull(e))return null;var f=e.config,g=c[RULE_TRACKABLE_EVENT_CONFIGS];return $undefinedOrNull(g)?null:g[f]}function getEventMetadata(a){if($undefinedOrNull(trackableEvents)||$undefinedOrNull(trackableEventMetadatas))return null;var b=trackableEvents[a];return $undefinedOrNull(b)?null:trackableEventMetadatas[b.config]}function getAllRuleVariablesForCurrentPage(){var a={};if(!$undefinedOrNull(generatedRuleVariables))for(var b in generatedRuleVariables){var c=generatedRuleVariables[b];$undefinedOrNull(c.value)||(a[b]=c.value)}if(!$undefinedOrNull(mappedRuleVariables))for(var b in mappedRuleVariables){var d=mappedRuleVariables[b].value;$undefinedOrNull(d)||(a[b]=d)}return a}function getRuleVariablesForRuleId(a){var b={};if($undefinedOrNull(rules))return b;var c=rules[a].genvariables;if(!$undefinedOrNull(c)){var d=c.length;for(var e=0;e<d;e++){var f=c[e],g=generatedRuleVariables[f];b[f]=g.value}}var h=rules[a].mappedvariables;if(!$undefinedOrNull(h)){var d=h.length;for(var e=0;e<d;e++){var f=h[e],i=mappedRuleVariables[f].value;$undefinedOrNull(i)||(b[f]=i)}}return b}function getTrackingRuleVariablesMap(a,b){var c={};if($undefinedOrNull(a))return null;if(a==NO_RULE_VARS_TO_TRACK)return null;if(a==ONLY_THIS_RULES_VARS_TO_TRACK){if($undefinedOrNull(b))return null;c=getRuleVariablesForRuleId(b)}else a==ALL_RULE_VARS_TO_TRACK&&(c=getAllRuleVariablesForCurrentPage());return c}function getMappedRuleVariables(){return mappedRuleVariables}function getMappedRuleVariableValue(a){var b=null;return $undefinedOrNull(mappedRuleVariables[a])||(b=mappedRuleVariables[a].value),b}function getPollingInterval(){return pollingInterval}function getRuleConfig(a){return $undefinedOrNull(ruleConfigs)?null:ruleConfigs[a]}function getWidgetConfig(a){if($undefinedOrNull(widgetConfigs))return null;var b=getRuleConfig(a);if($undefinedOrNull(b))return null;var c=b[INIT_JS_WIDGET_CONFIG_NAME];return $undefinedOrNull(c)?null:widgetConfigs[c]}function getWowpxWidgetConfigs(a){return $undefinedOrNull(a)?null:widgetConfigs[a]}function getRuleGroupId(){return ruleGroupId}function getOnLoadEvent(){return eventOnLoad}function initPageId(pageIdExpression){try{isActionPage()||$undefinedOrNull(initConfig[INIT_JS_PAGE_ID])?pageId=SN.ChildWindowController.getContext():pageId=eval(pageIdExpression)}catch(err){utils.error("Failed to evaluate pageid expression: "+pageIdExpression,err),pageId=undefined}}function initTrackId(trackIdExpression){try{isActionPage()?trackId=SN.ChildWindowController.getContext():trackId=eval(trackIdExpression)}catch(err){utils.error("Failed to evaluate trackingid expression: "+trackIdExpression,err),trackId=undefined}}function getTrackId(){return trackId}function getVisitorGroup(){return visitorGroup}function getServerTimeStamp(){return serverTimeStamp}function getClientTimeZoneOffset(){return clientTimeZoneOffset}function getTargetId(){return targetId}function getTargetPopulationId(){return targetPopulationId}function getTPRandomNumber(){return tpRandomNumber}function getVGRandomNumber(){return vgRandomNumber}function getActiveSessionLifeTime(){return asLifeTime}function getRandomNoLifeTime(){return rnLifeTime}function getRepeatVisitorLifetime(){return repeatVisitorLifetime*1e3}function getSamplingStorage(){return"as"}function getVisitorId(){return visitorId}function shouldStartRE(){return startRE}function getFSMState(){return bootstrapConfig[BOOTSTRAP_JS_STATE]}function getPageId(){return pageId}function getPSPKey(){return pspKey}function setPSPKey(a){pspKey=a}function getPSPVersion(){return utils.getPSPVersion()}function setPSPVersion(a){pspVersion=a}function getPSPRoot(){return utils.getPSPRoot()}function getPSPWebContentUrl(){return utils.getPSPWebContentUrl()}function getPSPStaticRoot(){return pspStaticRoot}function setPSPStaticRoot(a){pspStaticRoot=a}function getPageConfig(a){return $undefinedOrNull(pageConfigs)?null:pageConfigs[a]}function getHotSpots(a){var b=getPageConfig(a);return $undefinedOrNull(b)?null:b.hotspots}function getGeoInfo(){return geo||{}}function getParamsToBePassedToChat(a){return SN.ParamsToChat||[]}function setActionPageURL(a){actionPageURL=a}function getActionPageURL(){return actionPageURL}function initializeGeneratedRuleVariables(a){var b=a.length;for(var c=0;c<b;c++){var d=a[c];generatedRuleVariables[d.key]=d}}function initializeMappedRuleVariables(a){var b=a.length;for(var c=0;c<b;c++)mappedRuleVariables[a[c].key]=a[c]}function getConversionTrackingIdIS(){return initConfig.conversionTrackingIdIS}function getAllVisitorTags(a){a.vg=getVisitorGroup(),a.vi=getVisitorId(),a.ti=getTargetId(),a.tp=getTargetPopulationId()}function isBootstrapCachingOn(){return bootstrapCachingOn}function isXDChannelReady(){return xdChannelReady}function isMigrationDone(){return migrationDone}function setMigrationFlag(a){migrationDone=a}function setXDChannelReady(a){xdChannelReady=a}function getVisitedUrlLimit(){return VISITED_URL_LIMIT}function getUrlsLimit(){return VISITED_URLS_COUNT}var INIT_JS_PSP_KEY="pspkey",INIT_JS_PAGE_ID="pageid",INIT_JS_TRACK_ID="trackid",INIT_JS_PAGE_CONFIGS="pageconfigs",INIT_JS_SCC_APP_CONFIGS="sccAppConfigs",INIT_JS_WOWPX_APP_CONFIGS="wowpxAppConfigs",INIT_JS_SCC_MODULE_CONFIGS="sccModuleConfigs",INIT_JS_WIDGET_CONFIGS="widgetconfigs",INIT_JS_PLATFORM_CONFIGS="chatPlatformConfigs",INIT_JS_PRECHAT_CONFIGS="preChatConfigs",INIT_JS_WIDGET_CONFIG_NAME="widgetConfigName",INIT_JS_MAPPED_RULE_VARIABLES="mappedrulevariables",BOOTSTRAP_JS_VISITOR_ID="vi",BOOTSTRAP_JS_START_RE="startRE",BOOTSTRAP_JS_VISITOR_GROUP="vg",BOOTSTRAP_JS_SERVER_TIME_STAMP="serverTimeStamp",BOOTSTRAP_JS_CLIENT_TIMEZONE_OFFSET="clientTimeZoneOffset",BOOTSTRAP_JS_TARGET_ID="ti",BOOTSTRAP_JS_TARGET_POPULATION_ID="tp",BOOTSTRAP_JS_POLLING_INTERVAL="poll",BOOTSTRAP_JS_RULE_CONFIGS="ruleconfigs",BOOTSTRAP_JS_STATE="newState",BOOTSTRAP_JS_UPDATES="updates",BOOTSTRAP_JS_DELETES="deletes",BOOTSTRAP_JS_RULE_GROUP_ID="rgid",BOOTSTRAP_JS_GEO="geo",BOOTSTRAP_JS_EVENT_ON_LOAD="onload",BOOTSRAP_JS_TRACKABLE_EVENT_CONFIGS="trackableEvtCfgs",BOOTSTAP_JS_TRACKABLE_EVENTS="trackableEventIds",BOOTSTRAP_JS_CACHING_ON="bootstrapCachingOn",GET_RULES_RULES="rules",GET_GENERATED_RULES_VARIABLES="generatedvariables",RULE_TRACKABLE_EVENT_CONFIGS="trackableEvtCfgs",RULE_TRACKABLE_EVENTS="trackableEventIds",NO_RULE_VARS_TO_TRACK="n",ONLY_THIS_RULES_VARS_TO_TRACK="r",ALL_RULE_VARS_TO_TRACK="a",VISITED_URL_LIMIT=60,VISITED_URLS_COUNT=5,initConfig={},bootstrapConfig={},pspStaticRoot=null,pspKey=null,pageId=null,trackId=null,rules={},generatedRuleVariables={},mappedRuleVariables={},pollingInterval=null,ruleConfigs=[],widgetConfigs={},sccAppConfigs={},wowpxAppConfigs={},sccModuleConfigs={},trackableEventMetadatas=[],trackableEvents=[],fsmUpdateVariables=null,fsmDeleteVariables=null,eventOnLoad=null,ruleGroupId=null,geo=null,clientTs=null,pageConfigs=null,actionPageURL=null,pspVersion=null,visitorId=null,startRE=null,visitorGroup=null,serverTimeStamp=null,clientTimeZoneOffset=null,targetPopulationId=null,tpRandomNumber=null,vgRandomNumber=null,asLifeTime=null,rnLifeTime=null,samplingStorage=null,targetId=null,bootstrapParams=null,runtimeFSMVariables={},repeatVisitorLifetime=null,bootstrapCachingOn=!1,xdChannelReady=!1,migrationDone=!1,utils=SN.Utils,SN_CONSTANTS=SN.Constants,me={getRuntimeFSMVarValue:getRuntimeFSMVarValue,setRuntimeFSMVarValue:setRuntimeFSMVarValue,isActionPage:isActionPage,getActionContext:getActionContext,saveInitConfiguration:saveInitConfiguration,saveBootstrapConfiguration:saveBootstrapConfiguration,saveGetRulesConfiguration:saveGetRulesConfiguration,getFSMUpdateVariables:getFSMUpdateVariables,getFSMDeleteVariables:getFSMDeleteVariables,getRules:getRules,getRuleCustomData:getRuleCustomData,getGeneratedRuleVariables:getGeneratedRuleVariables,getGeneratedRuleVariableValue:getGeneratedRuleVariableValue,updateGeneratedRuleVariable:updateGeneratedRuleVariable,updateMappedRuleVariables:updateMappedRuleVariables,getHandlerConfig:getHandlerConfig,getEventhandlerConfig:getEventhandlerConfig,getTrackableRuleVariables:getTrackableRuleVariables,getTrackableFSMVariables:getTrackableFSMVariables,getMappedRuleVariables:getMappedRuleVariables,getMappedRuleVariableValue:getMappedRuleVariableValue,getPollingInterval:getPollingInterval,getRuleConfig:getRuleConfig,getRuleGroupId:getRuleGroupId,getOnLoadEvent:getOnLoadEvent,getTrackId:getTrackId,getVisitorGroup:getVisitorGroup,getServerTimeStamp:getServerTimeStamp,getClientTimeZoneOffset:getClientTimeZoneOffset,getTargetId:getTargetId,getTargetPopulationId:getTargetPopulationId,getTPRandomNumber:getTPRandomNumber,getVGRandomNumber:getVGRandomNumber,getActiveSessionLifeTime:getActiveSessionLifeTime,getRandomNoLifeTime:getRandomNoLifeTime,getRepeatVisitorLifetime:getRepeatVisitorLifetime,getSamplingStorage:getSamplingStorage,getVisitorId:getVisitorId,getAllVisitorTags:getAllVisitorTags,shouldStartRE:shouldStartRE,getFSMState:getFSMState,getPageId:getPageId,getPSPKey:getPSPKey,setPSPKey:setPSPKey,getPSPVersion:getPSPVersion,setPSPVersion:setPSPVersion,getPSPRoot:getPSPRoot,setPSPStaticRoot:setPSPStaticRoot,getPSPStaticRoot:getPSPStaticRoot,getPSPWebContentUrl:getPSPWebContentUrl,getHotSpots:getHotSpots,getGeoInfo:getGeoInfo,setActionPageURL:setActionPageURL,getActionPageURL:getActionPageURL,getConversionTrackingIdIS:getConversionTrackingIdIS,getWowpxAppConfigs:getWowpxAppConfigs,getWowpxWidgetConfigs:getWowpxWidgetConfigs,getBootstrapParams:getBootstrapParams,setBootstrapParams:setBootstrapParams,isBootstrapCachingOn:isBootstrapCachingOn,isXDChannelReady:isXDChannelReady,setXDChannelReady:setXDChannelReady,isMigrationDone:isMigrationDone,setMigrationFlag:setMigrationFlag,getVisitedUrlLimit:getVisitedUrlLimit,getUrlsLimit:getUrlsLimit};return me}(),typeof SN=="undefined"&&(SN={}),SN.XDFrameMessagingUtils=function(){function f(a,c,f){try{if(!c)return;a=typeof a=="string"?a:encodeURIComponent(JSON.stringify(a).split(" ").join("")),f=f||parent,e&&f[b](a,c.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}catch(g){d.error("errorWhileMakingPostMessage call to XD Iframe with message:"+a,g)}}function g(b,f,g){try{e&&(a[c]?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b))}catch(h){d.error("errorWhilereceivingMessage from XD Iframe:"+h)}}var a=this,b="postMessage",c="addEventListener",d=SN.Utils,e=a[b],h={postMessage:f,receiveMessage:g};return h}(),typeof SN=="undefined"&&(SN={}),SN.Store=function(){function i(){var a=e.length;for(var c=0;c<a;c++){var d=e[c],i=h[d];if(i.test()){f=i,g=d;break}}f==null?(b.errorTrack("No client side storage could be obtained on this browser, falling back to cookie storage",navigator.userAgent),b.setAvailableStore("cookie")):(f.init(),b.setAvailableStore(l()))}function j(){return Object.isUndefined(f)||f==null?!1:f.isReady()}function k(a){if(Object.isUndefined(a)||a==null)throw"Invalid store id";return new m(a)}function l(){return g}var a=SN.Constants,b=SN.Utils,c="SN",d=c+"_user_data",e=["localstorage","ie"],f=null,g=null,h={ie:{test:function(){return window.ActiveXObject?!0:!1},init:function(){var a=document.createElement("div");a.id=d+"-div",a.addBehavior("#default#userData"),document.body.appendChild(a),this.el=a,this.el.load(d)},key:function(a,b){return encodeURIComponent(a)+encodeURIComponent(b)},get:function(a,b){return $undefinedOrNull(b)?this.el.getAttribute(a):this.el.getAttribute(this.key(b,a))},set:function(a,b,c){if($undefinedOrNull(c))this.el.setAttribute(a,b);else{var e=this.key(c,a);this.el.setAttribute(e,b)}return this.el.save(d),b},remove:function(a,b){var c;if($undefinedOrNull)c=this.el.removeAttribute(a);else{var e=this.key(b,a);c=this.el.removeAttribute(e)}return this.el.save(d),c},clear:function(a){var b=encodeURIComponent(a),c=this.el,e=c.xmlDocument,f=e.firstChild.attributes,g=f.length;while(g>0){var h=f[--g],i=h.nodeName;i.indexOf(b)==0&&c.removeAttribute(i)}c.save(d)},isReady:function(){return typeof this.el!=a.UNDEFINED_STR&&this.el!=null}},localstorage:{test:function(){return window.localStorage?!0:!1},init:function(){this.store=window.localStorage},key:function(a,b){return $undefinedOrNull(b)?encodeURIComponent(a):encodeURIComponent(b)+encodeURIComponent(a)},get:function(a,b){return $undefinedOrNull(b)?this.store.getItem(a):this.store.getItem(this.key(b,a))},set:function(a,b,c){return $undefinedOrNull(c)?this.store.setItem(a,b):this.store.setItem(this.key(c,a),b)},remove:function(a,b){return $undefinedOrNull(b)?this.store.removeItem(a):this.store.removeItem(this.key(b,a))},clear:function(a){var b=encodeURIComponent(a);for(var c=0;c<localStorage.length;c++){var d=localStorage.key(c);d.indexOf(b)==0&&(localStorage.removeItem(d),c--)}},isReady:function(){return this.store!=null}}},m=function(a){var b=a;this.get=function(a){return f.get(a)},this.set=function(a,b){return f.set(a,b)},this.remove=function(a){return f.remove(a)},this.clear=function(){f.clear(b)}},n={isReady:j,getStore:k,getType:l};return i(),n}(),$undefined(SN)&&(SN={}),SN.EventManager=function(){function e(c,d){b.observe(a.EVENT_PREFIX+c,function(b){b.memo.st=(new Date).getTime();try{d(b),b.memo.status=a.ACTION_COMPLETED}catch(c){}})}function f(c,e){$undefinedOrNull(e)&&(e={}),$undefinedOrNull(e.data)&&(e.data={}),e[a.SEQUENCE_ID]=d++;var f=a.EVENT_PREFIX+c;b.fire(f,e)}function g(b,c){$undefinedOrNull(b)&&(b={});var d=b.ed;$undefinedOrNull(d)&&(d={exceptionMsg:"unknown exception"}),d.x=!0,$undefinedOrNull(c)||(d.exceptionMsg=c),b.ed=d;var e={eventId:a.INTERNAL_ERROR,data:b};f(a.EXCEPTION_EVENT,e)}var a=SN.Constants,b=document,c=SN.Utils,d=0,h={observe:e,fire:f,fireException:g};return h}(),typeof SN=="undefined"&&(SN={}),SN.CrossXDataHandler=function(){function l(){var c=b.getType();c==e.IE_STORAGE&&(a=!1)}function m(){c.info("Setting Reference protocol to "+document.location.protocol),g="https://"+SN.Utils.getPSPServerName(),c.setPSPServerUrl(g),i=c.getClientKey(),l(),a?(SN.XDFrameMessagingUtils.receiveMessage(o,g),p()):n()}function n(){f=!0,d.setXDChannelReady(f)}function o(a){var b=null,g=null,h=a.data.split("&");for(var i=0;i<h.length;i++)h[i].indexOf("cmd")==0&&(b=h[i].replace("cmd=","")),h[i].indexOf("params")==0&&(g=h[i].replace("params=",""));if(b==e.IFRAME_LOADED){var a=JSON.parse(g);if(a.loaded==e.REFERENCE_LOADED_ITEM){c.infoTrack("onXDIframeLoaded"),f=!0,d.setXDChannelReady(f);if(c.isCrossDomainSupported()){var j=a.data;SN.StoreManager.setCrossDomainData(j),d.setMigrationFlag(!0)}parent.SN.Conf.dataStore!="server",c.info("XD Iframe is ready for communication")}}else if(b==e.GET_LOCAL_STORAGE_ITEM){var a=JSON.parse(g),l=a.uniqueId,m=a.value,n=k[l];if($undefinedOrNull(n))return;try{delete k[l],n(a.key,m)}catch(o){c.error("failed to make call back for key :"+a.key)}}else if(b==e.SET_LOCAL_STORAGE_ITEM){var a=JSON.parse(g),l=a.uniqueId,n=k[l];if($undefinedOrNull(n))return;try{delete k[l],n(a.key)}catch(o){c.error("failed to make call back for key :"+a.key)}}else{if(b!=e.REMOVE_LOCAL_STORAGE_ITEM)return;var a=JSON.parse(g),l=a.uniqueId,n=k[l];if($undefinedOrNull(n))return;try{delete k[l],n(a.key)}catch(o){c.error("failed to make call back for key :"+a.key)}}}function p(){c.infoTrack("b4CreateXDIframe");var a=e.PARENT_DOMAIN+"="+location.protocol+"//"+location.hostname+"&clientkey="+i+"&version="+parent.SN.Conf.CONST_CDN_VERSION+"&pspv="+parent.SN.Conf.CONST_PSP_VERSION+"&n=1&caller=refloaded"+"&l="+c.getLogLevel()+"&s="+SN.Conf.dataStore,b=new Element("div");document.body.appendChild(b),Element.hide(b),h=new Element("iframe",{id:e.REFERENCE_IFRAME_ID,name:e.REFERENCE_IFRAME_NAME,frameborder:"0",width:"0px",height:"0px"});var d=g+c.getPsdxdPath()+"#";h.src=d+a;try{b.appendChild(h)}catch(j){c.error("issue in creating the iFrame"+j),f=!1}}function q(b){if(!a)return;var d={};d.cmd=e.SET_XD_DATA,d.params=b;var f=document.getElementById(e.REFERENCE_IFRAME_ID);SN.XDFrameMessagingUtils.postMessage(JSON.stringify(d),c.getPSPServerUrl(),f.contentWindow)}function r(b,d,f,g){if($undefinedOrNull(b)||$undefinedOrNull(d)||$undefinedOrNull(f)||isNaN(f))return;if(!a)return;var h=c.getUniqueId();k[h]=g;var i={};i.cmd=e.SET_LOCAL_STORAGE_ITEM;var j={};j.key=b,j.value=d,j.lifeTime=f,j.uniqueId=h,i.params=j;var l=document.getElementById(e.REFERENCE_IFRAME_ID);SN.XDFrameMessagingUtils.postMessage(JSON.stringify(i),c.getPSPServerUrl(),l.contentWindow)}function s(b,d){if(!a)return;var f=c.getUniqueId();k[f]=d;var g={};g.cmd=e.GET_LOCAL_STORAGE_ITEM;var h={};h.key=b,h.uniqueId=f,g.params=h;var i=document.getElementById(e.REFERENCE_IFRAME_ID);SN.XDFrameMessagingUtils.postMessage(JSON.stringify(g),c.getPSPServerUrl(),i.contentWindow)}function t(b,d){if(!a)return;var f=c.getUniqueId();k[f]=d;var g={};g.cmd=e.REMOVE_LOCAL_STORAGE_ITEM;var h={};h.key=b,h.uniqueId=f,g.params=h;var i=document.getElementById(e.REFERENCE_IFRAME_ID);SN.XDFrameMessagingUtils.postMessage(JSON.stringify(g),c.getPSPServerUrl(),i.contentWindow)}var a=!0,b=SN.Store,c=SN.Utils,d=SN.ConfigurationManager,e=SN.Constants,f=!1,g=null,h=null,i=null,j=SN.EventManager,k={};j.observe(e.CUSTOM_INITIALIZATION_COMPLETED,m);var u={sendXDData:q,setLocalStorageItem:r,getLocalStorageItem:s,removeLocalStorageItem:t};return u}(),window._tfsc=window._tfsc||parent._tfsc;if(!window._tfsc||!_tfsc.env)window._tfsc&&typeof _tfsc.getPath=="function"?_tfsc.env=function(){return _tfsc.STAGING_URL.match(/(.*?)\//)&&_tfsc.getPath().match(/(.*?)\//)[1]===_tfsc.STAGING_URL.match(/(.*?)\//)[1]?"s":_tfsc.PRODUCTION_URL.match(/(.*?)\//)&&_tfsc.getPath().match(/(.*?)\//)[1]===_tfsc.PRODUCTION_URL.match(/(.*?)\//)[1]?"p":"o"}():location.href.match(/[&\?]env=([pos])(&.*)?/)?window._tfsc={env:location.href.match(/[&\?]env=([pos])(&.*)?/)[1],getPath:function(){return location.href.match(/[&\?]cdnPath=(.*)(&.*)?/)[1]}}:window._tfsc={env:"p"};typeof SN=="undefined"&&(SN={}),SN.Conf=function(){function a(a){return a}function b(){var a=window.location.href;return a.indexOf("testsite1")!=-1?"X":a.indexOf("testsite2")!=-1?"Y":"id"}function d(){var a=b();return c[a]}function g(){return this.CUSTOM_TRACK_SERVER}var c={X:["subtenant1"],Y:["subtenant2"],id:["subtenant1","subtenant2"]},e="bestbuypsp-staging.px.247-inc.com/psp/bestbuy-v1-001/default/cpxt.js",f="bestbuypsp.px.247-inc.com/psp/bestbuy-v1-001/default/cpxt.js",h=null,i=null,j=null,k=null;return function(){switch(_tfsc.env){case"p":h="bestbuypsp.px.247inc.net",i="d1af033869koo7.cloudfront.net",j="bestbuy.vs.assist.247-inc.net",k="bestbuy.ca.assist.247-inc.net";break;case"s":h="bestbuypsp-staging.px.247inc.net",i="d2j8jkom7xmn9n.cloudfront.net",j="bestbuy.vs.assist.staging.247-inc.net",k="bestbuy.ca.assist.staging.247-inc.net";break;case"o":h="bestbuypsp-staging.px.247inc.net",i=_tfsc.getPath().match(/(.*?)\//)[1],j="bestbuy.vs.assist.staging.247-inc.net",k="bestbuy.ca.assist.staging.247-inc.net"}}(),{CONST_PSP_KEY:"bestbuy-v1-001",CUSTOM_TRACK_SERVER:h,CONST_PSP_ROOT:h,CONST_PSP_CDN_ROOT:i,PROXY_SERVER:h+"/tps/tpsp.php?",SPACER_IMAGEPATH:h+"/",CDN_DOMAIN:i+"/psp/",DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION:{"www-ssl.bestbuy.com":"www-ssl.bestbuy.com/247/247chat.html","www.bestbuybusiness.com":"www.bestbuybusiness.com/bbfb/en/US/bb_info/content/psp247/247chat.html","bestbuybusiness.com":"bestbuybusiness.com/bbfb/en/US/bb_info/content/psp247/247chat.html","bbfb-vip-pl1-ext.bestbuy.com":"bbfb-vip-pl1-ext.bestbuy.com/bbfb-static-q03/en/US/bb_info/content/psp247/247chat.html","epro-pl.bestbuybusiness.com":"epro-pl.bestbuybusiness.com/bbfb-static-q03/en/US/bb_info/content/GeekSquad/global/psp247/247chat.html","business.geeksquad.com":"business.geeksquad.com/bbfb/en/US/bb_info/content/PILOT_3424234234236/global/psp247/247chat.html"},CONST_PXFWK_ID:"pxfwk.gz.js",CONST_PSP_VERSION:"default",PXOE_VERSION:"6.3",TRACKING_VERSION:"1.5",CONST_CDN_VERSION:"20160114095200",CONST_PSP_STAGE:"p",pspxdPath:"/pspxd.html",CONST_PSP_VISITOR_PERCENTAGE:100,CONST_ASSIST_VS_ROOT:j,CONST_ASSIST_CA_ROOT:k,pluginsToBeTracked:!1,mimeTypesToBeTracked:!1,browserGeoLocationFlag:!1,timeOutForBrowserGeoLocation:1e4,pollingTime:1e4,trackingUrlFlag:!1,varMapFlag:!1,CUSTOM_TRACKING_PERCENTAGE:100,varmap:{"<key>":"<value>"},FSM:{currentPageUrl:"document.location.href",referrer:"parent.document.referrer",title:"parent.document.title",el:'SN.Conf.getDecodedValue(SN.CookieManager.readSNCookie("sn.eh","el"))'},ED:{},ruleTypeMapping:null,japCharMap:{"0xff1f":"?","0xff0f":"/"},MAX_COOKIE_SIZE:2e3,MAX_COOKIE_COUNT_THRESHOLD:60,MIN_COOKIE_COUNT_THRESHOLD:45,DISABLED_COOKIES:[],COOKIEPATH:["www.bestbuy.com","www-ssl.bestbuy.com","espanol.bestbuy.com","espanol-ssl.bestbuy.com","www.cdc-172-16-22-151.cdc.bestbuy.com","espanol.cdc-172-16-22-151.cdc.bestbuy.com","www.bestbuybusiness.com","business.geeksquad.com"],INVALID_COOKIE_CHARACTERS:["&",">","<","#",";","javascript","\0","script","ATTACK","REPLACE","STYLE","%2F","ALERT","TRACE","X_IGNORE","X-NADA:","GET","","%3C",")","(","%3E","APPEND","SCRIPT","attack","replace","style","append","alert","trace","x_ignore","get","x-nada:","%3c","%3e","%2f","JAVASCRIPT","","?","&lsquo;","?","&rsquo;","&lt;","&gt;"],dataStore:"cookie",viStore:"cookie",viStoreName:"sn.vi",isViStoreSession:!1,shouldMaintainVi:!0,customDataSizeInViStore:2,tnt:"nemo-client-bestbuy",stnt:d,getDecodedValue:a,getUrlId:b,getCpxtDomain:g,SOCIAL_STORE_ID:"s51d520214c1b7",SOCIAL_BASE_URL:document.location.protocol+"//social.247-inc.com",ADP_BASE_URL:"http://ec2-54-242-63-0.compute-1.amazonaws.com/",IS_DS_REQUIRED:!1,TEST_PERCENTAGE:0,BYPASS_PERCENTAGE:0,PEAK_HOUR_START:0,PEAK_HOUR_STOP:1600,OFFPEAK_BYPASS:0,working_hours:{monday_start:"9",monday_end:"18",tuesday_start:"9",tuesday_end:"18",wednesday_start:"9:20",wednesday_end:"18:30",thursday_start:"9",thursday_end:"20:30",friday_start:"9",friday_end:"18",saturday_start:"9",saturday_end:"18",sunday_start:"9",sunday_end:"18"},timezone:"+5:30",blackListedVersions_browsers:{browserLevel:[],Firefox:[],Android:[],Version:[],Chrome:[],CriOS:[],MSIE:[]},blackListedVersions_OS:{OSLevel:[],Windows:[],Android:[],Linux:[],MacOS:[],iOS:[]},blacklistedDeviceTypes:[]}}(),$undefined(SN)&&(SN={}),SN.CookieManager=function(){function h(c){x(b.SN_WEBTRACKER_STORE_NAME)&&v(b.SN_WEBTRACKER_STORE_NAME),x(b.SN_EXIT_HISTORY_STORE_NAME)&&v(b.SN_EXIT_HISTORY_STORE_NAME),c+=" Dropping cookies ",z()?(c+="sn.eh, sn.vc and sn.wt if existing",a.warnTrack(c)):parent.SN.Conf.DISABLED_COOKIES.length>0&&(c+=i(parent.SN.Conf.DISABLED_COOKIES)+" if existing",a.warnTrack(c))}function i(a){var b=a.length,c=new String;for(var d=0;d<b;d++)d>0&&(d<b-1?c+=", ":c+=" and "),c+=a[d];return c}function j(){var c={},d={},e=null,f=null;return d.cvalue=p(b.SN_VI_STORE_NAME),d.clifetime=a.getStoreLifetime(b.SN_VI_STORE_NAME),c[b.SN_VI_STORE_NAME]=d,parent.SN.Conf.viStore=="localstorage"&&(vi=g.getValueFromStore(b.SN_VI_STORE_NAME,b.VISITOR_ID),$undefinedOrNull(vi)&&(vi=r(b.SN_VI_STORE_NAME,b.VISITOR_ID)),$undefinedOrNull(vi)||(d.cvalue=d.cvalue+b.KEY_SEPERATOR+b.VISITOR_ID+b.KEY_VALUE_SEPERATOR+vi,c[b.SN_VI_STORE_NAME]=d)),d={},d.cvalue=p(b.SN_AS_STORE_NAME),d.clifetime=a.getStoreLifetime(b.SN_AS_STORE_NAME),c[b.SN_AS_STORE_NAME]=d,d={},x(b.SN_WEBTRACKER_STORE_NAME)?a.warn("inOnBootstrapUpdateCompleted : "+b.SN_WEBTRACKER_STORE_NAME+" cokie disabled "):(d.cvalue=p(b.SN_WEBTRACKER_STORE_NAME),d.clifetime=a.getStoreLifetime(b.SN_WEBTRACKER_STORE_NAME),c[b.SN_WEBTRACKER_STORE_NAME]=d,d={}),d.cvalue=p(b.SN_RN_STORE_NAME),d.clifetime=a.getStoreLifetime(b.SN_RN_STORE_NAME),c[b.SN_RN_STORE_NAME]=d,d={},c}function k(){if(x(b.SN_VARIABLE_STORE_NAME))return;var c={},d={},e=null,f=null;return d.cvalue=p(b.SN_VARIABLE_STORE_NAME),d.clifetime=a.getStoreLifetime(b.SN_VARIABLE_STORE_NAME),c[b.SN_VARIABLE_STORE_NAME]=d,$undefinedOrNull(d.cvalue)?null:c}function l(){var d=parent.SN.Conf.MAX_COOKIE_SIZE,e=(p(b.SN_AS_STORE_NAME)+p(b.SN_VI_STORE_NAME)+p(b.SN_WEBTRACKER_STORE_NAME)+p(b.SN_RN_STORE_NAME)+p(b.SN_EXIT_HISTORY_STORE_NAME)+p(b.SN_VARIABLE_STORE_NAME)).length;e>=d&&a.errorTrack("Cookie storage size greater than "+parent.SN.Conf.MAX_COOKIE_SIZE+" characters");if(!c){var f=document.cookie.split(";").length;!z()&&f>=parent.SN.Conf.MAX_COOKIE_COUNT_THRESHOLD?(c=!0,y(!0),h("Maximum cookie threshold reached")):z()&&f<=parent.SN.Conf.MIN_COOKIE_COUNT_THRESHOLD&&(y(!1),a.warnTrack("Minimum cookie threshold reached. Enabling creation of all cookies (except those in the disabled list)"))}}function m(c){for(var d in c){if(d==b.SN_EXIT_HISTORY_STORE_NAME||d==b.SN_WEBTRACKER_STORE_NAME||d==b.SN_VARIABLE_STORE_NAME)if(x(d)){a.warn("inSetCookies : "+d+" cokie disabled. So skipping cookie creation");continue}var e=c[d].cvalue;if(e==""||$undefinedOrNull(e)||e==undefined)continue;var f=c[d].clifetime,h={};$undefinedOrNull(f)||(h.time=parseInt(f));var i=A();if(i!=null&&i.length>0)for(var j=0;j<i.length;j++){var k="."+i[j];if(document.domain==i[j]||a.isSubDomain(document.domain,k))h.domain=k}if($undefinedOrNull(h.domain)&&i!=null&&i.length>0)for(var j=0;j<i.length;j++){var k="."+i[j];document.location.href.replace(/https?:\/\//,"").indexOf(i[j])==0&&(h.domain=k)}$undefinedOrNull(h.domain)&&(h.domain="."+document.domain),viDataMap={};if(d==b.SN_VI_STORE_NAME){viData=e.split(b.KEY_SEPERATOR);for(j=0;j<viData.length;j++)keyValue=viData[j].split(b.KEY_VALUE_SEPERATOR),keyName=keyValue[0],e=keyValue[1],keyName=="vi"&&parent.SN.Conf.viStore=="localstorage"?g.setValueInStore(b.SN_VI_STORE_NAME,keyName,e):viDataMap[keyName]=e;e=null;for(viDataKey in viDataMap)$undefinedOrNull(e)?e=viDataKey+b.KEY_VALUE_SEPERATOR+viDataMap[viDataKey]+b.KEY_SEPERATOR:e=e+viDataKey+b.KEY_VALUE_SEPERATOR+viDataMap[viDataKey]+b.KEY_SEPERATOR;e.length>1&&(e=e.substring(0,e.length-1)),o(d,e,h)}else o(d,e,h)}}function n(){h("Reading DROPPED_COOKIES from conf"),parent.SN.Conf.viStore=="localstorage"&&(g=new SN.LocalStorageWrapper)}function o(b,c,d,e){if(parent.SN.Conf.dataStore=="server"&&b!="sn.vi"&&$undefinedOrNull(e)){a.warnTrack("CreateCookieAPICalled",{cookieName:b,cookieValue:c});return}$undefinedOrNull(d)&&(d={});var f=[];c=w(c),f.push(a.augmentKeyValuePair(b,c));if(!$undefinedOrNull(d.time)){var g=new Date;g.setTime(g.getTime()+d.time),f.push(a.augmentKeyValuePair("expires",e?"Thu, 01 Jan 1970 00:00:01 GMT":g.toGMTString()))}$undefinedOrNull(d.path)&&(d.path="/"),f.push(a.augmentKeyValuePair("path",d.path));if($undefinedOrNull(d.domain)){var h=A();if(h!=null&&h.length>0)for(var i=0;i<h.length;i++){var j="."+h[i];if(document.domain==h[i]||a.isSubDomain(document.domain,j))d.domain=j}if($undefinedOrNull(d.domain)&&h!=null&&h.length>0)for(var i=0;i<h.length;i++){var j="."+h[i];document.location.href.replace(/https?:\/\//,"").indexOf(h[i])==0&&(d.domain=j)}$undefinedOrNull(d.domain)&&(d.domain="."+document.domain)}f.push(a.augmentKeyValuePair("domain",d.domain)),document.cookie=f.join("; ")}function p(a){var b=a+"=",c=document.cookie.split(";");for(var d=0;d<c.length;d++){var e=c[d];while(e.charAt(0)==" ")e=e.substring(1,e.length);if(e.indexOf(b)==0)return e.substring(b.length,e.length)}return null}function q(a){var b={};b.time=-864e5,b.path="/",eraseFlag=!0,o(a,"",b,eraseFlag)}function r(a,c){var d=unescape(p(a));if(c==null)return d;if(d==null)return null;var e=d.split(b.KEY_SEPERATOR),f=c+b.KEY_VALUE_SEPERATOR;for(var g=0;g<e.length;g++){var h=e[g];if(h.indexOf(f)==0){var i=h.substring(f.length,h.length);return i}}return null}function s(a,c,d){var e=p(a);if($undefinedOrNull(e)||e.indexOf(c)==-1)return;var f=e.split(b.KEY_SEPERATOR),g=0,h="";for(g=0;g<f.length;g++){var i;i=f[g].split(b.KEY_VALUE_SEPERATOR)[0],i!=c&&(h+=f[g],g!=f.length-1&&(h+=b.KEY_SEPERATOR))}h.charAt(h.length-1)==b.KEY_SEPERATOR&&(h=h.substring(0,h.length-1));var j={};$undefinedOrNull(d)||(j.time=d),o(a,h,j)}function t(c,d,e){var f="",g="",h=!1,i=!0,j=p(c);j==null&&(j="");var k=j.split(b.KEY_SEPERATOR),l=d+b.KEY_VALUE_SEPERATOR;for(var m=0;m<k.length;m++){var n=k[m];if(n=="")continue;n.indexOf(l)==0?h=!0:h?g=g+b.KEY_SEPERATOR+n:i?(f=n,i=!1):f=f+b.KEY_SEPERATOR+n}var q="";if(typeof e=="string"){var r=e.split(b.KEY_SEPERATOR).join("").split(b.KEY_VALUE_SEPERATOR).join("");r!=e&&SN.Utils.warnTrack("Cookie Key-Value Separtor found inside the value. Removed.",{oldValue:e}),e=r}e==null?q=f+g:f==""?q=l+e+g:q=f+b.KEY_SEPERATOR+l+e+g;var s={};if(c==parent.SN.Conf.viStoreName&&parent.SN.Conf.isViStoreSession==1)s.time=null;else{var t=a.getStoreLifetime(c);$undefinedOrNull(t)&&(t=b.DEFAULT_STORE_LIFETIME_MAP[c]),$undefinedOrNull(t)||(s.time=t)}o(c,q,s)}function u(a,b){if($undefinedOrNull(r(a,b)))return;t(a,b)}function v(a){return document.cookie.indexOf(a)>-1?(q(a),1):0}function w(b){if(typeof b!="string")return b;var c=b,e=d.length;for(var f=0;f<e;++f)c=c.split(d[f]).join("");return c!=b&&a.errorTrack("InvalidCharatersInCookie: was "+encodeURIComponent(b)+", changed to "+encodeURIComponent(c)+".",{}),c}function x(a){if(z())return!0;if($undefinedOrNull(parent.SN.Conf.DISABLED_COOKIES))return!1;if(undefined!=parent.SN.Conf.DISABLED_COOKIES.indexOf)return parent.SN.Conf.DISABLED_COOKIES.indexOf(a)>-1;for(var b=0;b<parent.SN.Conf.DISABLED_COOKIES.length;b++)if(parent.SN.Conf.DISABLED_COOKIES[b]==a)return!0;return!1}function y(a){e=a}function z(){return e}function A(){return SN.Conf.COOKIEPATH}function B(a,b){if($undefinedOrNull(b))return p(a);var c=null;try{c=r(a,b)}catch(d){return console&&console.log&&console.log("Error in getting value from store using cookieStore as dataStore : "+d),c}return c}function C(a,c,d){d=D(a,c,d),a==b.SN_VARIABLE_STORE_NAME&&typeof d!="string"&&(d=JSON.stringify(d));if(parent.SN.Conf.viStore!="localstorage"||a!=b.SN_VI_STORE_NAME||c!=b.VISITOR_ID)return t(a,c,d),d;g.setValueInStore(a,c,d)}function D(c,d,e){if(x(c))return null;if(c==b.SN_VARIABLE_STORE_NAME&&e.length>f){a.infoTrack("TooLongFsmValue",{key:e});try{e=SN.CustomScript.getEncodedValue(e)}catch(g){a.errorTrack("errorInEncodingFSM for FSM "+e,g)}e.length>f&&(a.errorTrack('StillTooLongFSMValue: Map not available. Trimmed to "'+e.slice(0,f)+'"',{key:e}),e=e.slice(0,f))}return e}function E(a,b){$undefinedOrNull(b)&&q(a),u(a,b)}function F(a,c){return r(b.SN_VARIABLE_STORE_NAME,a)}function G(a,c){t(b.SN_VARIABLE_STORE_NAME,a,c)}var a=SN.Utils,b=SN.Constants,c=!1,d=parent.SN.Conf.INVALID_COOKIE_CHARACTERS,e=!1,f=40,g=null,H={init:n,onBootstrapUpdateCompleted:j,onFsmVariablesUpdate:k,getValueFromStore:B,setValueInStore:C,deleteValueFromStore:E,setCrossDomainData:m,readCookie:p,createCookie:o,eraseCookie:q,readSNCookie:r,createSNCookie:t,eraseSNCookie:u,getDataFromVC:F,updateDataInVC:G};return H},SN=SN||{},SN.LocalStorageWrapper=function(){function k(){var c=(new Date).getTime();b[a.SN_RN_STORE_NAME]=c,b[a.SN_AS_STORE_NAME]=c,b[a.SN_VI_STORE_NAME]=c,b[a.SN_WEBTRACKER_STORE_NAME]=c,b[a.SN_VARIABLE_STORE_NAME]=c,b[a.SN_EXIT_HISTORY_STORE_NAME]=c,e.observe(a.CONST_PERIODICAL_EXECUTION_TIMER_EVENT,m),parent.SN.Conf.viStore=="cookie"&&(j=new SN.CookieManager)}function l(e){for(var f in e){var g=e[f].cvalue;f!=c&&(b[f]=(new Date).getTime()),viDataMap={};if(f==a.SN_VI_STORE_NAME){viData=g.split(a.KEY_SEPERATOR);for(i=0;i<viData.length;i++)keyValue=viData[i].split(a.KEY_VALUE_SEPERATOR),keyName=keyValue[0],g=keyValue[1],keyName=="vi"&&parent.SN.Conf.viStore=="cookie"?j.setValueInStore(a.SN_VI_STORE_NAME,keyName,g):viDataMap[keyName]=g;g=null;for(viDataKey in viDataMap)$undefinedOrNull(g)?g=viDataKey+a.KEY_VALUE_SEPERATOR+viDataMap[viDataKey]+a.KEY_SEPERATOR:g=g+viDataKey+a.KEY_VALUE_SEPERATOR+viDataMap[viDataKey]+a.KEY_SEPERATOR;g.length>1&&(g=g.substring(0,g.length-1)),d.getStore(f).set(f,g)}else d.getStore(f).set(f,g)}}function m(){var c=!1;for(var e in b){var f=h.getStoreLifetime(e),g=b[e],i=g+f<(new Date).getTime();i&&(d.getStore(e).remove(e),e==a.SN_VI_STORE_NAME&&(c=!0))}if(c)for(var e in b)d.getStore(e).remove(e)}function n(b,c){var e=d.getStore(b).get(b);if($undefinedOrNull(e))return null;var f=e.split(a.KEY_SEPERATOR),g=c+a.KEY_VALUE_SEPERATOR;for(var h=0;h<f.length;h++){var i=f[h];if(i.indexOf(g)==0){var j=i.substring(g.length,i.length);return j}}return null}function o(c,e,f){var g="",h="",i=!1,j=!0,k=d.getStore(c).get(c);k==null&&(k="");var l=k.split(a.KEY_SEPERATOR),m=e+a.KEY_VALUE_SEPERATOR;for(var n=0;n<l.length;n++){var o=l[n];if(o=="")continue;o.indexOf(m)==0?i=!0:i?h=h+a.KEY_SEPERATOR+o:j?(g=o,j=!1):g=g+a.KEY_SEPERATOR+o}var p="";if(typeof f=="string"){var q=f.split(a.KEY_SEPERATOR).join("").split(a.KEY_VALUE_SEPERATOR).join("");q!=f&&SN.Utils.warnTrack("Data Key-Value Separtor found inside the value. Removed.",{oldValue:f}),f=q}f==null?p=g+h:g==""?p=m+f+h:p=g+a.KEY_SEPERATOR+m+f+h,d.getStore(c).set(c,p),b[c]=(new Date).getTime()}function p(c,e){var f=n(c);if($undefinedOrNull(f)||f.indexOf(e)==-1)return;var g=f.split(a.KEY_SEPERATOR),h=0,i="";for(h=0;h<g.length;h++){var j;j=g[h].split(a.KEY_VALUE_SEPERATOR)[0],j!=e&&(i+=g[h],h!=g.length-1&&(i+=a.KEY_SEPERATOR))}i.charAt(i.length-1)==a.KEY_SEPERATOR&&(i=i.substring(0,i.length-1)),d.getStore(c).remove(c),d.getStore(c).set(c,i),b[c]=(new Date).getTime()}function q(a){d.getStore(a).remove(a)}function r(){var c={},e={};for(var f in b)e.cvalue=d.getStore(f).get(f),f=="sn.vi"&&parent.SN.Conf.dataStore=="localstorage"&&parent.SN.Conf.viStore=="cookie"&&e["cvalue"].indexOf(a.VISITOR_ID+a.KEY_VALUE_SEPERATOR)==-1&&(e.cvalue=e.cvalue+a.KEY_SEPERATOR+a.VISITOR_ID+a.KEY_VALUE_SEPERATOR+j.getValueFromStore(f,a.VISITOR_ID)),e.clifetime=h.getStoreLifetime(f),c[f]=e,e={};return c}function s(){var b={},c={};return c.cvalue=n(a.SN_VARIABLE_STORE_NAME),c.clifetime=h.getStoreLifetime(a.SN_VARIABLE_STORE_NAME),b[a.SN_VARIABLE_STORE_NAME]=c,$undefinedOrNull(c.cvalue)?null:b}function t(b,c){return b!=a.SN_VI_STORE_NAME||c!=a.VISITOR_ID&&c!=a.DC_CODE&&c!=a.VI_BUCKET_CUSTOM_DATA_KEY||parent.SN.Conf.viStore!="cookie"?n(b,c):j.getValueFromStore(b,c)}function u(b,c,d){return b!=a.SN_VI_STORE_NAME||c!=a.VISITOR_ID&&c!=a.DC_CODE&&c!=a.VI_BUCKET_CUSTOM_DATA_KEY?o(b,c,d):parent.SN.Conf.viStore=="cookie"?j.setValueInStore(b,c,d):o(b,c,d),d}function v(a,b){p(a,b)}function w(b,c){u(a.SN_VARIABLE_STORE_NAME,b,c)}var a=SN.Constants,b={},c=null,d=SN.Store,e=SN.EventManager,f=!0,g=3e4,h=SN.Utils,j=null,x={setCrossDomainData:l,write:o,read:n,onBootstrapUpdateCompleted:r,onFsmVariablesUpdate:s,getValueFromStore:t,setValueInStore:u,deleteValueFromStore:v,updateDataInVC:w};return k(),x},typeof SN=="undefined"&&(SN={}),SN.CrossXHR=function(){function r(a){var b=JSON.parse(a),c=b.err_no,e=b.err,f=b.rid,g=b.response;if(!$undefinedOrNull(c)&&c>0)d.info("Error code received - "+f,e);else{while(g.indexOf("+")!=-1)g=g.replace("+"," ");var h=decodeURIComponent(g),i=p[f];if(!$undefinedOrNull(i))try{i(h)}catch(e){d.warn("unable to execute the jsonp response , actualResponse : "+h,e)}else d.info("JSONP callback function is undefined or null for reqId "+f)}var j=f,k=document.getElementById(j),l=document.getElementsByTagName("head").item(0);k&&window.setTimeout(function(){try{l.removeChild(k)}catch(a){d.error("Could not remove JSONP script - "+j,a)}},2e3),delete p[f]}function t(){var a=c.length;for(var b=0;b<a;b++){var d=c[b],e=s[d];if(e.test()){i=e,j=d;break}}if(i==null)throw"No crossdomain channel could be obtained for your browser. Upgrade yours to FF2+/IE8+/Flash";i.init()}function u(){return typeof i==a||i==null?!1:i.isReady()}function v(a,b,c,d){i.isReady()?i.write(a,b,c,d):(i=s.getScript,w(a,b))}function w(a,b){var c=null;$undefinedOrNull(b)&&(b={}),o==null&&(o=s.getScript,o.init()),o.write(a,b,c)}function x(a,b,c,d){if($undefinedOrNull(a))throw"url passed into JSONP request is undefinedOrNull";if($undefinedOrNull(c))throw"callback passed into JSONP request is undefinedOrNull";if($undefinedOrNull(d))throw"httpmethod passed into JSONP request is undefinedOrNull";if(d.toUpperCase()!="G"&&d.toUpperCase()!="P")throw"httpmethod : "+d+" passed into JSONP request is not valid. It should be 'p' for post call and 'g' for get call";$undefinedOrNull(b)&&(b={}),n==null&&(n=s.JSONP,n.init()),b[h]=d,n.write(a,b,c)}function y(){return j}var a="undefined",b="sn-pspxd-iframe",c=["iframe","getScript"],d=SN.Utils,e=d.getProxyServer(),f="s",g="cb",h="m",i=null,j=null,k=0,l="postMessage",m=SN.ConfigurationManager,n=null,o=null,p={},q=0,s={iframe:{test:function(){return window[l]?!0:!1},isReady:function(){return m.isXDChannelReady()},init:function(){},write:function(a,c,e,f){c.responseType="application/json",SN.XDFrameMessagingUtils.receiveMessage(function(a){e(a)},d.getPSPServerUrl());var g=document.getElementById(b);if($undefinedOrNull(g))return;var h={};$undefinedOrNull(f)?h.cmd="serverCall":h.cmd=f,h.params=c,SN.XDFrameMessagingUtils.postMessage(JSON.stringify(h),d.getPSPServerUrl(),g.contentWindow)}},getScript:{test:function(){return!0},isReady:function(){return this.ready==1},init:function(){this.ready=!0},write:function(a,b,c){b.responseType="text/javascript";var e="id"+k++;b.sId=e;var f=document.getElementsByTagName("head").item(0),g=d.appendUrlParams(a,b);if(navigator.userAgent.indexOf("MSIE 7")!=-1&&g.length>2048){d.errorTrack("getScriptUrlSizeexceeded2083OnIE7");return}if(navigator.userAgent.indexOf("MSIE 7")==-1&&g.length>4e3){d.errorTrack("getScriptUrlSizeexceeded4k");return}var h=document.createElement("script");h.src=g,h.type="text/javascript",h.id=e,h.async=!0,void f.appendChild(h)}},JSONP:{test:function(){return!0},isReady:function(){return this.ready==1},init:function(){this.ready=!0},write:function(a,b,c){b=b||{};var i=location.protocol=="https:"?"https://":a.indexOf("https")!=-1?"https://":"http://",j=i+e;b[f]=a,b[g]="SN.CrossXHR.handleJSONPResponse";var k=b[h];$undefinedOrNull(k)&&(b[h]="G");var l="jid"+q++;b.rid=l,p[l]=c;var m=document.getElementsByTagName("head").item(0),n=d.appendUrlParams(j,b),o=document.createElement("script");o.src=n,o.type="text/javascript",o.id=l,o.async=!0,void m.appendChild(o)}}},z={isReady:u,makeXDRequest:v,makeJSONPRequest:x,makeGetRequest:w,handleJSONPResponse:r,getType:y,reinit:t};return t(),z}(),typeof SN=="undefined"&&(SN={}),SN.ServerStorageManager=function(){function p(b,c){if(b==d.SN_VI_STORE_NAME){if(c==d.VISITOR_ID)return i.getValueFromStore(j,c);if(c==d.DC_CODE){if(k==1)return i.getValueFromStore(j,c);var e=a[b];if(!$undefinedOrNull(e))return e[c]}if(c==d.VI_BUCKET_CUSTOM_DATA_KEY)return i.getValueFromStore(d.SN_VI_STORE_NAME,d.VI_BUCKET_CUSTOM_DATA_KEY);if(c==d.CONST_INVITATION_OFERED_TIME_STAMP)return!$undefinedOrNull(a[b])&&!$undefinedOrNull(a[b][c])?a[b][c]:null}if($undefinedOrNull(c))return $undefinedOrNull(a[b])?null:a[b];var e=a[b];if(!$undefinedOrNull(e)){var f=e[c];return!$undefinedOrNull(f)&&b==d.SN_VARIABLE_STORE_NAME&&(f=JSON.parse(f)),f}}function q(b,c,e){if(b!=d.SN_VI_STORE_NAME||c!=d.VISITOR_ID&&c!=d.VI_BUCKET_CUSTOM_DATA_KEY||k!=1){$undefinedOrNull(a[b])&&(a[b]={});if($undefinedOrNull(c))a[b]=e;else if(b==d.SN_VARIABLE_STORE_NAME){var f=JSON.stringify(e);a[b][c]=f}else a[b][c]=e;return e}return i.setValueInStore(j,c,e),g.isCrossDomainSupported()&&m.isXDChannelReady()&&c==d.VI_BUCKET_CUSTOM_DATA_KEY&&(updateparams={},cookievalue={},cookievalue.cvalue=i.getValueFromStore(d.SN_VI_STORE_NAME,d.VISITOR_ID),cookievalue.clifetime=g.getStoreLifetime(d.SN_VI_STORE_NAME),updateparams[d.SN_VI_STORE_NAME]=cookievalue,n.sendXDData(updateparams)),e}function r(b,c){$undefinedOrNull(c)&&(a[b]={}),b==d.SN_VI_STORE_NAME&&(c==d.VISITOR_ID||c==d.DC_CODE)&&k==1&&i.eraseValueFromStore(j,c),!$undefinedOrNull(a[b])&&!$undefinedOrNull(a[b][c])&&(a[b][c]="")}function s(){e="https://"+parent.SN.Conf.CONST_PSP_ROOT+"/psp/"+parent.SN.Conf.CONST_PSP_KEY+"/"+parent.SN.Conf.CONST_PSP_VERSION+d.SEND_SERVER_DATA_CALL,f="https://"+parent.SN.Conf.CONST_PSP_ROOT+"/psp/"+parent.SN.Conf.CONST_PSP_KEY+"/"+parent.SN.Conf.CONST_PSP_VERSION+d.GET_SERVER_DATA_CALL,parent.SN.Conf.viStore=="cookie"?i=new SN.CookieManager:i=new SN.LocalStorageWrapper,z(),SN.EventManager.observe(d.UPDATE_SN_AS_EVENT,v)}function t(){var a={},b={};if(k==0)return null;var c=p(d.SN_VI_STORE_NAME,d.VISITOR_ID);return b.cvalue=d.VISITOR_ID+d.KEY_VALUE_SEPERATOR+c,b.clifetime=g.getStoreLifetime(d.SN_VI_STORE_NAME),a[d.SN_VI_STORE_NAME]=b,a}function u(){var c=null,f=a[d.SN_VARIABLE_STORE_NAME];for(var i in f){var j=f[i];if($undefinedOrNull(b))$undefinedOrNull(c)&&(c={}),c[i]=j;else{var k=b[i];k!=j&&($undefinedOrNull(c)&&(c={}),c[i]=j)}}if(!$undefinedOrNull(c)){g.info("Sending new FSMVariables to server"),params={},params[d.BUCKET_KEY]=d.SN_VARIABLE_STORE_NAME,params[d.BUCKET_VALUE]=JSON.stringify(f),params[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),params[d.CLIENT_KEY]=g.getClientKey(),h.makeXDRequest(e,params,function(){},d.SEND_SERVER_DATA);for(var l in f)b[l]=f[l];return null}return g.info("No new updates on FSMVariables to be sent to server"),null}function v(){g.info("Sending new SN.AS data to server"),params={},params[d.BUCKET_KEY]=d.SN_AS_STORE_NAME,params[d.BUCKET_VALUE]=JSON.stringify(p(d.SN_AS_STORE_NAME)),params[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),params[d.CLIENT_KEY]=g.getClientKey(),h.makeXDRequest(e,params,function(){},d.SEND_SERVER_DATA)}function w(c){if(!$undefinedOrNull(c)){for(key in c)value=c[key],a[key]=value;tempVc=a[d.SN_VARIABLE_STORE_NAME];if(!$undefinedOrNull(tempVc))for(vcKey in tempVc)b[vcKey]=tempVc[vcKey];$undefinedOrNull(b)&&(b={});for(tempKey in b)a[d.SN_VARIABLE_STORE_NAME][tempKey]=b[tempKey]}}function x(b){if(k==0)return;dataMap={},cookieManager=new SN.CookieManager;for(var c in b){params={};if(c==d.SN_VI_STORE_NAME){var e=b[c].cvalue;if(e==""||$undefinedOrNull(e)||e==undefined)continue;dataMap[c]=e,viData=e.split(d.KEY_SEPERATOR)[0].split(d.KEY_VALUE_SEPERATOR),i.setValueInStore(c,viData[0],viData[1]),e.split(d.KEY_SEPERATOR).length>1&&(customData=e.split(d.KEY_SEPERATOR)[1].split(d.KEY_VALUE_SEPERATOR),i.setValueInStore(c,customData[0],customData[1])),SN.Conf.viStore==d.LOCAL_STORE&&cookieManager.deleteValueFromStore(c)}}for(var c in b)$undefinedOrNull(b[c].cvalue)||(a[c]=A(b[c].cvalue))}function y(){cookieManager=new SN.CookieManager,cookies=[d.SN_AS_STORE_NAME,d.SN_RN_STORE_NAME,d.SN_EXIT_HISTORY_STORE_NAME,d.SN_VARIABLE_STORE_NAME,d.SN_WEBTRACKER_STORE_NAME];var b=0;c={};for(;b<cookies.length;b+=1)$undefinedOrNull(a[cookies[b]])&&(dataMapString=cookieManager.readCookie(cookies[b]),$undefinedOrNull(dataMapString)||(dataMap=A(dataMapString),cookies[b]==d.SN_VARIABLE_STORE_NAME?a[cookies[b]]=JSON.stringify(dataMap):a[cookies[b]]=dataMap));var c={};for(key in a)c[d.BUCKET_KEY]=key,c[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),c[d.BUCKET_VALUE]=JSON.stringify(a[key]),c[d.CLIENT_KEY]=g.getClientKey(),key!=d.SN_WEBTRACKER_STORE_NAME&&h.makeXDRequest(e,c,function(){},d.SEND_SERVER_DATA);b=0;for(;b<cookies.length;b+=1)cookieManager.deleteValueFromStore(cookies[b])}function z(){var a=new SN.CookieManager;cookies=[d.SN_AS_STORE_NAME,d.SN_RN_STORE_NAME,d.SN_EXIT_HISTORY_STORE_NAME,d.SN_VARIABLE_STORE_NAME,d.SN_WEBTRACKER_STORE_NAME],index=0;for(;index<cookies.length;index+=1)cookies[index]!=d.SN_VI_STORE_NAME&&(a.deleteValueFromStore(cookies[index]),a.eraseCookie(cookies[index]));parent.SN.Conf.viStore!="cookie"&&a.deleteValueFromStore(d.SN_VI_STORE_NAME)}function A(a){dataArray=a.split(d.KEY_SEPERATOR),dataMap={};for(index=0;index<dataArray.length;index++)dataElement=dataArray[index],data=dataElement.split(d.KEY_VALUE_SEPERATOR),dataMap[data[0]]=data[1];return dataMap}function B(a,b){params={},params[d.BUCKET_KEY]=a,params[d.BUCKET_VALUE]=b,params[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),params[d.CLIENT_KEY]=g.getClientKey(),h.makeXDRequest(e,params,function(){},d.SEND_SERVER_DATA)}function C(a){var b=(new Date).getTime();l[b]=a,params={},params[d.BUCKET_KEY]="custom_",params.reqId=b,params[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),params[d.CLIENT_KEY]=g.getClientKey(),h.makeGetRequest(f+"?",params,a,d.SEND_SERVER_DATA)}function D(a,b){callback=l[b],callback(a),delete l[b]}function E(){changedparams={},changedparams[d.BUCKET_KEY]=d.SN_VI_STORE_NAME,changedparams[d.BUCKET_VALUE]=JSON.stringify(a[d.SN_VI_STORE_NAME]),changedparams[d.VISITOR_ID]=p(d.SN_VI_STORE_NAME,d.VISITOR_ID),changedparams[d.CLIENT_KEY]=g.getClientKey(),h.makeXDRequest(e,changedparams,function(){},d.SEND_SERVER_DATA)}function F(a,b){q(d.SN_VARIABLE_STORE_NAME,a,b)}var a={},b={},c={},d=SN.Constants,e=null,f=null,g=SN.Utils,h=SN.CrossXHR,i=null,j=parent.SN.Conf.viStoreName,k=parent.SN.Conf.shouldMaintainVi,l={},m=SN.ConfigurationManager,n=SN.CrossXDataHandler,o=SN.Eventmanager,G={onFsmVariablesUpdate:u,onBootstrapUpdateCompleted:t,initialize:s,deleteValueFromStore:r,getValueFromStore:p,setValueInStore:q,saveBootstrapData:w,setCrossDomainData:x,setCustomData:B,getDataFromServer:C,onGetDataFromServer:D,sendToServerAndCleanCookieStorage:y,setItValueInServer:E,updateDataInVC:F};return s(),G},typeof SN=="undefined"&&(SN={}),SN.StoreManager=function(){function l(){k=parent.SN.Conf.dataStore,f=e.getAvailableStore(),k==c?g=new SN.ServerStorageManager:k==b||f==b?(g=new SN.CookieManager,g.init()):k==d?g=new SN.LocalStorageWrapper:e.error("No Suitable storage could be obtained !"),h.observe(a.BOOTSTRAP_UPDATE_COMPLETED_EVENT,r),h.observe(a.UPDATE_FSMVARIABLES_EVENT,s)}function m(a,b){return g.getValueFromStore(a,b)}function n(a,b,c){return g.setValueInStore(a,b,c)}function o(a,b){g.deleteValueFromStore(a,b)}function p(){var b=g.getValueFromStore(a.SN_AS_STORE_NAME,"a");return b==a.TRUE?!0:!1}function q(a){g.setCrossDomainData(a)}function r(){if(!e.isCrossDomainSupported()||!j.isXDChannelReady())return;var a=g.onBootstrapUpdateCompleted();i.sendXDData(a)}function s(){var a=g.onFsmVariablesUpdate();if(!e.isCrossDomainSupported()||!j.isXDChannelReady())return;null!=a&&i.sendXDData(a)}function t(){g.setValueInStore(a.SN_AS_STORE_NAME,"a",a.TRUE)}function u(a){if(k==c){var b=a.serverData;$undefinedOrNull(b)?e.errorTrack("No Data sent from server on bs response"):g.saveBootstrapData(b)}}function v(a){k!=c&&e.errorTrack("server side storage is not enabled"),g.getDataFromServer(a)}function w(a,b){g.onGetDataFromServer(a,b)}function x(a,b){if(a.indexOf("custom")==-1){SN.Utils.error("custom data should start with custom_ keyword");return}g.setCustomData(a,b)}function y(){g.sendToServerAndCleanCookieStorage()}function z(){return g.getValueFromStore(a.SN_VI_STORE_NAME,a.VI_BUCKET_CUSTOM_DATA_KEY)}function A(b){if(typeof b!="string"){e.warn("Set request for vi bucket with custom data is allowed for two length string only");return}var c=0;if($undefinedOrNull(b)){e.warn("Set request for vi bucket with custom data thats undefined or null, ignoring the request");return}for(var d in b)b.hasOwnProperty(d)&&c++;if(c>parent.SN.Conf.customDataSizeInViStore){e.warn("Set request for vi bucket with custom data > 2 byte size, ignoring the request");return}return g.setValueInStore(a.SN_VI_STORE_NAME,a.VI_BUCKET_CUSTOM_DATA_KEY,b)}function B(){g.setItValueInServer()}function C(b,c){if(!$undefinedOrNull(b)||!$undefinedOrNull(c))g.updateDataInVC(b,c),h.fire(a.UPDATE_FSMVARIABLES_EVENT,{eventId:a.UPDATE_FSMVARIABLES_EVENT})}var a=SN.Constants,b="cookie",c="server",d="localstorage",e=SN.Utils,f=null,g=null,h=SN.EventManager,i=SN.CrossXDataHandler,j=SN.ConfigurationManager,k=c,D={isActiveSessionPresent:p,setCrossDomainData:q,createASStore:t,getValueFromStore:m,setValueInStore:n,deleteValueFromStore:o,saveBootstrapData:u,getDataFromServer:v,onGetDataFromServer:w,setCustomData:x,sendToServerAndCleanCookieStorage:y,getCustomDataFromViStore:z,setCustomDataInViStore:A,setItValueInServer:B,updateDataInVC:C};return l(),D}(),typeof SN=="undefined"&&(SN={}),SN.ExitHistory=function(){function j(a){if($undefinedOrNull(a)||a.length==0)return;d=a;for(var b=0;b<a.length;b++)!$undefinedOrNull(d[b])&&!$undefinedOrNull(d[b].href)&&l(a[b])}function k(){$undefinedOrNull(f)?SN.Utils.info("encodedUrl is undefined"):(clearInterval(g),SN.Utils.info("encodedUrl is defined"),m(f))}function l(a){Event.observe(a,"click",function(b){f=a.hostname,h=b.ctrlKey,g=setInterval(function(){k()},1)})}function m(a){var c;a=a.substring(0,20),e=SN.CustomScript.getEncodedValue(a),!$undefinedOrNull(h)&&h?c=b.NEWTAB_EXIT_LINK:c=b.EXIT_LINK,i.setValueInStore(b.SN_EXIT_HISTORY_STORE_NAME,c,e),clearInterval(g),n(e)}function n(a){var d=SN.Conf.getDecodedValue(a);!$undefinedOrNull(h)&&h&&d&&c.fire("exitLinkEvent",{eventId:b.EXIT_LINK_EVENT,data:{ed:{ntel:d}}})}function o(){var a=i.getValueFromStore(b.SN_EXIT_HISTORY_STORE_NAME);return SN.Conf.getDecodedValue(a)}var a=SN.Utils,b=SN.Constants,c=SN.EventManager,d,e=null,f=null,g=null,h=!1,i=SN.StoreManager,p={registerElementsForExitLinkCapturing:j,getLastExitLink:o};return p}(),SN.PSPCustomTrackingUtil=function(){function setTrackingVariableMap(a){trackingVariableMap=a}function fireCustomEvent(a,b,c){if(c==null||c==undefined)c=SN_CONSTANTS.CUSTOM_EVENT_FIRED;eventManager.fire(SN_CONSTANTS.CUSTOM_EVENT,{eventId:c,data:{f:a,ed:b}})}function trackVariables(){var varMap=trackingVariableMap;if($undefinedOrNull(varMap))return;var extraData={},hasProperties=!1;for(var key in varMap)try{var value=eval("varMap[key]");$undefinedOrNull(value)||(extraData[key]=value,hasProperties=!0)}catch(e){utils.error("PS: error in getting value for: "+key)}hasProperties&&fireCustomEvent(null,extraData,trackVarMapEventCode)}function trackUrlChange(){var a=parent.document.location.href;try{if(a!=lastUrlHash){var b={newUrl:a,olderUrl:lastUrlHash};fireCustomEvent(null,b,urlChangeEventCode),lastUrlHash=a}}catch(c){utils.warn("Exception in SN.CustomScript.trackUrlChange : "+c)}}function startPoller(a,b,c,d){trackingVariableMapFlag=b,trackingUrlFlag=c,lastUrlHash=d,clearPoller(),customPollingInterval=a,SN.EventManager.observe(SN.Constants.BOOTSTRAP_COMPLETED_EVENT,startTracking)}function clearPoller(){null!=pollerFlag&&(clearInterval(pollerFlag),pollerFlag=null)}function startTracking(){clearPoller();var a=setInterval(function(){getTrackingUrlFlag()&&trackUrlChange(),getTrackingVariableMapFlag()&&trackVariables()},customPollingInterval)}function getTrackingUrlFlag(){return trackingUrlFlag}function getTrackingVariableMapFlag(){return trackingVariableMapFlag}var eventManager=SN.EventManager,SN_CONSTANTS=SN.Constants,utils=SN.Utils,trackingVariableMap={},customPollingInterval=null,trackingUrlFlag=!1,lastUrlHash=null,urlChangeEventCode=100009,trackVarMapEventCode=100011,pollerFlag=!1,me={fireCustomEvent:fireCustomEvent,startPoller:startPoller,setTrackingVariableMap:setTrackingVariableMap};return me}(),typeof SN=="undefined"&&(SN={}),SN.Social=function(){function a(){var a=parent,b=parent.document,c="social247-js",d=a.Shopalize||{},e,f;typeof SN.Conf.SOCIAL_BASE_URL=="undefined"?d.base_url=b.location.protocol+"//social.247-inc.com":d.base_url=SN.Conf.SOCIAL_BASE_URL;if(b.getElementById(c))return;e=b.createElement("script"),e.type="text/javascript",e.id=c,e.async=!0,e.src=d.base_url+"/js/all.js",f=b.getElementsByTagName("script")[0],f.parentNode.insertBefore(e,f)}return{load:a}}(),typeof SN=="undefined"&&(SN={}),typeof SN.WOWPx=="undefined"&&(SN.WOWPx={}),SN.WOWPx.JourneyStore=function(){function e(){a.getLocalStorageItem("jurls",f)}function f(a,e){var f;try{if(e&&typeof e=="string"&&e.isJSON()){f=e.evalJSON();if(f&&f instanceof Array&&f.length>0){while(f.length>=b-1)f.shift();for(var h=0;h<f.length;h++)f[h].order++;c=f}}d=c.length,g()}catch(i){}}function g(){if(d<0)return;var b={title:encodeURIComponent(parent.document.title),url:encodeURIComponent(parent.location.href),time:$timeOnPage(),order:1};c[d]=b,a.setLocalStorageItem("jurls",JSON.stringify(c),36e5)}function h(){var a=[];if(c.length<=0)return null;for(var b=0;b<c.length;b++)a.push({title:decodeURIComponent(c[b].title),url:decodeURIComponent(c[b].url),time:c[b].time,order:c[b].order});return a}function i(a){isNaN(a)||(b=a)}var a=SN.CrossXDataHandler,b=5,c=[],d=-1;return function(){SN.EventManager.observe(SN.Constants.BOOTSTRAP_COMPLETED_EVENT,e),SN.EventManager.observe(SN.Constants.CONST_PERIODICAL_EXECUTION_TIMER_EVENT,g)}(),{getJourney:h,setMaxUrls:i}}(),typeof SN=="undefined"&&(SN={}),SN.WOWPx.CustomCobrowse=function(){function e(){SN.XDFrameMessagingUtils.receiveMessage(function(a){var b="",c="";try{var d=a.data,e=d.split("&");for(var f=0;f<e.length;f++)e[f].indexOf("cmd")==0&&(b=e[f].replace("cmd=","")),e[f].indexOf("params")==0&&(c=e[f].replace("params=",""));b=="setCobrowseData"&&(c=JSON.parse(c),p())}catch(g){SN.Utils.error("Badly formed JSON, the request is not meant for this listener","error: ",g)}},null)}function f(b,c){if(b==="sn.cbr"&&!$undefinedOrNull(c)&&c!==""&&!$undefinedOrNull(c.event)&&c.state===CobrowseVendor.Events.COBROWSE_PARTICIPANT_JOINED){var d=c.event;a.continueSession(d.cookieData)}}function h(a){var b="visible",c="hidden",d={focus:b,focusin:b,pageshow:b,blur:c,focusout:c,pagehide:c},e="";a=a||window.event,a.type in d?e=d[a.type]:e=this[g]?"hidden":"visible",e=="visible"?(window.hasfocus=!0,p()):window.hasfocus=!1}function i(b,c){var d=100,e=100,g=0;typeof a.fireflyAPI.startAPI=="undefined"&&g<d?(g+=1,window.setTimeout(i,e)):typeof a.fireflyAPI.startAPI!="undefined"&&($undefinedOrNull(c)?SN.CrossXDataHandler.getLocalStorageItem("sn.cbr",function(a,b){var c=JSON.parse(b);f(a,c)}):f(b,c))}function j(b,c){SN.CrossXDataHandler.getLocalStorageItem("sn.cbr.session",function(b,c){if(!$undefinedOrNull(c)&&c!=""){var d=JSON.parse(c);a.continueSession(d.cookieData)}else SN.CrossXDataHandler.setLocalStorageItem("sn.cbr",JSON.stringify({origin:"MAIN",state:"ERROR",message:"session id not found"}),36e5,function(a){})})}function k(){$undefinedOrNull(a)&&(a=new CobrowseVendor.FireFlyAPI,l(a),a.addCobrowseTag("51b12e51e035634a60000697","https://cobrowse-bby.s3.amazonaws.com/scripts/loaders/loader.js",!0,!1,18e6,"production"))}function l(a){var c=null;a.registerCallbackHandler(CobrowseVendor.Events.COBROWSE_ENDED,function(){var a;typeof a=="undefined"&&(a={}),b=!1,a.origin="MAIN",a.state=CobrowseVendor.Events.COBROWSE_ENDED,a.eventTime=(new Date).getTime(),SN.CrossXDataHandler.setLocalStorageItem("sn.cbr",JSON.stringify(a),36e5,function(a){}),SN.CrossXDataHandler.setLocalStorageItem("sn.cbr.session","",36e5,function(a){}),CobrowseSatus.sessionStatus=CobrowseVendor.Events.COBROWSE_ENDED}),a.registerCallbackHandler(CobrowseVendor.Events.COBROWSE_INITIALIZED,function(a){c=a;var b;typeof b=="undefined"&&(b={}),b.origin="MAIN",b.state=CobrowseVendor.Events.COBROWSE_INITIALIZED,b.url=c,b.eventTime=(new Date).getTime()}),a.registerCallbackHandler(CobrowseVendor.Events.COBROWSE_STARTED,function(a){var d;typeof d=="undefined"&&(d={}),b=!0,d.origin="MAIN",d.state=CobrowseVendor.Events.COBROWSE_STARTED,d.url=c,d.event=a,d.eventTime=(new Date).getTime(),SN.CrossXDataHandler.setLocalStorageItem("sn.cbr.session",JSON.stringify(a),36e5,function(a){}),setTimeout(function(){SN.CrossXDataHandler.setLocalStorageItem("sn.cbr",JSON.stringify(d),36e5,function(a){})},200)}),a.registerCallbackHandler(CobrowseVendor.Events.COBROWSE_PARTICIPANT_JOINED,function(){var a;typeof a=="undefined"&&(a={}),a.origin="MAIN",a.state=CobrowseVendor.Events.COBROWSE_PARTICIPANT_JOINED,a.eventTime=(new Date).getTime(),SN.CrossXDataHandler.setLocalStorageItem("sn.cbr",JSON.stringify(a),36e5,function(a){})})}function m(b){$undefinedOrNull(a)&&!d?(a=new CobrowseVendor.CoBrowse247API,l(a),a.addCobrowseTag("51964e5268036b4d5400000c","https://cobrowse.app.global.247-inc.net/screenshare.js",!1,null,6e5,"staging"),d=!0):!$undefinedOrNull(a)||!d}function p(){SN.CrossXDataHandler.getLocalStorageItem("sn.cbr",function(b,c){var d=!$undefinedOrNull(c)&&c!=""?JSON.parse(c):null;if(d&&d.origin&&d.origin=="MAIN")return;$undefinedOrNull(d)||(d.state===CobrowseVendor.Events.COBROWSE_PARTICIPANT_JOINED||d.state===CobrowseVendor.Events.COBROWSE_STARTED?(m(),j(b,d)):d.state===CobrowseVendor.Events.COBROWSE_INITIALIZED||d.state==="START_SESSION"?(m(d.cobrowseArgs),r(d.cobrowseArgs)):d.state===CobrowseVendor.Events.COBROWSE_ENDED&&($undefinedOrNull(a)||a.endSession()))})}function q(){var b=100,c=100,d=0;typeof a.fireflyAPI.startAPI=="undefined"&&d<b?(d+=1,window.setTimeout(q,c)):typeof a.fireflyAPI.startAPI!="undefined"&&a.startSession({apiKey:"51b12e51ab8be54a60000001",cobrowseMode:"CO_BROWSE",fieldMaskingConfig:{"*":[".bby-creditCard-expirationYear",".bby-creditCard-number",".bby-creditCard-cid",".bby-creditCard-expirationMonth","input[name='TxtCardNumber']"]}})}function r(b){var c=b[0];a.startSession({apiKey:c,cobrowseMode:b[6],fieldMaskingConfig:{"*":[".bby-creditCard-expirationYear",".bby-creditCard-number",".bby-creditCard-cid",".bby-creditCard-expirationMonth","input[name='TxtCardNumber']"]}})}function s(){SN.CrossXDataHandler.setLocalStorageItem("sn.cbr","",36e5,function(a){})}var a=null,b=!1,c=!1,d=!1,g="hidden";window.hasfocus=!1,g in document?document.addEventListener("visibilitychange",h):(g="mozHidden")in document?document.addEventListener("mozvisibilitychange",h):(g="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",h):(g="msHidden")in document?document.addEventListener("msvisibilitychange",h):"onfocusin"in document?document.onfocusin=document.onfocusout=h:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=h;var n=!1,o=!1;return SN.EventManager.observe(SN.Constants.BOOTSTRAP_COMPLETED_EVENT,function(){window.setTimeout(function(){e(),p()},10)}),{clear:s}}();var CobrowseVendor={},CobrowseSatus={};CobrowseSatus.sessionStatus="NA",CobrowseVendor.Events={COBROWSE_INITIALIZED:"INITIALIZED",COBROWSE_STARTED:"STARTED",COBROWSE_PARTICIPANT_JOINED:"JOINED",COBROWSE_PARTICIPANT_LEFT:"LEFT",COBROWSE_ENDED:"ENDED",COBROWSE_ERROR:"ERROR"},CobrowseVendor.API=function(){},CobrowseVendor.API.prototype.getCobrowseVendorId=function(){},CobrowseVendor.API.prototype.addCobrowseTag=function(){},CobrowseVendor.API.prototype.startSession=function(a){},CobrowseVendor.API.prototype.endSession=function(){},CobrowseVendor.API.prototype.registerCallbackHandler=function(a,b){},CobrowseVendor.API.prototype.continueSession=function(a){},typeof window.fireflyAPI=="undefined"&&(window.fireflyAPI={}),typeof window.coBrowse247API=="undefined"&&(window.coBrowse247API={}),CobrowseVendor.FireFlyAPI=function(){CobrowseVendor.API.call(this),this.VENDOR_ID="FireFly",this.fireflyAPI=parent.window.fireflyAPI,this.eventListeners={}},CobrowseVendor.CoBrowse247API=function(){CobrowseVendor.API.call(this),this.VENDOR_ID="CoBrowse247API",this.coBrowse247API=window.coBrowse247API,this.eventListeners={}},CobrowseVendor.FireFlyAPI.prototype=new CobrowseVendor.API,CobrowseVendor.FireFlyAPI.prototype.constructor=CobrowseVendor.FireFlyAPI,CobrowseVendor.FireFlyAPI.prototype.getCobrowseVendorId=function(){return this.VENDOR_ID},CobrowseVendor.CoBrowse247API.prototype=new CobrowseVendor.API,CobrowseVendor.CoBrowse247API.prototype.constructor=CobrowseVendor.CoBrowse247API,CobrowseVendor.CoBrowse247API.prototype.getCobrowseVendorId=function(){return this.VENDOR_ID},CobrowseVendor.FireFlyAPI.prototype.addCobrowseTag=function(a,b,c,d,e,f){this.fireflyAPI.token=a,d!=null?this.fireflyAPI.noCookies=!d:this.fireflyAPI.noCookies=!0,e!=null&&(this.fireflyAPI.timeout=e),f&&f!=""&&(this.fireflyAPI.environment=f),this.fireflyAPI.partner="247",this.fireflyAPI.cacheSettings={enabled:!0,theme:"black",whitelabel:!0,message:"Waiting for your support representative.",initiation_type:"api",force:!0};var g=document.createElement("script");g.type="text/javascript",g.src=b,c!=null?g.async=c:g.async=!0;var h=document.getElementsByTagName("head")[0];h.appendChild(g)},CobrowseVendor.CoBrowse247API.prototype.addCobrowseTag=function(a,b,c,d,e,f){this.coBrowse247API.token=a,e||(e=6e5),this.coBrowse247API.sessionTimeout=e;var g=parent.document.createElement("script");g.type="text/javascript",g.src=b;var h=parent.document.getElementsByTagName("head")[0];h.appendChild(g)},CobrowseVendor.FireFlyAPI.prototype.startSession=function(a){apiObj=this,startSessionAsync(apiObj,a,10)},CobrowseVendor.CoBrowse247API.prototype.startSession=function(a){apiObject=this,start247SessionAsync(apiObject,a,15)},CobrowseVendor.FireFlyAPI.prototype.endSession=function(){typeof this.fireflyAPI.endSession=="function"&&this.fireflyAPI.endSession()},CobrowseVendor.CoBrowse247API.prototype.endSession=function(){parent.disconnect(),this.eventListeners[CobrowseVendor.Events.COBROWSE_ENDED]()},CobrowseVendor.FireFlyAPI.prototype.registerCallbackHandler=function(a,b){this.eventListeners[a]=b},CobrowseVendor.CoBrowse247API.prototype.registerCallbackHandler=function(a,b){this.eventListeners[a]=b},CobrowseVendor.FireFlyAPI.prototype.continueSession=function(a){fireflyAPIObj=this.fireflyAPI,continueSessionAsync(fireflyAPIObj,a,10)},CobrowseVendor.CoBrowse247API.prototype.continueSession=function(a){continue247SessionAsync(this,a,15)},CobrowseVendor.FireFlyAPI.prototype.participantLeft=function(){var a=this.eventListeners[CobrowseVendor.Events.COBROWSE_PARTICIPANT_LEFT];a()},CobrowseVendor.CoBrowse247API.prototype.participantLeft=function(){var a=this.eventListeners[CobrowseVendor.Events.COBROWSE_PARTICIPANT_LEFT];a()},typeof SN=="undefined"&&(SN={}),SN.CustomScript=function(){function customInitialization(){var a=window.documentDomain;a&&a!=document.domain&&(document.domain=a),parent.SNLoaderReady=!0,utils.setCrossDomainSupported(!0),utils.setPSPServerName(SN.Conf.CONST_PSP_ROOT),utils.setPSPCDNServerName(SN.Conf.CONST_PSP_CDN_ROOT),utils.setPSPVisitorPercentage(SN.Conf.CONST_PSP_VISITOR_PERCENTAGE),utils.setClientKey(SN.Conf.CONST_PSP_KEY),utils.setProxyServer(SN.Conf.PROXY_SERVER),utils.setCustomTrackServer(SN.Conf.CUSTOM_TRACK_SERVER),utils.setCustomTrackingLevel(LOGLVL_NONE),utils.setLogLevel(LOGLVL_NONE),utils.setPsdxdPath(SN.Conf.pspxdPath),webpageFilter.setFilterType(filterType),webpageFilter.setInfilters(includeFilterMap),webpageFilter.setOutfilters(excludeFilterMap),webpageFilter.setInfilterRegexList(includeFilterRegexList),webpageFilter.setOutfilterRegexList(excludeFilterRegexList),utils.isDomready()?setupExitHistory():SN.EventManager.observe(SN.Constants.DOMLOADED,setupExitHistory),SN.EventManager.fire(SN_CONSTANTS.CUSTOM_INITIALIZATION_COMPLETED,{eventId:SN_CONSTANTS.CUSTOM_INITIALIZATION_COMPLETED}),pspCustomTrackingUtil.setTrackingVariableMap(SN.Conf.varmap),pspCustomTrackingUtil.startPoller(SN.Conf.pollingTime,SN.Conf.varMapFlag,SN.Conf.trackingUrlFlag)}function initSocialwidget(){var a={order_number:"",order_date:"",customer_email:"",service_name:"",is_debug:!0},b={};b.store_id=parent.SN.Conf.SOCIAL_STORE_ID,b.service_details=a,b.base_orl=parent.SN.Conf.SOCIAL_BASE_URL,parent.social247AsyncInit=function(){parent.Shopalize.Loader.showSocialWidget("experience_sharing",b)}}function setupExitHistory(){var a=getElements();SN.ExitHistory.registerElementsForExitLinkCapturing(a)}function getElements(){var a=[];return a}function renderInitcall(a){var b={eventId:"initialize",data:{psproot:"https://"+SN.Conf.CONST_PSP_ROOT+"/psp",pspkey:"bestbuy-v1-001",v:"default",pageid:"getPageIdExpression()",trackid:"getWebTrackIdExpression()",ps_timeout_mins:"0",conversionTrackingIdIS:"1315115748",wowpxAppConfigs:{chatApp:{appConfigUrl:"https://"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_WIDGET_VERSION+"/chatApp/widget.html",appName:"chatApp",widgetConfigName:"chatAppConfigs",movable:"false",position:"FIXED"},tncApp:{appConfigUrl:"https://"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_WIDGET_VERSION+"/tncApp/widget.html",appName:"tncApp",widgetConfigName:"tncAppConfigs",movable:"false",position:"FIXED"}},widgetconfigs:{tncAppConfigs:{popupStyle:{height:"100%",left:"0px",top:"0px",width:"100%",zIndex:"21001",position:"absolute",overflow:"auto",visibility:"visible"},iframeStyle:{height:"500%",width:"100%",overflow:"auto"},loadingStyle:{width:"100%",height:"100%",margin:"0px auto",padding:"0px","textAlign ":"center",display:"block",position:"absolute",top:"50%",left:"50%",verticalAlign:"middle",backgroundRepeat:"no-repeat"}},chatAppConfigs:{popupStyle:{height:"100%",left:"0px",top:"0px",width:"100%",zIndex:"21001",position:"absolute",overflow:"hidden",visibility:"visible"},iframeStyle:{height:"100%",width:"100%",overflow:"hidden"},loadingStyle:{backgroundImage:"url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_WIDGET_VERSION+"/chatApp/images/loading.gif)",width:"100%",height:"100%",margin:"0px auto",padding:"0px","textAlign ":"center",display:"block",position:"absolute",top:"50%",left:"50%",marginLeft:"-83px",verticalAlign:"middle",backgroundRepeat:"no-repeat"}}},mappedrulevariables:[{key:"NOPV",scope:"r"},{key:"TOS_SHL",scope:"r"},{key:"caPCCount",scope:"r"},{key:"computedvariable1",scope:"r"},{key:"cv_nv_model",scope:"r"},{key:"cv_rv_model",scope:"r"},{key:"cv_wti_model",scope:"r"},{key:"getInviteCount",scope:"r"},{key:"getIsUserHL",scope:"r"},{key:"getScoreBitMap",scope:"r"},{key:"getTSLI",scope:"r"},{key:"isRepeatVisitor",scope:"r"},{key:"mv_NOPV",scope:"r"},{key:"mv_OS",scope:"r"},{key:"mv_browserName",scope:"r"},{key:"mv_caPCCount",scope:"r"},{key:"mv_checkoutPCOR",scope:"r"},{key:"mv_computerFlag",scope:"r"},{key:"mv_confusedFlag",scope:"r"},{key:"mv_dockCheckAvailability",scope:"r"},{key:"mv_getDockStatus",scope:"r"},{key:"mv_getInviteCount",scope:"r"},{key:"mv_getIsUserHL",scope:"r"},{key:"mv_getScoreBitMap",scope:"r"},{key:"mv_getTSLI",scope:"r"},{key:"mv_initRefCCQ",scope:"r"},{key:"mv_intStFlag",scope:"r"},{key:"mv_isCCQBtn",scope:"r"},{key:"mv_isMobileQueue",scope:"r"},{key:"mv_isRepeatVisitor",scope:"r"},{key:"mv_isSuppressCCQ",scope:"r"},{key:"mv_lastIntraxnPoller",scope:"r"},{key:"mv_lpCart",scope:"r"},{key:"mv_pageTitle",scope:"r"},{key:"mv_pageUrlLowerCase",scope:"r"},{key:"mv_tvFlag",scope:"r"},{key:"mv_videoFlag",scope:"r"},{key:"pageCategory",scope:"r"},{key:"wtiCount",scope:"r"},{key:"external_search_terms_Flag",scope:"r"},{key:"HOD",scope:"r"},{key:"Internal_Search_Terms_Flag",scope:"r"},{key:"computerFlag",scope:"r"},{key:"mv_applianceFlag",scope:"r"},{key:"mv_cameraFlag",scope:"r"},{key:"mv_carFlag",scope:"r"},{key:"mv_device",scope:"r"},{key:"mv_healthFlag",scope:"r"},{key:"mv_homeFlag",scope:"r"},{key:"mv_initialReferrer",scope:"r"},{key:"mv_mobileACCFlag",scope:"r"},{key:"mv_moviesFlag",scope:"r"},{key:"mv_musicFlag",scope:"r"},{key:"mv_officeFlag",scope:"r"},{key:"officeFlag",scope:"r"},{key:"mv_audioFlag",scope:"r"},{key:"applianceFlag",scope:"r"},{key:"cameraFlag",scope:"r"},{key:"carFlag",scope:"r"},{key:"audioFlag",scope:"r"},{key:"MobileACCFlag",scope:"r"},{key:"moviesFlag",scope:"r"},{key:"musicFlag",scope:"r"},{key:"mv_HOD",scope:"r"},{key:"mv_IntReffOfferTag",scope:"r"},{key:"operatingSystem",scope:"r"},{key:"geoCountry",scope:"r"},{key:"tvFlag",scope:"r"},{key:"videoFlag",scope:"r"},{key:"mv_initial_refferer",scope:"r"},{key:"device",scope:"r"},{key:"healthFlag",scope:"r"},{key:"homeFlag",scope:"r"},{key:"initialReferrer",scope:"r"},{key:"mv_extstFlag",scope:"r"},{key:"computedvariable6",scope:"r"},{key:"computedvariable9",scope:"r"},{key:"computedvariable10",scope:"r"},{key:"computedvariable11",scope:"r"},{key:"computedvariable12",scope:"r"},{key:"computedvariable13",scope:"r"},{key:"computedvariable14",scope:"r"},{key:"computedvariable15",scope:"r"},{key:"computedvariable16",scope:"r"},{key:"computedvariable17",scope:"r"},{key:"computedvariable18",scope:"r"},{key:"queueName",scope:"r"},{key:"mv_queueName",scope:"r"},{key:"suppressPQInvite",scope:"r"},{key:"mv_suppressPQInvite",scope:"r"},{key:"initRefIsYahooBing",scope:"r"},{key:"mv_initRefIsYahooBing",scope:"r"},{key:"initRefIsDeal",scope:"r"},{key:"mv_initRefIsDeal",scope:"r"},{key:"computingFlag",scope:"r"},{key:"mv_computingFlag",scope:"r"},{key:"tabletFlag",scope:"r"},{key:"applianceProductFlag",scope:"r"},{key:"mv_applianceProductFlag",scope:"r"},{key:"peEntertainmentFlag",scope:"r"},{key:"mv_tabletFlag",scope:"r"},{key:"mv_peEntertainmentFlag",scope:"r"},{key:"initialRefIsMail",scope:"r"},{key:"mv_initialRefIsMail",scope:"r"},{key:"initialRefIsGoogle",scope:"r"},{key:"mv_initialRefIsGoogle",scope:"r"},{key:"initialRefIsYahoo",scope:"r"},{key:"mv_initialRefIsYahoo",scope:"r"},{key:"initialRefIsBestbuy",scope:"r"},{key:"mv_initialRefIsBestbuy",scope:"r"},{key:"mv_suppressMPQInvite",scope:"r"},{key:"mv_blockIPAddress",scope:"r"}]}};SN.EventManager.fire("pageevent",b)}function getUrlId(){var a=parent.window.location.href;return a.indexOf("testpages/rules.html")!=-1?"rules":a.indexOf("crossdomain.html")?"cross":parent.window.location.host.indexOf("bestbuy.com")?"home":"a"}function getEncodedValue(a){return a=="http://247testsite.com/test.html"?"h":a=="abcd type of product category"?"a":a=="in.yahoo.com"?"Y":a=="www.google.co.in"?"G":a}function getDecodedValue(a){return a=="h"?"http://247testsite.com/test.html":a=="Y"?"in.yahoo.com":a=="G"?"www.google.co.in":a}function tfsonChat(){var a=$getData("tfsonChat")||0;return a=parseInt(a),a}function updateTfsOnChat(a){$setData("tfsonChat",a)}function updateTfsOnChatInLocalStorage(a){var b=a||"0",c=SN.Constants.DEFAULT_STORE_LIFETIME_MAP[SN_CONSTANTS.SN_VARIABLE_STORE_NAME];SN.CrossXDataHandler.setLocalStorageItem("sn.tfsonChat",b,c,null),setTfsonChatLS(b)}function syncTfsOnChatFromLocalStorage(){SN.CrossXDataHandler.getLocalStorageItem("sn.tfsonChat",function(a,b){setTfsonChatLS(b)})}function setTfsonChatLS(a){!$undefinedOrNull(a)&&a!=""&&(tfsonChatLS=a)}function getTfsonChatLS(){return tfsonChatLS}function isLocalStoreSupported(){return SN.Store.getType()!=SN.Constants.IE_STORAGE}function setVisitedFlag(){var a=parent.location.search.indexOf("?id=pcat170")==0?1:0;$setData("cartFlag",a);var b=getCurrentPageTitle().search(/CART/i)!==-1?updateCtCookie("cartFlag","1"):"",c=parent.location.search.indexOf("?id=pcat17009")==0?1:0;$setData("deliveryFlag",c)}function randomUUID(){var a=[],b="0123456789ABCDEF";for(var c=0;c<36;c++)a[c]=Math.floor(Math.random()*16);a[14]=4,a[19]=a[19]&3|8;for(var c=0;c<36;c++)a[c]=b.charAt(a[c]);return a[8]=a[13]=a[18]=a[23]="-",a.join("").toLowerCase()}function getInviteTypeFromRuleId(a){var b="";return a.indexOf("_DOCK")>-1?b="b":a.indexOf("BBY_PR_")>-1?b="p":b="b",b}function fireInviteEvent(a,b,c,d){var d=d;$undefinedOrNull(b)&&(b="rule_is_undef"),$undefinedOrNull(d)&&(d="clid_is_undef");var e=getInviteTypeFromRuleId(b);SN.EventManager.fire("WOWPXAPP_EVENT",{eventId:a,fireImmediately:!0,data:{ed:{eventName:c,appid:"BESTBUY_APP01_01"},f:{v:{ri:b,rn:b,rc:e,ip:$geoIPAddress(),ct:$geoCity(),co:$geoCountry(),org:$geoOrganization(),wr:$geoRegion(),zip:$geoPostalCode(),isp:$geoIsp(),pcs:$getTotalVisitCount()},o:{ii:d,id:appid,it:e,ic:getSessionInviteCount()},a:{qu:sanitizeQueue(nemoChatConfig.queue)},p:{cp:parent.document.location.href}}}})}function captureConversions(){var a=location.host.indexOf("espanol")==0?"espanol":"english";if(!$undefinedOrNull(this.callOnceCaptureConversions)&&this.callOnceCaptureConversions==1)return;var b={};b.f={},b.f.u={},b.f.o={},b.f.a={},b.f.p={},b.f.v={},b.ed={},b.st=(new Date).getTime();var c=parent.jQuery;if(c){if(location.host=="business.geeksquad.com"||location.host=="www.bestbuybusiness.com"||location.host=="bbfb-vip-pl1-ext.bestbuy.com"||location.host=="epro-pl.bestbuybusiness.com"){if(!$undefinedOrNull(c(".checkout-title"))&&c(".checkout-title").text()==="Thank You"){var d="",e="";!$undefinedOrNull(c(".column.third.no-top-margin"))&&c(".column.third.no-top-margin").length!==0&&(d=c(".column.third.no-top-margin a").text()),!$undefinedOrNull(c(".total-price"))&&c(".total-price").length!==0&&(e=parseFloat(decodeURIComponent(c(".total-price .val").text()).replace(/[^(\d)(\.)]/g,"")));if(d!==""&&e!==""){b.f.u.pi=parent.order_id||d||"",b.f.u.am=parent.rev||e||"",$undefinedOrNull($getData("svdclid"))||$getData("svdclid")===""||$undefinedOrNull($getData("svdq"))||$getData("svdq")===""?(b.f.o.ii=$getData("clid")||"",b.f.a.qu=$getData("queue")||""):(b.f.o.ii=$getData("svdclid")||"",b.f.a.qu=$getData("svdq")||""),b.f.v.ri=$getData("ruleId")||"";var f=$getData("svdri")||"";f!=""&&!$undefinedOrNull(f)&&(b.f.v.ri=f),b.f.v.rc="b";var g=$getData("conversionEvent")||"";g!=b.f.u.pi&&localStorage.getItem("previousOrder")!=b.f.u.pi&&(fireConversionEvent("11122",b),$setData("conversionEvent",b.f.u.pi),localStorage.setItem("previousOrder",b.f.u.pi))}}return}if(a==="english"){var h=parent.window.track;if(h&&h.catName=="Checkout - Thank You"){isPurchased=!0,b.f.u.pi="",b.f.u.am="";var i=0;if(h.qtyList){var j=h.qtyList.split(",");for(var k=0;k<j.length;k++)i+=parseInt(j[k])}b.f.u.on=i,b.ed.intid=$getData("svdintid")||"";try{b.f.u.pi=h.orderId||"";var l=0;if(h.priceList&&h.qtyList){var m=h.qtyList.split(","),n=h.priceList.split(",");for(var o=0;o<n.length;o++)l+=parseFloat(n[o])*parseInt(m[o])}b.f.u.am=l}catch(p){utils.info(p.message)}$undefinedOrNull($getData("svdclid"))||$getData("svdclid")===""||$undefinedOrNull($getData("svdq"))||$getData("svdq")===""?(b.f.o.ii=$getData("clid")||"",b.f.a.qu=$getData("queue")||""):(b.f.o.ii=$getData("svdclid")||"",b.f.a.qu=$getData("svdq")||""),b.f.v.hl=1,b.f.v.of=$getData("invOf"),b.f.v.ri=$getData("ruleId")||"";var f=$getData("svdri")||"";f!=""&&!$undefinedOrNull(f)&&(b.f.v.ri=f),b.f.v.rc=SN.CustomScript.getInviteTypeFromRuleId(b.f.v.ri),b.f.o.id="BBY_APP01_01",b.f.p.cp=parent.document.location.href,b.f.u.au=parent.guestUser!="undefined"&&parent.guestUser=="false"?"signedin":"guest",b.f.u.c29=h.skuList?h.skuList.split(",").join("|"):"",b.f.u.c30=c?c(h.products)?c(h.products).map(function(){return this.meta.shortLabel}).toArray().join("|"):"":"";var g=$getData("conversionEvent")||"";g!=b.f.u.pi&&localStorage.getItem("previousOrder")!=b.f.u.pi&&(b.f.o.ic=getSessionInviteCount(),fireConversionEvent("11122",b),this.callOnceCaptureConversions=!0,$setData("conversionEvent",b.f.u.pi),localStorage.setItem("previousOrder",b.f.u.pi))}}else if(a==="espanol"&&c.trim(c(".primtitle").text()).match(/GRACIAS POR SU PEDIDO/i)!=null){isPurchased=!0,b.f.u.pi="",b.f.u.am="",b.f.u.on=captureOrderUnits(),b.ed.intid=$getData("svdintid")||"";try{b.f.u.pi=c.trim(escape(c(".order-id").text())).replace(/N%FAmero%20de%20pedido%3A(%A0|%20)/g,"").replace(/(%20)+(%0A)*/,"").replace(/(%0A)*%20%20(%0A)*/g,"|").replace(/(%20|%0A)/,""),b.f.u.am=parseFloat(c.trim(c(".total-summary tr:nth-child(1) td:nth-child(2)").text()).replace(/[^(\d)(\.)]/g,""))}catch(p){utils.info(p.message)}$undefinedOrNull($getData("svdclid"))||$getData("svdclid")===""||$undefinedOrNull($getData("svdq"))||$getData("svdq")===""?(b.f.o.ii=$getData("clid")||"",b.f.a.qu=$getData("queue")||""):(b.f.o.ii=$getData("svdclid")||"",b.f.a.qu=$getData("svdq")||""),b.f.v.hl=1,b.f.v.of=$getData("invOf"),b.f.v.ri=$getData("ruleId")||"";var f=$getData("svdri")||"";f!=""&&!$undefinedOrNull(f)&&(b.f.v.ri=f),b.f.v.rc=SN.CustomScript.getInviteTypeFromRuleId(b.f.v.ri),b.f.o.id="BBY_APP01_01",b.f.p.cp=parent.document.location.href,b.f.u.au=parent.guestUser!="undefined"&&parent.guestUser=="false"?"signedin":"guest",b.f.u.c29=c(".bdt-thankYou-sku").map(function(){return c.trim(c(this).text())}).toArray().join("|"),b.f.u.c30=c(".proddesc-title").map(function(){return c.trim(c(this).text())}).toArray().join("|");var g=$getData("conversionEvent")||"";g!=b.f.u.pi&&localStorage.getItem("previousOrder")!=b.f.u.pi&&(b.f.o.ic=getSessionInviteCount(),fireConversionEvent("11122",b),$setData("conversionEvent",b.f.u.pi),localStorage.setItem("previousOrder",b.f.u.pi))}}}function captureOrderUnits(){var a=0,b=parent.jQuery;return(b(".stdcolumn.centered.qty")!==undefined||b(".stdcolumn.centered.qty")!=="")&&b.each(b(".stdcolumn.centered.qty"),function(){a+=parseInt(b(this).text())}),a}function fireConversionEvent(a,b){var c={},d=SN.ConfigurationManager;c.key=d.getPSPKey(),b.ec=a,parent.SN.Tracker.constructAndMakeTrackingCall(c,b)}function getVCCount(){var a=cookiejar.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,SN_CONSTANTS.PAGE_LOAD_COUNTER);if($undefinedOrNull(a)||a=="")a=0;return a}function resetQueueId(){var a=$getData("queue"),b=sanitizeQueue(a);b&&($setData("queue",b),SN.EventManager.fire(SN_CONSTANTS.UPDATE_FSMVARIABLES_EVENT))}function sanitizeQueue(a){var b=["bestbuy-queue-mobile-3","bestbuy-queue-cart","bestbuy-queue-computing","bestbuy-queue-tablets-ereaders","bestbuy-queue-home-theater","bestbuy-queue-appliances","bestbuy-queue-pe-entertainment","bestbuy-Service-Queue","bestbuy-Gift-Queue","bestbuy-Scheduler","bestbuy-BBFB-Sales-queue","bestbuy-BBFB-All-Users-queue","bestbuy-BBFB-Customer-Support-queue","bestbuy-BBFB-GS-SandS-queue","bestbuy-BBFB-GS-SS-queue","bestbuy-queue-test","bestbuy-Training"];if(!$undefinedOrNull(a)&&a!=="")for(var c=0,d=b.length;c<d;c++)if(a.indexOf(b[c])>-1)return b[c];return""}function updateCtCookie(a,b){var c=".bestbuy.com";c=getPageDivId()=="px-button-chat"||getPageDivId()=="px-button-chat-gs"?location.host:".bestbuy.com";var d=$cookieGet("sn.ct")||"";d=SN.CustomScript.objectifyCookie(d),!$undefinedOrNull(a)&&!$undefinedOrNull(b)&&(d[a]=b),d=SN.CustomScript.stringifyCookieObj(d),$cookieSet("sn.ct",d,{time:36e5,domain:c})}function getValueFromCTCookie(a){var b=$cookieGet("sn.ct")||"";return b=SN.CustomScript.objectifyCookie(b),b[a]||""}function getChatConfigFromCookie(){var a=$cookieGet("sn.chat.config"),b;if(!!$undefinedOrNull(a))return null;b=a.evalJSON();if(typeof b=="object"&&!$undefinedOrNull(b.queue)&&!$undefinedOrNull(b.avqueue)&&!$undefinedOrNull(b.accountId)&&!$undefinedOrNull(b.server)&&!$undefinedOrNull(b.caserver)&&b["queue"]!=""&&b["avqueue"]!=""&&b["accountId"]!=""&&b["server"]!=""&&b["caserver"]!="")return b}function getChatQueue(){var a=sanitizeQueue($getData("queue"));return a}function chatConfigDecider(){var a=getChatConfigFromCookie();a!=null&&(nemoChatConfig=a)}function checkAvailability(a){if(getPageDivId()=="px-expertService"){nemoChatConfig.queue="expertService-queue",nemoChatConfig.avqueue="expertService-queue",fireInviteEvent("11103",ruleId,"InviteOffered",clids.btnclid),inviteOfferedFlag=!1,checkAvailabilityFlag=!1;return}if(a.ruleId=="startChat"||a.ruleId=="startTNC"){SN.WOWPx.AppController.afterAvailabilityCheck(!0);return}var b="https://"+nemoChatConfig.caserver+"/en/ca/rest",c=b+"/checkAvailability",d=this,e=document.createElement("script"),f=$getData("trid")||"";e.id="nemo-agent-availability"+(new Date).getTime(),e.src=c+"?queueId="+nemoChatConfig.avqueue+"&trackingId="+f+"&accountId="+nemoChatConfig.accountId+"&jsonp=SN.CustomScript.agentAvailabilityCallback&timestamp="+(new Date).getTime();var g=document.getElementById("nemo-agent-availability");g&&g.parentNode.removeChild(g),document.body.appendChild(e)}function objectifyCookie(a){var b=a.match(/[^|]+/g),c={};for(var d in b)if(String(Number(d))===d&&b.hasOwnProperty(d)){var e=b[d].match(/[^~]+/g);!$undefinedOrNull(e[1])&&e[1]!=""?c[e[0]]=SN.Base64Encoder.decode(e[1]):SN.Utils.info("SN: ignoring blank or null values for sn.cfv cookie")}return c}function stringifyCookieObj(a){var b="";for(var c in a)a.hasOwnProperty(c)&&!$undefinedOrNull(a[c])&&typeof a[c]!="object"?b=b+c+"~"+SN.Base64Encoder.encode(a[c]):b=b+c+"~"+SN.Base64Encoder.encode(stringifyCookieObj(a[c])),b+="|";return b.charAt(b.length-1)=="|"&&(b=b.substr(0,b.length-1)),b}function pSp_Console(a){window.console&&typeof console.info=="function"&&console.info(a)}function getContextData(a,b){var c={},d=".bestbuy.com",e=$cookieGet("sn.ct")||"";if(!$undefinedOrNull(e)||e!="")c=$cookieGet("sn.ct")||"",c=objectifyCookie(c);clids.clid=b,c.IP=$geoIPAddress(),c.asid=$activeSessionId(),c.bsid=SN.StoreManager.getValueFromStore("sn.vi","vi")+"-"+SN.StoreManager.getValueFromStore("sn.vi","as"),c.tpid=SN.GlobalSession().getTargetPopulationId(),c.vg=SN.GlobalSession().getVisitorGroup(),c.appid=appid,c.invitePage=parent.SN.Tracker.getUniquePageId().toString(),c.pcs=$getTotalVisitCount().toString(),c.country=$geoCountry(),c.city=$geoCity(),c.org=$geoOrganization(),c.worldRegion=$geoRegion(),c.postCode=$geoPostalCode(),c.isp=$geoIsp(),c.browser=navigator.userAgent,c.trid=$getData("trid"),c.locale=location.host.indexOf("espanol")>-1?"es_US":"en_US",c.rid=a,c.pName=parent.document.title,c.pURL=a=="directchat"?encodeURIComponent(parent.location.href):parent.location.href,c.cts=currentTimeInCST()+"";if(a=="BBFB_showchatbutton"||a=="BBFB_showchatbuttonGs"){d=location.host;var f="",g="",h=parent.jQuery?parent.jQuery.trim(parent.jQuery("#orderSumProdDesCol").text()).substr(0,parent.jQuery.trim(parent.jQuery("#orderSumProdDesCol").text()).indexOf("Item")).replace(/\s/g,"")||"":"";typeof parent.x2!="undefined"&&(f=parent.x2),typeof parent.rev!="undefined"&&(g=parent.rev),typeof parent.skuDetail!="undefined"&&((h==null||h=="")&&typeof parent.skuDetail.skus!="undefined"&&typeof parent.skuDetail.skus[0].title!="undefined"&&(h=parent.skuDetail.skus[0].title),(f==null||f=="")&&typeof parent.skuDetail.skus!="undefined"&&typeof parent.skuDetail.skus[0].price!="undefined"&&(f=parent.skuDetail.skus[0].price)),c.prName=h,c.prTotal=f,c.orTotal=g,c.sts=SN.ConfigurationManager.getServerTimeStamp()+""}else parent.jQuery&&(c.prName=parent.jQuery.trim(parent.jQuery("#productsummary").find("h1").text())?escape(parent.jQuery.trim(parent.jQuery("#productsummary").find("h1").text())):"",c.plName=parent.jQuery.trim(parent.jQuery(".salenum").text())?escape(parent.jQuery.trim(parent.jQuery(".salenum").text())):"",c.prTotal=parent.jQuery.trim(parent.jQuery(".cart-product-price-total").text())?escape(parent.jQuery.trim(parent.jQuery(".cart-product-price-total").text())):"",c.orTotal=parent.jQuery.trim(parent.jQuery(".bdt-orderTotal").text())?escape(parent.jQuery.trim(parent.jQuery(".bdt-orderTotal").text())):"");$setData("clid",clids.clid),c.clid=clids.clid,c.nemo={queue:nemoChatConfig.queue,accountId:nemoChatConfig.accountId,server:nemoChatConfig.server,caserver:nemoChatConfig.caserver},c=stringifyCookieObj(c),$cookieSet("sn.ct",c,{time:36e5,domain:d})}function generateActionUrl(a){var a=a,b="www-ssl.bestbuy.com",c="chatapp.gz.js",d="https:";getPageDivId()=="px-services"?c="gs_chatapp.gz.js":getPageDivId()=="px-scheduler"?c="schedulerchatapp.gz.js":getPageDivId()=="px-button-chat"?(b=location.host,c="bbfbchatapp.gz.js"):getPageDivId()=="px-button-chat-gs"&&(d="http:",b=location.host,c="bbfbgschatapp.gz.js");var e=d+"//"+SN.Conf.DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION[b]+"#key=bestbuy-v1-001&env="+window._tfsc.env+"&cdnPath="+SN.Conf.CDN_DOMAIN+"&documentDomain="+b+"&version="+SN.Conf.CONST_CDN_VERSION+"&pspVersion=default&r="+c;return e}function checkTime(a){return a<10&&(a="0"+a),a}function currentTimeInCST(){var a=new Date,b=new Date(a.getFullYear(),0,1),c=new Date(a.getFullYear(),6,1),d=Math.max(b.getTimezoneOffset(),c.getTimezoneOffset()),e=-216e5;a.getTimezoneOffset()<d&&(e=-18e6);var f=SN.ConfigurationManager.getServerTimeStamp()+e;return f}function isOutOfOffice(){var a=new Date,b=a.getTime()+a.getTimezoneOffset()*6e4,c=new Date(SN.ConfigurationManager.getServerTimeStamp()),d=new Date(currentTimeInCST()),e=parseFloat(checkTime(d.getUTCHours())+""+checkTime(d.getUTCMinutes()));return getPageDivId()=="px-scheduler"?e>=700&&e<=2300?"false":"true":getPageDivId()=="px-services"?e>0&&e<600?"true":"false":e>100&&e<700?"true":"false"}function updateLastInteraction(){var a=(new Date).getTime();updateCtCookie("li",a.toString())}function startChatButtonCookiePoller(inviteType){var inviteType=inviteType,pollId=window.setInterval(function(){chatWindowId!=null&&chatWindowId.closed==1&&(updateTfsOnChat(0),updateTfsOnChatInLocalStorage("0"),updateCtCookie("ds",""),inviteType=="b"?(clids.btnclid=randomUUID(),$setData("clid",clids.btnclid)):inviteType=="p"?(clids.proclid=randomUUID(),$setData("clid",clids.proclid)):(clids.proclid="clid_is_undef"+(new Date).getTime(),clids.btnclid="clid_is_undef"+(new Date).getTime(),$setData("clid",clids.btnclid)),inviteOfferedFlag=!0,agentOfflineFlag=!0,chatInProgress=!1,isProactiveShown=!1,resetDockButton(),checkAvailability({ruleId:"invite"}),window.clearInterval(pollId),setLI()),dismissProactiveChatInvite();var divIds=$getData("divId"),getDataStatus=getValueFromCTCookie("ds");if(getDataStatus=="prechat"){var PrechatEvent=eval(bbyPrechatEvents[divIds]);updateCtCookie("ds","")}else if(getDataStatus=="connected"){var ChatConnectedEvent=eval(bbyChatConnectedEvents[divIds]);updateCtCookie("ds","")}else if(getDataStatus=="interactive"){var ChatConnectedEvent=eval(bbyInteractiveChatEvents[divIds]);updateCtCookie("ds","")}else if(getDataStatus=="feedback"){var FeedbackSubmitEvent=eval(bbyFeedbackSubmitEvents[divIds]);updateCtCookie("ds","")}updateLastInteraction();var svdintid=getValueFromCTCookie("svdintid");svdintid!=""&&svdintid!=null&&$setData("svdintid",svdintid);var svdclid=getValueFromCTCookie("svdclid");svdclid!=""&&svdclid!=null&&$setData("svdclid",svdclid);var svdq=getValueFromCTCookie("svdq");svdq!=""&&svdq!=null&&$setData("svdq",svdq);var svdri=getValueFromCTCookie("svdri");svdri!=""&&svdri!=null&&$setData("svdri",svdri)},1e3);Event.observe(window,"beforeunload",function(){updateTfsOnChat(0),updateTfsOnChatInLocalStorage("0")})}function correctCSS(a){var b=parent.$(a);b.removeClass(),a.id=="px-span-checkout1-chat-now"&&(a.parentElement.style.border="solid 0px")}function isProductQueue(){var a=getChatQueue();return a=="bestbuy-queue-computing"||a=="bestbuy-queue-tablets-ereaders"||a=="bestbuy-queue-home-theater"||a=="bestbuy-queue-appliances"||a=="bestbuy-queue-pe-entertainment"?!0:!1}function macSafariSuppression(){var a=parent.SN.UserAgentParser.getOSType();return parent.SN.UserAgentParser.isBrowser("Version")&&a.search(/MacOS/i)!=-1?1:0}function mpqSuppression(){return getUserIsHotLead()=="1"||parseInt(getValueFromCTCookie("cSessInvite")||"0",10)>=1?macSafariSuppression()==0?"0":"1":0}function pqSuppression(){return getUserIsPQHotLead()=="1"||parseInt(getValueFromCTCookie("cSessInvite")||"0",10)>=1?parseInt(getValueFromCTCookie("cSessInvite")||"0",10)<2&&getTSLI()>=300&&getCaPCCount()<4&&macSafariSuppression()==0?"0":"1":getCaPCCount()<4?"0":"1"}function setStyle(a,b){for(var c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c])}function isIPBlocked(){var a=["74.62.98.237","152.26.210.24","152.26.230.34","207.144.99.6","184.179.123.228","152.26.10.156"],b=$geoIPAddress();for(var c=0,d=a.length;c<d;c++)if(b==a[c])return"1";return"0"}function agentAvailabilityCallback(a){var b=SN.ConfigurationManager.getTargetPopulationId();if(getPageDivId()=="px-button-chat"||getPageDivId()=="px-button-chat-gs")isBBFBPageFlag=!0;if(typeof a.data!=undefined&&typeof a.data.caStatus!=undefined&&a.data.caStatus=="true"){$setData("trid",a.data.trackingId),agentAvailableBBFB=!0,checkAvailPC==1&&(offerProactiveChat(),caPCCount=0);for(var c=0;c<value.length;c++){var d=value[c],e=parent.document.getElementById(d);e&&($setData("divId",d),isBBFBPageFlag?(e.innerHTML=pxHTMLCode[d]["agent-online"],setStyle(e,pxHTMLCode[d].cssProperties)):ln=="en"?b==1||b==3||b==4||b==5?getPageDivId()=="px-scheduler"?(checkAvailabilityFlag=!0,e.innerHTML=pxHTMLCode[d]["agent-online"]):(showDockButton("agent-online"),inviteOfferedFlag=!1):(e.innerHTML="",inviteOfferedFlag=!1):e.innerHTML=pxHTMLCodeEs[d]["agent-online"],inviteOfferedFlag==1&&(clids.btnclid=randomUUID(),$setData("clid",clids.btnclid),fireInviteEvent("11103",ruleId,"InviteOffered",clids.btnclid),inviteOfferedFlag=!1));var f=parent.document.getElementById(d+"-chat-now");isBBFBPageFlag&&(f=parent.document.getElementById(d)),f&&(Event.observe(f,"click",function(){Event.stopObserving(f,"click"),ln=="en"?e.innerHTML=pxHTMLCode[d]["agent-offline"]:e.innerHTML=pxHTMLCodeEs[d]["agent-offline"],$setData("ruleId",ruleId),fireInviteEvent("11104",ruleId,"InviteAccepted",clids.btnclid),$setData("clid",clids.btnclid),launchChat(ruleId,clids.btnclid)}),isBBFBPageFlag||singleDoubleClick(f,singleDoubleClickCallback,singleDoubleClickCallback))}}else if(isBBFBPageFlag)agentAvailableBBFB=!1,agentOfflinePollerBBFB();else if(isOutOfOffice()==="true"){checkAvailPC==1&&(dismissProactiveChatInvite(),caPCCount++,caPCCount>=1&&setLI());for(var c=0;c<value.length;c++){var d=value[c],e=parent.document.getElementById(d);e&&(ln=="en"?((b==1||b==3||b==4||b==5)&&getPageDivId()=="px-scheduler"&&(e.innerHTML=pxHTMLCode[d]["out-of-office"]),dismissDockButton(),checkAvailabilityFlag=!1):e.innerHTML=pxHTMLCodeEs[d]["out-of-office"])}}else{checkAvailPC==1&&(caPCCount++,dismissProactiveChatInvite(),caPCCount>=1&&setLI());for(var c=0;c<value.length;c++){var d=value[c],e=parent.document.getElementById(d);e&&(ln=="en"?(isMobileQueue()==1&&(dockButtonState["agent-offline"]="<div id='dock-invite' style='position:fixed;top:50%;margin-top:-62px;right: 0px;width:44px;height:124px;float:right;z-index:1000;background:white url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/dock-busy.png) no-repeat 0px;'><div id='dock-chat-now-disabled' style='height: 124px; width: 44px;  top: 0px; left: 0px; position: relative;  cursor: pointer;' title='Our chat representatives are assisting other customers. Please try again later or call 1-877-702-2211.'></div></div>"),b==1||b==3||b==4||b==5?getPageDivId()=="px-scheduler"?(checkAvailabilityFlag=!0,e.innerHTML=pxHTMLCode[d]["agent-offline"]):(showDockButton("agent-offline"),agentOfflineFlag=!1):(e.innerHTML="",agentOfflineFlag=!1)):e.innerHTML=pxHTMLCodeEs[d]["agent-offline"]),agentOfflineFlag==1&&(fireInviteEvent("400100",ruleId,"GreyChatButton",clids.btnclid),agentOfflineFlag=!1);var g=parent.document.getElementById(d+"-chat-now-disabled");g&&Event.observe(g,"click",function(){fireInviteEvent("400101",ruleId,"GreyChatButtonClicked",clids.btnclid)})}}}function launchChat(a,b){try{utils.debug("[DEBUG] - calling getContextData from launchChat"),getContextData(a,b);var c=parent.SN.UserAgentParser.getOSType();if(isLocalStoreSupported()){if(getTfsonChatLS()!="1"){var d=generateActionUrl({ri:a,clid:b});SN.WOWPx.CustomCobrowse.clear(),parent.SN.UserAgentParser.isBrowser("Version")&&c.search(/MacOS/i)!=-1&&getPageDivId()=="px-scheduler"?chatWindowId=parent.window.open(d,"bestbuyChatWindow","channelmode=no, directories=no, fullscreen=no, location=no, menubar=no, resizable=no, scrollbars=no, status=no, titlebar=no, toolbar=no, top=20, left=100, height=600,width=550"):chatWindowId=parent.window.open(d,"bestbuyChatWindow","channelmode=no, directories=no, fullscreen=no, location=no, menubar=no, resizable=no, scrollbars=no, status=no, titlebar=no, toolbar=no, top=20, left=100, height=570,width=550"),startChatButtonCookiePoller(getInviteTypeFromRuleId(a)),updateTfsOnChatInLocalStorage("1"),dismissDockButton(),chatInProgress=!0}}else if(tfsonChat()!==1){var d=generateActionUrl({ri:a,clid:b});SN.WOWPx.CustomCobrowse.clear(),parent.SN.UserAgentParser.isBrowser("Version")&&c.search(/MacOS/i)!=-1&&getPageDivId()=="px-scheduler"?chatWindowId=parent.window.open(d,"bestbuyChatWindow","channelmode=no, directories=no, fullscreen=no, location=no, menubar=no, resizable=no, scrollbars=no, status=no, titlebar=no, toolbar=no, top=20, left=100, height=600,width=550"):chatWindowId=parent.window.open(d,"bestbuyChatWindow","channelmode=no, directories=no, fullscreen=no, location=no, menubar=no, resizable=no, scrollbars=no, status=no, titlebar=no, toolbar=no, top=20, left=100, height=570,width=550"),startChatButtonCookiePoller(getInviteTypeFromRuleId(a)),updateTfsOnChat(1),dismissDockButton(),chatInProgress=!0}}catch(e){SN.Utils.errorTrack("Error in launching Chat",e)}}function agentOfflinePoller(){pollerCounter==0&&(pollerCounter++,setDivTimeout())}function agentOfflinePollerBBFB(){if(agentAvailableBBFB==0&&pollerCounter==0)var a=window.setInterval(function(){pollerCounter<3&&agentAvailableBBFB==0?(pollerCounter++,checkAvailability({ruleId:"invite"})):window.clearInterval(a)},15e3)}function setDivTimeout(){divPoller=window.setTimeout(function(){numPolls>=4?clearInterval(divPoller):(numPolls++,pollerInterval*=2,$undefinedOrNull(chatWindowId)?checkAvailability({ruleId:"invite"}):$undefinedOrNull(chatWindowId)||chatWindowId.closed==1&&checkAvailability({ruleId:"invite"}),setDivTimeout())},pollerInterval)}function clearAgentOfflinePoller(){clearTimeout(divPoller)}function insertHtmlCode(a,b,c){value=b,ln=a,ruleId=c;var d=$cookieGet("sn.chat.decide");$undefinedOrNull(d)||(phase=d);if(phase=="1")return;if(phase=="2"){for(var e=0;e<value.length;e++){var f=value[e],g=parent.document.getElementById(f);g&&($setData("divId",f),ln=="en"?(SN.ConfigurationManager.getTargetPopulationId()==5&&pxHTMLCode[f]["queue"]=="bestbuy-queue-mobile"&&(g.innerHTML=""),g.innerHTML=bbyHTMLCode[f]):g.innerHTML=bbyHTMLCodeEs[f])}return}for(var e=0;e<value.length;e++){var f=value[e],g=parent.document.getElementById(f);if(g){var h=getChatConfigFromCookie();h!=null?(nemoChatConfig.queue=h.queue,nemoChatConfig.avqueue=h.avqueue):c.indexOf("BBFB_")>-1?(nemoChatConfig.queue="bestbuy-BBFB-Sales-queue",nemoChatConfig.avqueue="bestbuy-BBFB-All-Users-queue"):ln=="en"?(nemoChatConfig.queue=pxHTMLCode[f]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()],nemoChatConfig.avqueue=pxHTMLCode[f]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()]):(nemoChatConfig.queue=pxHTMLCodeEs[f]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()],nemoChatConfig.avqueue=pxHTMLCodeEs[f]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()]),$setData("queue",nemoChatConfig.queue)}}checkAvailability({ruleId:"invite"}),$setData("ruleId",ruleId)}function setQueueId(a,b){ln=a,value=b;for(var c=0;c<value.length;c++){var d=value[c],e=getChatConfigFromCookie();e!=null?(nemoChatConfig.queue=e.queue,nemoChatConfig.avqueue=e.avqueue):$undefinedOrNull(SN.ConfigurationManager.getTargetPopulationId())?ln=="en"?(nemoChatConfig.queue=pxHTMLCode[d].queue,nemoChatConfig.avqueue=pxHTMLCode[d].queue):(nemoChatConfig.queue=pxHTMLCodeEs[d].queue,nemoChatConfig.avqueue=pxHTMLCodeEs[d].queue):ln=="en"?(nemoChatConfig.queue=pxHTMLCode[d]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()],nemoChatConfig.avqueue=pxHTMLCode[d]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()]):(nemoChatConfig.queue=pxHTMLCodeEs[d]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()],nemoChatConfig.avqueue=pxHTMLCodeEs[d]["queue-tp-"+SN.ConfigurationManager.getTargetPopulationId()]),$setData("queue",nemoChatConfig.queue)}}function updateStoreCustomData(a,b,c){var d=JSON.parse(c);return!$undefinedOrNull(a)&&!$undefinedOrNull(b)&&(b=encodeURIComponent(b),d[a]=b),JSON.stringify(d)}function getStoreCustomData(a,b){var c=JSON.parse(b);return decodeURIComponent(c[a])||""}function getShippingCharge(){var a=parent.jQuery;return a?a(".section.last .price.right.red").text():null}function setDeliveryOptionInCT(a){updateCtCookie("do",a)}function getDeliveryOptionInCT(){return getValueFromCTCookie("do")}function attachDOChange(){var a=parent.jQuery;a('input[name*="fulfillmentType"]').change(function(){setDeliveryOptionInCT(a?a('input:checked[name*="fulfillmentType"]').serialize().replace("=","|"):null),attachDOChange()})}function getDeliveryOption(){var a=parent.jQuery,b=a?a('input:checked[name*="fulfillmentType"]').serialize().replace("=","|"):null;return!$undefinedOrNull(b)&&b!=""?(attachDOChange(),setDeliveryOptionInCT(b),b):getDeliveryOptionInCT()}function getValuesFromLineItems(){parent.EventManager.on("backbone:model:order:sync",function(a){})}function cartCustomEvent(a){var b=parent.jQuery,c=location.host.indexOf("espanol")==0?"espanol":"english";if($undefinedOrNull(a))var d=(b?parent.cartOrderInit?b(parent.cartOrderInit.lineItems).map(function(){return this.item.modelNumber?this.item.modelNumber.text:""}).toArray().join("|"):"":"").replace(/\|$/,""),e=(b?parent.cartOrderInit?b(parent.cartOrderInit.lineItems).map(function(){return this.item.skuId}).toArray().join("|"):"":"").replace(/\|$/,""),f=(b?parent.cartOrderInit?b(parent.cartOrderInit.lineItems).map(function(){return b(this.associatedLineItems.warranties)?b(this.associatedLineItems.warranties).map(function(){return this.warrantyItem?this.warrantyItem.shortLabel:""}).toArray().join("|"):""}).toArray().join("|"):"":"").replace(/\|$/,""),g=(b?parent.cartOrderInit?b(parent.cartOrderInit.lineItems).map(function(){return b(this.associatedLineItems.warranties)?b(this.associatedLineItems.warranties).map(function(){return this.subtotal?this.subtotal.price:""}).toArray().join("|"):""}).toArray().join("|"):"":"").replace(/\|$/,""),h="",i=(b?parent.cartOrderInit?b(parent.cartOrderInit.lineItems).map(function(){return this.item.productName}).toArray().join("|"):"":"").replace(/\|$/,""),j=(parent.cartOrderInit?parent.cartOrderInit.totals.productTotal?parent.cartOrderInit.totals.productTotal.price.replace("$",""):"":"").replace(/\|$/,""),k=(parent.cartOrderInit?parent.cartOrderInit.totals.shipping?parent.cartOrderInit.totals.shipping.price.replace("$",""):"":"").replace(/\|$/,""),l=(parent.cartOrderInit?parent.cartOrderInit.totals.subTotal?parent.cartOrderInit.totals.subTotal.price.replace("$",""):"":"").replace(/\|$/,"");else var d="",e="",f="",g="",h=a,i="",j="",k="",l="";c=="english"?SN.EventManager.fire("WOWPXAPP_EVENT",{eventId:400103,fireImmediately:!0,data:{f:{c:{c20:d,c21:e,c23:f,c24:g,c25:h,c26:getRewardCertificate(),c27:getPromotionalCode()},t:{na:i,qt:$cookieGet("CartItemCount")||"",pr:j},u:{sc:k,"do":getDeliveryOption()||"",st:l}}}}):SN.EventManager.fire("WOWPXAPP_EVENT",{eventId:400103,fireImmediately:!0,data:{f:{c:{c20:d,c21:e,c23:f,c24:g,c25:h,c26:getRewardCertificate(),c27:getPromotionalCode()},t:{na:i,qt:$cookieGet("CartItemCount")||"",pr:j},u:{sc:k,"do":getDeliveryOption()||"",st:l}}}})}function getIfProductRemovedCart(){return productRemoved}function populateProductRemoved(a){var b="",c=a.attributes.item.shortLabel?a.attributes.item.shortLabel:"";SN.CrossXDataHandler.getLocalStorageItem("sn.cusvars",function(a,d){b=getStoreCustomData("prfc",d)||"",b==""?b=c:b=b+"|"+c,SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",updateStoreCustomData("prfc",b,d),36e5,function(a){}),productRemoved=b})}function setIfProductRemovedCart(){parent.EventManager.on("backbone:collection:lineItems:remove",function(a){populateProductRemoved(a),cartCustomEvent(a.attributes.item.shortLabel?a.attributes.item.shortLabel:"")})}function getRewardCertificate(){return rewardCertificate}function setRewardCertificate(){var a=parent.jQuery;a("input.bby-rewardZone-certificateNumber")?a("input.bby-rewardZone-certificateNumber").change(function(){SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",updateStoreCustomData("rewcert",a("input.bby-rewardZone-certificateNumber").val(),value),36e5,function(a){})}):SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",updateStoreCustomData("rewcert","",value),36e5,function(a){})}function getPromotionalCode(){return promotionalCode}function setPromotionalCode(){var a=parent.jQuery;a("input.bby-promoCode-number")?a("input.bby-promoCode-number").change(function(){SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",updateStoreCustomData("prcode",a("input.bby-promoCode-number").val(),value),36e5,function(a){})}):SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",updateStoreCustomData("prcode","",value),36e5,function(a){})}function getCartValueFrmStore(){SN.CrossXDataHandler.getLocalStorageItem("sn.cusvars",function(a,b){$undefinedOrNull(b)?(b={prfc:"",rewcert:"",prcode:""},SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",JSON.stringify(b),36e5,function(a){}),productRemoved="",rewardCertificate="",promotionalCode=""):(productRemoved=getStoreCustomData("prfc",b),rewardCertificate=getStoreCustomData("rewcert",b),promotionalCode=getStoreCustomData("prcode",b)),cartCustomEvent();var c={prfc:"",rewcert:"",prcode:""};SN.CrossXDataHandler.setLocalStorageItem("sn.cusvars",JSON.stringify(c),36e5,function(a){setIfProductRemovedCart(),setRewardCertificate(),setPromotionalCode()})})}function getSKUNumber(){var a=parent.jQuery,b="";if(!$undefinedOrNull(parent.cartOrderInit)&&parent.cartOrderInit!==""){var c=parent.cartOrderInit;if(c.lineItems.length==1)return c.lineItems[0].item.skuId;for(var d=0;d<c.lineItems.length;d++)b=b+"|"+c.lineItems[d].item.skuId;return b=b.substr(1),b}return""}function getCaPCCount(){return caPCCount}function makeUserHLOverride(){(parent.document.getElementById("px-span-checkout5-chat-now")||parent.document.getElementById("px-span-checkout6-chat-now")||$getTotalVisitCount()==1&&parent.document.referrer.search(/pcat17000/i)!=-1)&&setUserAsHotLead()}function resetCookiesOnASChange(){var a=getValueFromCTCookie("svdasid");if(!$undefinedOrNull(a)&&a!=$activeSessionId()){initScoreBitMap(),initSessionInviteCount(),initUserAsHotLead(),initTSLI(),updateCtCookie("svdri",""),$setData("svdri",""),updateCtCookie("inRef",parent.document.referrer);var b=parseInt(cookiejar.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,SN_CONSTANTS.PAGE_LOAD_COUNTER))-1||0;$setData("ntps",b.toString()),updateCtCookie("svdasid",$activeSessionId().toString())}}function initializeModelVars(){initSessionInviteCount()}function initScoreBitMap(){if($undefinedOrNull(getValueFromCTCookie("scoreBitMap"))){var a="";for(var b=0;b<26;b++)a+="0";updateCtCookie("scoreBitMap",a)}}function updateScoreBitMap(a,b,c){if($undefinedOrNull(c)||c=="")c="00000000000000000000000000";var d=c.split("");return d[b]=a,d.join("")}function getScoreBitMap(){var a=getValueFromCTCookie("scoreBitMap");return a=updateCurrTITLEMap(a),a=updateHODMap(a),a=updateDOWMap(a),a=updateNOPVMap(a),a=updateOSMap(a),a=updateINITIAL_REFMap(a),updateCtCookie("scoreBitMap",a),a}function updateCurrTITLEMap(a){var b=parent.document.title||"";return b.search(/SPRINT/i)!==-1&&(b.search(/MOBILE/i)!==-1||b.search(/PHONE/i)!==-1)&&(a=updateScoreBitMap(1,0,a)),(b.search(/BLACKBERRY/i)!==-1||b.search(/HTC/i)!==-1)&&(b.search(/MOBILE/i)!==-1||b.search(/PHONE/i)!==-1)&&(a=updateScoreBitMap(1,1,a)),b.search(/AT&T/i)!==-1&&(b.search(/MOBILE/i)!==-1||b.search(/PHONE/i)!==-1)&&(a=updateScoreBitMap(1,2,a)),a}function updateTOSMap(a){var b=$timeOnSite();return b>=361&&b<=720&&(a=updateScoreBitMap(1,8,a)),b>=721&&b<=1080&&(a=updateScoreBitMap(1,9,a),a=updateScoreBitMap(0,8,a)),b>=1081&&b<=1800&&(a=updateScoreBitMap(1,10,a),a=updateScoreBitMap(0,9,a),a=updateScoreBitMap(0,8,a)),b>1800&&(a=updateScoreBitMap(1,11,a),a=updateScoreBitMap(0,10,a),a=updateScoreBitMap(0,9,a),a=updateScoreBitMap(0,8,a)),a}function updateExtSTMap(a){var b=getReferrer();if(b.search(/google.co/i)!=-1||b.search(/bing.com/i)!=-1){var c=/^q=/i;a=checkReferrerValue(b,c,a)}else if(b.search(/search.yahoo.com/i)!=-1){var c=/^p=/i;a=checkReferrerValue(b,c,a)}return a}function checkReferrerValue(a,b,c){var d="";if(!$undefinedOrNull(a)&&a!=""){a=a.split("?");if(!(a.length>=2))return;a=a[1].split("&");for(var e=0;e<a.length;e++)if(a[e].search(b)!=-1){d=a[e].split("=");if(!(d.length>=2))return;d=d[1];if(d!=""&&!$undefinedOrNull(d))return c=updateScoreBitMap(1,12,c),c}}}function updateIntSTMap(a){var b=getReferrer(),c="";b=b.split("?");if(b[0].search(/bestbuy.com/i)!=-1&&b.length>=2){b=b[1].split("&");for(var d=0;d<b.length;d++)if(b[d].search(/^st=/i)!=-1){c=b[d].split("=");if(c.length>=2){c=c[1];if(c!=""&&!$undefinedOrNull(c)){c.search(/APPLE/i)!=-1&&(a=updateScoreBitMap(1,13,a)),c.search(/SAMSUNG/i)!=-1&&(a=updateScoreBitMap(1,14,a)),c.search(/VIRGIN/i)!=-1&&(a=updateScoreBitMap(1,15,a)),c.search(/T-MOBILE/i)!=-1&&(a=updateScoreBitMap(1,16,a));if(c.search(/BLACKBERRY/i)!=-1||c.search(/BOOST/i)!=-1||c.search(/LG/i)!=-1||c.search(/HTC/i)!=-1||c.search(/MOTOROLA/i)!=-1||c.search(/NOKIA/i)!=-1||c.search(/GOOGLE.*NEXUS/i)!=-1)a=updateScoreBitMap(1,17,a)}return a}return}}return a}function getNopv(){var a=cookiejar.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,SN_CONSTANTS.PAGE_LOAD_COUNTER);if($undefinedOrNull(a)||a=="")a=0;var b=parseInt($getData("ntps"))||0,c=a-b;return updateCtCookie("sessNOPV",c.toString()),c}function updateNOPVMap(a){var b=getNopv()||0;return b>=2&&b<=8&&(a=updateScoreBitMap(1,7,a)),b>=9&&b<=15&&(a=updateScoreBitMap(1,8,a),a=updateScoreBitMap(0,7,a)),b>=16&&b<=20&&(a=updateScoreBitMap(1,9,a),a=updateScoreBitMap(0,8,a),a=updateScoreBitMap(0,7,a)),b>=21&&b<=27&&(a=updateScoreBitMap(1,10,a),a=updateScoreBitMap(0,9,a),a=updateScoreBitMap(0,8,a),a=updateScoreBitMap(0,7,a)),b>27&&(a=updateScoreBitMap(1,11,a),a=updateScoreBitMap(0,10,a),a=updateScoreBitMap(0,9,a),a=updateScoreBitMap(0,8,a),a=updateScoreBitMap(0,7,a)),b>=2&&b<=11&&(a=updateScoreBitMap(1,12,a)),b>=12&&b<=15&&(a=updateScoreBitMap(1,13,a),a=updateScoreBitMap(0,12,a)),b>=16&&b<=20&&(a=updateScoreBitMap(1,14,a),a=updateScoreBitMap(0,13,a),a=updateScoreBitMap(0,12,a)),b>=21&&b<=30&&(a=updateScoreBitMap(1,15,a),a=updateScoreBitMap(0,14,a),a=updateScoreBitMap(0,13,a),a=updateScoreBitMap(0,12,a)),b>30&&(a=updateScoreBitMap(1,16,a),a=updateScoreBitMap(0,15,a),a=updateScoreBitMap(0,14,a),a=updateScoreBitMap(0,13,a),a=updateScoreBitMap(0,12,a)),a}function updateOSMap(a){var b=parent.SN.UserAgentParser.getOSType();b.search(/Windows/i)!=-1&&(a=updateScoreBitMap(1,17,a));if(b.search(/Windows-8/i)!=-1||b.search(/Windows-7/i)!=-1)a=updateScoreBitMap(1,18,a);return a}function updateINITIAL_REFMap(a){var b=getValueFromCTCookie("inRef")||"";if(!$undefinedOrNull(b)&&b!=""){b.search(/GOOGLE/i)!=-1&&(a=updateScoreBitMap(1,19,a)),b.search(/BESTBUY/i)!=-1&&(a=updateScoreBitMap(1,20,a));if(b.search(/YAHOO/i)!=-1||b.search(/BING/i)!=-1)a=updateScoreBitMap(1,21,a)}return a}function updatePlanMap(a){var b=getSelectedPlanName();return!$undefinedOrNull(b)&&b!=""&&(a=updateScoreBitMap(1,22,a)),a}function updateOfferMap(a){var b=offersWithProduct();return!$undefinedOrNull(b)&&b!=""&&(a=updateScoreBitMap(1,23,a)),a}function updateHODMap(a){var b=getHOD();b>=3&&b<=11&&(a=updateScoreBitMap(1,3,a));if(b>=16||b<=1)a=updateScoreBitMap(1,4,a);return a}function updateDOWMap(a){var b=getDOW();if(b==0||b==1||b==2)a=updateScoreBitMap(1,5,a);if(b==3||b==4)a=updateScoreBitMap(1,6,a);return a}function getReferrer(){return parent.document.referrer||""}function getCurrentURL(){return parent.document.location.href||""}function getCurPageNavPath(){var a=parent.jQuery;if(a)return a("#searchstate").length>0?a.trim(a("#searchstate").text().replace(/\n+/g,"").replace(/\s+/g," ")):a.trim(a("#breadcrumb-list").text().replace(/\n+/g,"").replace(/\s+/g," "))}function getCurrentPageTitle(){return parent.document.title||""}function getProductNameCart(){var a=parent.jQuery;return a?a(".product-summary-label").map(function(){return a.trim(a(this).text())}).toArray().join("|"):null}function getCurrentURL_concat_Title(){return getCurrentURL()+"##"+getCurrentPageTitle()}function getSelectedPlanName(){var a=parent.jQuery;return a?a(".css-mt-planset-title").map(function(){return a.trim(a(this).text())}).toArray().join("|"):null}function getProductName(){var a=parent.jQuery;return a?a.trim(a("#sku-title").text()):null}function getProductModel(){var a=parent.jQuery;return a?a.trim(a("#sku-model").find("#model-value").text()):null}function getProductSKU(){var a=parent.jQuery;return a?a.trim(a("#sku-model").find("#sku-value").text()):null}function getProductRating(){var a=parent.jQuery;return a?a.trim(a("#sku-model").find(".average-score").text()):null}function getProductReview(){var a=parent.jQuery;if(a&&a("#sku-model").length>0){var b=a("#sku-model").find('meta[itemprop="reviewCount"]').attr("content");if(b!=undefined)return a?a.trim(b.replace(/,/g,"")):null}return null}function getProductPrice(){var a=parent.jQuery;return a?a.trim(a("#price").find(".item-price").text().replace(/\$/g,"")):null}function offersWithProduct(){var a=parent.jQuery;return a?a.trim(a("#financing ul li:eq(0)").text()):null}function getHOD(){var a=new Date(parseInt($getActiveSessionStartTime()));return a.getUTCHours()}function getDOW(){var a=new Date(parseInt($getActiveSessionStartTime()));return a.getUTCDay()}function initSessionInviteCount(){$undefinedOrNull(getValueFromCTCookie("cSessInvite"))&&updateCtCookie("cSessInvite","0")}function incSessionInviteCount(){var a=getValueFromCTCookie("cSessInvite");if($undefinedOrNull(a)||a=="")a="0";updateCtCookie("cSessInvite",(parseInt(a)+1).toString())}function getSessionInviteCount(){var a=getValueFromCTCookie("cSessInvite");if(a==""||$undefinedOrNull(a))a="0";return parseInt(a,10)}function setWidgetShown(){widgetShown=1}function unsetWidgetShown(){widgetShown=0}function isWidgetShown(){return widgetShown}function initTSLI(){var a=(new Date).getTime();updateCtCookie("li",a.toString())}function setLI(){var a=(new Date).getTime();updateCtCookie("li",a.toString())}function getTSLI(){var a=(new Date).getTime();isWidgetShown()&&updateCtCookie("li",a.toString());var b=getValueFromCTCookie("li");return!$undefinedOrNull(b)&&b!=""&&b!="0"?(b=parseInt(b),tsli=Math.floor((a-b)/1e3)):tsli=0,tsli}function initUserAsHotLead(){updateCtCookie("hl","0"),updateCtCookie("ccqHl","0"),updateCtCookie("pqHl","0")}function setUserAsHotLead(a){a=="CCQ"?updateCtCookie("ccqHl","1"):a=="PQ"?updateCtCookie("pqHl","1"):updateCtCookie("hl","1")}function getUserIsHotLead(){return getValueFromCTCookie("hl")||"0"}function getUserIsCCQHotLead(){return getValueFromCTCookie("ccqHl")||"0"}function getUserIsPQHotLead(){return getValueFromCTCookie("pqHl")||"0"}function ccqSession(){this.asid="",this.tsov="",this.tos="",this.nop="",this.clv="",this.clvpc="",this.clvp="",this.letv="",this.getCCQSession=function(a,b){var c=this;for(var d in c)if(c.hasOwnProperty(d))return c[a]},this.setCCQSession=function(a,b,c,d,e,f,g,h,i,j){SN.CrossXDataHandler.getLocalStorageItem("sn."+i+"sessn",function(k,l){l=updateStoreCustomData("asid",a,l),l=updateStoreCustomData("tsov",b,l),l=updateStoreCustomData("tos",c,l),l=updateStoreCustomData("nop",d,l),l=updateStoreCustomData("clv",e,l),l=updateStoreCustomData("clvpc",f,l),l=updateStoreCustomData("clvp",g,l),l=updateStoreCustomData("letv",h,l),SN.CrossXDataHandler.setLocalStorageItem("sn."+i+"sessn",l,ccqSessnLifetime,function(k){setValuesToCCQSessnObj(a,b,c,d,e,f,g,h,i),j=="resetthis"&&resetThisSession()})})}}function setValuesToCCQSessnObj(a,b,c,d,e,f,g,h,i){i=="this"?(thisSession.asid=a,thisSession.tsov=b,thisSession.tos=c,thisSession.nop=d,thisSession.clv=e,thisSession.clvpc=f,thisSession.clvp=g,thisSession.letv=h):(lastSession.asid=a,lastSession.tsov=b,lastSession.tos=c,lastSession.nop=d,lastSession.clv=e,lastSession.clvpc=f,lastSession.clvp=g,lastSession.letv=h)}function setThisSession(){SN.CrossXDataHandler.setLocalStorageItem("sn.thissessn",JSON.stringify(sessnValue),ccqSessnLifetime,function(a){})}function resetLastSession(){SN.CrossXDataHandler.setLocalStorageItem("sn.lastsessn",JSON.stringify(sessnValue),ccqSessnLifetime,function(a){})}function resetThisSession(){SN.CrossXDataHandler.setLocalStorageItem("sn.thissessn",JSON.stringify(sessnValue),ccqSessnLifetime,function(a){updateThisSession()})}function getValueForCCQSessn(a,b){return b=="this"?thisSession.getCCQSession(a,b):lastSession.getCCQSession(a,b)}function getLastsessionVal(){SN.CrossXDataHandler.getLocalStorageItem("sn.lastsessn",function(a,b){$undefinedOrNull(b)||(lastSession.asid=getStoreCustomData("asid",b),lastSession.tsov=getStoreCustomData("tsov",b),lastSession.tos=getStoreCustomData("tos",b),lastSession.nop=getStoreCustomData("nop",b),lastSession.clv=getStoreCustomData("clv",b),lastSession.clvpc=getStoreCustomData("clvpc",b),lastSession.clvp=getStoreCustomData("clvp",b),lastSession.letv=getStoreCustomData("letv",b))})}function setValueForCCQSessn(a,b,c){SN.CrossXDataHandler.getLocalStorageItem("sn."+c+"sessn",function(d,e){e=updateStoreCustomData(a,b,e),c=="this"?thisSession.setCCQSession(getStoreCustomData("asid",e),getStoreCustomData("tsov",e),getStoreCustomData("tos",e),getStoreCustomData("nop",e),getStoreCustomData("clv",e),getStoreCustomData("clvpc",e),getStoreCustomData("clvp",e),getStoreCustomData("letv",e),"this"):lastSession.setCCQSession(getStoreCustomData("asid",e),getStoreCustomData("tsov",e),getStoreCustomData("tos",e),getStoreCustomData("nop",e),getStoreCustomData("clv",e),getStoreCustomData("clvpc",e),getStoreCustomData("clvp",e),getStoreCustomData("letv",e),"last")})}function copyThisToLastSessnAndReset(){SN.CrossXDataHandler.getLocalStorageItem("sn.thissessn",function(a,b){$undefinedOrNull(b)?(resetThisSession(),resetLastSession()):(lastSession.setCCQSession(getStoreCustomData("asid",b),getStoreCustomData("tsov",b),getStoreCustomData("tos",b),getStoreCustomData("nop",b),getStoreCustomData("clv",b),getStoreCustomData("clvpc",b),getStoreCustomData("clvp",b),getStoreCustomData("letv",b),"last","resetthis"),lastSession.asid=getStoreCustomData("asid",b),lastSession.tsov=getStoreCustomData("tsov",b),lastSession.tos=getStoreCustomData("tos",b),lastSession.nop=getStoreCustomData("nop",b),lastSession.clv=getStoreCustomData("clv",b),lastSession.clvpc=getStoreCustomData("clvpc",b),lastSession.clvp=getStoreCustomData("clvp",b),lastSession.letv=getStoreCustomData("letv",b))})}function updateThisSession(){SN.CrossXDataHandler.getLocalStorageItem("sn.thissessn",function(a,b){if(!$undefinedOrNull(b)){if(thisSession.asid!==SN.GlobalSession().getActiveSessionId())var c="true";var d=(new Date).getTime();thisSession.setCCQSession(SN.GlobalSession().getActiveSessionId(),d.toString(),$timeOnSite(),$getTotalVisitCount(),String(getCartPageVisited()),String($cookieGet("CartItemCount")),cartProductItems,getCurrentPageTitle(),"this"),thisSession.asid=SN.GlobalSession().getActiveSessionId(),thisSession.tsov=d.toString(),thisSession.tos=$timeOnSite(),thisSession.nop=$getTotalVisitCount(),thisSession.clv=String(getCartPageVisited()),thisSession.clvpc=String($cookieGet("CartItemCount")),thisSession.clvp=cartProductItems,thisSession.letv=getCurrentPageTitle(),c=="true"&&addVisitToSessn()}else setThisSession()})}function initializeCCQModelVars(){initializeCTMVars(),SN.CrossXDataHandler.getLocalStorageItem("sn.thissessn",function(a,b){if(!$undefinedOrNull(b)){thisSession.asid=getStoreCustomData("asid",b),thisSession.tsov=getStoreCustomData("tsov",b),thisSession.tos=getStoreCustomData("tos",b),thisSession.nop=getStoreCustomData("nop",b),thisSession.clv=getStoreCustomData("clv",b),thisSession.clvpc=getStoreCustomData("clvpc",b),thisSession.clvp=getStoreCustomData("clvp",b),thisSession.letv=getStoreCustomData("letv",b);if(thisSession.asid!==SN.GlobalSession().getActiveSessionId())copyThisToLastSessnAndReset();else{if(isPurchased)try{var b={lpf:"Y",lpt:(new Date).getTime()};SN.CrossXDataHandler.setLocalStorageItem("sn.lastpurchase",JSON.stringify(b),ccqSessnLifetime,function(a){})}catch(c){}resetThisSession(),SN.CrossXDataHandler.getLocalStorageItem("sn.lastsessn",function(a,b){$undefinedOrNull(b)?resetLastSession():(lastSession.asid=getStoreCustomData("asid",b),lastSession.tsov=getStoreCustomData("tsov",b),lastSession.tos=getStoreCustomData("tos",b),lastSession.nop=getStoreCustomData("nop",b),lastSession.clv=getStoreCustomData("clv",b),lastSession.clvpc=getStoreCustomData("clvpc",b),lastSession.clvp=getStoreCustomData("clvp",b),lastSession.letv=getStoreCustomData("letv",b))})}}else createVisitToSessn(),resetThisSession(),SN.CrossXDataHandler.getLocalStorageItem("sn.lastsessn",function(a,b){$undefinedOrNull(b)?resetLastSession():(lastSession.asid=getStoreCustomData("asid",b),lastSession.tsov=getStoreCustomData("tsov",b),lastSession.tos=getStoreCustomData("tos",b),lastSession.nop=getStoreCustomData("nop",b),lastSession.clv=getStoreCustomData("clv",b),lastSession.clvpc=getStoreCustomData("clvpc",b),lastSession.clvp=getStoreCustomData("clvp",b),lastSession.letv=getStoreCustomData("letv",b))})})}function getPreviousSessionVars(){SN.CrossXDataHandler.getLocalStorageItem("sn.lastvisits",function(a,b){var c=JSON.parse(b);$undefinedOrNull(c)||(previousSessions.lv=c,SN.CrossXDataHandler.getLocalStorageItem("sn.lastpurchase",function(a,b){if(!$undefinedOrNull(b)){previousSessions.lpf=getStoreCustomData("lpf",b),previousSessions.lpt=getStoreCustomData("lpt",b);var c={lpf:"N",lpt:""};SN.CrossXDataHandler.setLocalStorageItem("sn.lastpurchase",JSON.stringify(c),ccqSessnLifetime,function(a){})}fireLastVisitEvent()}))})}function fireLastVisitEvent(){SN.EventManager.fire("WOWPXAPP_EVENT",{eventId:400103,fireImmediately:!0,data:{f:{v:{rcnyS:getTimeSinceLastVisit(),freqW:getLastWeekVisit(),freqM:getLastMonthVisit(),c1:getTOSLastVisit(),c2:getNOPLastVisit(),rcnyC:getCartLastVisitFlag(),c3:getCartLastVisitProductCount(),c4:getCartLastVisitProduct(),lp:isLastPurchaser(),c5:getLastExitTitle(),c28:"",c6:getTimeSinceLastPurchase()}}}})}function createVisitToSessn(){var a=[],b=(new Date).getTime();a.push(b),SN.CrossXDataHandler.setLocalStorageItem("sn.lastvisits",JSON.stringify(a),ccqSessnLifetime,function(a){});if(isPurchased)var c={lpf:"Y",lpt:(new Date).getTime()};else var c={lpf:"N",lpt:""};try{SN.CrossXDataHandler.setLocalStorageItem("sn.lastpurchase",JSON.stringify(c),ccqSessnLifetime,function(a){})}catch(d){}}function addVisitToSessn(){SN.CrossXDataHandler.getLocalStorageItem("sn.lastvisits",function(a,b){var c=JSON.parse(b);c.length==5&&c.shift();var d=(new Date).getTime();c.push(d),SN.CrossXDataHandler.setLocalStorageItem("sn.lastvisits",JSON.stringify(c),ccqSessnLifetime,function(a){}),getPreviousSessionVars()})}function getCartPageVisited(){if(!$undefinedOrNull(getValueFromCTCookie("cartFlag"))&&getValueFromCTCookie("cartFlag")!==""){var a=getValueFromCTCookie("cartFlag")||"0";return parseInt(a)}return 0}function getTimeSinceLastVisit(){var a="";return!$undefinedOrNull(thisSession.tsov)&&thisSession.tsov!=""&&!$undefinedOrNull(lastSession.tsov)&&lastSession.tsov!=""&&(a=parseInt(thisSession.tsov)-parseInt(lastSession.tsov)),a}function getTOSLastVisit(){var a="";return!$undefinedOrNull(lastSession.tos)&&lastSession.tos!=""&&(a=lastSession.tos),a}function getNOPLastVisit(){var a="";return!$undefinedOrNull(lastSession.nop)&&lastSession.nop!=""&&(a=lastSession.nop),a}function getCartLastVisitFlag(){var a="N";return!$undefinedOrNull(lastSession.clv)&&lastSession.clv!=""&&(a=lastSession.clv,a=="0"?a="N":a="Y"),a}function getCartLastVisitProductCount(){var a="";return!$undefinedOrNull(lastSession.clvpc)&&lastSession.clvpc!=""&&(a=lastSession.clvpc),a}function getCartLastVisitProduct(){var a="";return!$undefinedOrNull(lastSession.clvp)&&lastSession.clvp!=""&&(a=lastSession.clvp),a}function getLastExitTitle(){var a="";return!$undefinedOrNull(lastSession.letv)&&lastSession.letv!=""&&(a=lastSession.letv),a}function getLastWeekVisit(){var a=0,b=(new Date).getTime()-6048e5;if(!$undefinedOrNull(previousSessions.lv)&&previousSessions.lv!=""){var c=previousSessions.lv;for(var d=0,e=c.length;d<e;d++)c[d]>b&&a++;return a}}function getLastMonthVisit(){var a=0,b=(new Date).getTime()-2592e6;if(!$undefinedOrNull(previousSessions.lv)&&previousSessions.lv!=""){var c=previousSessions.lv;for(var d=0,e=c.length;d<e;d++)c[d]>b&&a++;return a}}function isLastPurchaser(){var a="N";return!$undefinedOrNull(previousSessions.lpf)&&previousSessions.lpf!=""&&(a=previousSessions.lpf),a}function getTimeSinceLastPurchase(){var a="",b=(new Date).getTime();return!$undefinedOrNull(previousSessions.lpt)&&previousSessions.lpt!=""&&(a=b-previousSessions.lpt),a}function fireStateChangeEvent(a){var b={eventId:400103,fireImmediately:!0,data:{f:SN.ConfigurationManager.getTrackableFSMVariables(100001)}};typeof b.data.f.c=="undefined"&&(b.data.f.c={}),b.data.f.c.catName=a.catName||"",b.data.f.c.parentCatName=a.parentCatName||"",b.data.f.c.uberCatName=a.uberCatName||"",b.data.f.c.catId=a.catId||"",SN.EventManager.fire("WOWPXAPP_EVENT",b);var c=parent.window.track;c&&c.catName=="Checkout - Thank You"&&SN.CustomScript.captureConversions()}function fireSchedulerStateChangeEvent(){var a=parent.window.track;if(a&&a.catName=="Thank"){if(!$undefinedOrNull(this.callOnceConfirmationCode)&&this.callOnceConfirmationCode==1)return;var b={};b.f={},b.f.u={},b.f.o={},b.f.a={},b.f.p={},b.f.v={},b.ed={},b.st=(new Date).getTime(),b.ed.intid=$getData("svdintid")||"",b.f.u.pi=a.confirmation||"",b.f.u.am="",b.f.u.on="",$undefinedOrNull($getData("svdclid"))||$getData("svdclid")===""||$undefinedOrNull($getData("svdq"))||$getData("svdq")===""?(b.f.o.ii=$getData("clid")||"",b.f.a.qu=$getData("queue")||""):(b.f.o.ii=$getData("svdclid")||"",b.f.a.qu=$getData("svdq")||""),b.f.v.hl=1,b.f.v.of=$getData("invOf")||"",b.f.v.ri=$getData("ruleId")||"";var c=$getData("svdri")||"";c!=""&&!$undefinedOrNull(c)&&(b.f.v.ri=c),b.f.v.rc=SN.CustomScript.getInviteTypeFromRuleId(b.f.v.ri),b.f.o.id="BBY_APP01_01",b.f.p.cp=parent.document.location.href,b.f.u.au=parent.guestUser!="undefined"&&parent.guestUser=="false"?"signedin":"guest",b.f.u.c29="",b.f.u.c30="";var d=$getData("conversionEvent")||"";d!=b.f.u.pi&&localStorage.getItem("previousOrder")!=b.f.u.pi&&(b.f.o.ic=getSessionInviteCount(),fireConversionEvent("11122",b),this.callOnceConfirmationCode=!0,$setData("conversionEvent",b.f.u.pi),localStorage.setItem("previousOrder",b.f.u.pi))}}function getINTSearchTerms(){var a=getReferrer(),b="";a=a.split("?");if(a[0].search(/bestbuy.com/i)!=-1&&a.length>=2){a=a[1].split("&");for(var c=0;c<a.length;c++)if(a[c].search(/^st=/i)!=-1){b=a[c].split("=");if(!(b.length>=2))return"";b=b[1];if(b!=""&&!$undefinedOrNull(b))return!0}}return""}function getEXTSearchTerms(){var a="",b=getReferrer();if(b.search(/google.co/i)!=-1||b.search(/bing.com/i)!=-1){var c=/^q=/i;a=getExtSearchPattern(b,c)}else if(b.search(/search.yahoo.com/i)!=-1){var c=/^p=/i;a=getExtSearchPattern(b,c)}return a}function getExtSearchPattern(a,b){var c="";if(!$undefinedOrNull(a)&&a!=""){a=a.split("?");if(!(a.length>=2))return"";a=a[1].split("&");for(var d=0;d<a.length;d++)if(a[d].search(b)!=-1){c=a[d].split("=");if(!(c.length>=2))return"";c=c[1];if(c!=""&&!$undefinedOrNull(c))return!0}}}function getBrowserName(){return parent.SN.UserAgentParser.isBrowser("MSIE")?"msie":parent.SN.UserAgentParser.isBrowser("Firefox")?"firefox":parent.SN.UserAgentParser.isBrowser("Chrome")?"chrome":parent.SN.UserAgentParser.isBrowser("Opera")?"opera":parent.SN.UserAgentParser.isBrowser("Version")?"safari":""}function getOSName(){return parent.SN.UserAgentParser.getOSType()}function getIfInitialReferrer(){return $getTotalVisitCount()==1?getReferrer():""}function getIfLandingPage(){return $getTotalVisitCount()==1?getCurrentPageTitle():""}function updateCTMMap(a,b,c){if($undefinedOrNull(c)||c=="")c="00000000000000000000000000";var d=c.split("");return d[b]=a,d.join("")}function initializeCTMVars(){var a="00000000000000000000000000";($undefinedOrNull(getValueFromCTCookie("ctmMap"))||getValueFromCTCookie("ctmMap")=="")&&updateCtCookie("ctmMap",a),setCTMMap()}function setCTMMap(){var a="00000000000000000000000000";$undefinedOrNull(getValueFromCTCookie("ctmMap"))||getValueFromCTCookie("ctmMap")==""?updateCtCookie("ctmMap",a):a=getValueFromCTCookie("ctmMap"),getCurrentURL_concat_Title().search(/Xbox One|Xbox 360|PlayStation 4|PlayStation 3|PS Vita|Wii U|Wii|Nintendo 3DS|Nintendo DS|OUYA|PC Gaming|Game Downloads|Video Game Trade-In|Pre-Owned & Refurbished|Video Game Accessories|Toys & Games|Call of Duty|Assassin|Battlefield|Halo|Grand Theft Auto|Xbox360|PlayStation|ESPN|Nintendo|XboxOne|finalfantasy/i)!=-1&&(a=updateCTMMap(1,0,a)),!$undefinedOrNull(getINTSearchTerms())&&getINTSearchTerms()!==""&&(a=updateCTMMap(1,1,a)),getCurrentURL_concat_Title().search(/TV|Smart TVs & Devices|Projectors & Screens|Blu-ray & DVD Players|Sound Bars|Home Theater Systems|TV & Internet Service Providers|TV Stands, Mounts & Storage|TV & Home Theater Services|TV & Home Theater Accessories|Magnolia Home Theater|TV Finder|Home Theater Learning Center|TV & Home Theater|chromecast|Blu-rayPlayer|HDTV|wallmount|hometheater|bravia|DVDplayer|TiVo|3Dglasses|projector/i)!=-1&&(a=updateCTMMap(1,2,a)),getCurrentURL_concat_Title().search(/Laptops|iPad, Tablets & E-Readers|Desktops & All-in-One Computers|Monitors|Projectors & Screens|Networking & Wireless|Hard Drives|USB Flash Drives|Computer Memory|Computer Cards & Components|Software & PC Games|Printers, Ink & Toner|Mice & Keyboards|Accessories|Tablet & iPad Learning Center|Tablet & E-Reader Setup Videos|E-Reader Learning Center|Batteries & Power|Best Buy For Business|Computer & Repair Services|computers & tablets|laptop|chromebook|ultrabook|macbook|sleekbook|notebook|harddrive|mouse|HDMonitor|ethernet|printer|router|desktop|modem|microsoftoffice|portUSB|windows7|windows8|computer|cartridge|keyboard|NVIDIA|webroot|antivirus|microSD|brother|flashdrive|intel/i)!=-1&&(a=updateCTMMap(1,3,a)),getCurrentURL_concat_Title().search(/iPod & MP3 Players|Home Audio|Speakers|Home Theater Systems|Headphones|Boomboxes, CD Players & Radios|Satellite Radio|Audio Stands & Storage|TV & Home Theater Services|Home Audio Accessories|Speaker Finder|Receiver Finder|Home Theater System Finder|Home Theater Learning Center|Magnolia Home Theater|iPod & MP3 Learning Center|Audio & MP3 Services|Audio & MP3|Bose|Music|speaker|vinyl|USBaudio|iPod|headphone|headset|earphone/i)!=-1&&(a=updateCTMMap(1,4,a)),getCurrentURL_concat_Title().search(/camera|photoframe|Lens|camcorder|Nikon|sling|tripod|powershot|Digital SLR Cameras|Compact System Cameras|Point & Shoot Cameras|Digital Camera Accessories|Camcorders|Camcorder Accessories|Camera Lenses|Memory Cards|Photo Printers|Digital Photo Frames|Binoculars, Telescopes & Optics|Webcams|Camera & Camcorders|Online Photo & Video Services|Memory Finder|Batteries & Power|Best Buy FOR  Business|DSLR Learning Center|Camcorder Learning Center|Camera & Camcorder Services/i)!=-1&&(a=updateCTMMap(1,5,a)),getCurrentURL_concat_Title().search(/GPS Navigation|Car Audio|Car Security & Remote Start|Car Video & Back-Up Cameras|Smartphone & iPod Car Connectors|Satellite Radio|Radar Detectors|Car Installation Parts|Marine Electronics|Car & GPS Installation Services|Car Electronics Learning Center|GPS Learning Center|GPS Accessories, Marine Audio Accessories, Car Video Accessories|car electronics & GPS|Vehicle|magellan|Garmin/i)!=-1&&(a=updateCTMMap(1,6,a)),getCurrentURL_concat_Title().search(/Printers, Ink & Toner|Scanners, Faxes & Copiers|Projectors & Screens|Telephones & Communication|Office Furniture & Storage|Office Electronics|Office & School Supplies|Office & Business Software|Best Buy FOR  Business/i)!=-1&&(a=updateCTMMap(1,7,a)),getCurrentURL_concat_Title().search(/Health and Fitness Technology|Exercise Equipment|Sports & Outdoor Recreation|Fan Shop|Health and Fitness Learning Center/i)!=-1&&(a=updateCTMMap(1,8,a)),getCurrentURL_concat_Title().search(/Movies & TV Shows|New Releases (DVD & Blu-ray)|Digital Movies|New Releases (Music)|iTunes Gift Cards|startrek|Blu-rayDisc|SayThatTo|Season|TheEssentials|Dinosaur|Digipak|WWE|bigbang|spiritedaway|specialedition|limitededition|soundtrack|bonus track/i)!=-1&&(a=updateCTMMap(1,9,a)),getCurrentURL_concat_Title().search(/Guitars|Folk Instruments|Amps & Effects|Keyboards|Drums & Percussion|Recording Equipment|DJ & Lighting Equipment|Microphones & Live Sound|Karaoke|Musical Instruments/i)!=-1&&(a=updateCTMMap(1,10,a)),getCurrentURL_concat_Title().search(/Furniture & Dcor|Home Automation & Control|Home Improvement & Tools|Home Security & Surveillance|Household Batteries|Luggage, Bags & Travel|Outdoor Living|Pop Culture Merchandise|Toys & Games/i)!=-1&&(a=updateCTMMap(1,11,a)),getCurrentURL_concat_Title().search(/Washers & Dryers|Refrigerators|Freezers & Ice Makers|Ranges & Ovens|Microwaves|Dishwashers|Compactors & Disposals|Small Appliances|Blenders & Juicers|Coffee Makers|Vacuum Cleaners & Floor Care|Heating, Cooling & Air Quality|Irons, Steamers & Presses|Sewing Machines|Personal Care & Beauty|Appliance Accessories|Appliance Rebate Finder|Appliance Repair & Scheduling|Appliance Parts|Appliance Delivery\/Specialty Install|ENERGY STAR Guide|Appliance Learning Center|cordlessphone|onyx|AirConditioner|Clock|calculator|bush|washer|dryer|refrigerator|tablefan|zadro|shaver|microwave|humidifier|thermal|cooler|fridge|mixer|vacuum|chefbuddy|brewer|vented/i)!=-1&&(a=updateCTMMap(1,12,a)),getCurrentURL_concat_Title().search(/mobile phone Accessories|Mobile Phones & iPhones|product_tag2 like 'mobile Accessories|OtterBox|MobilePhone|ZAGG|fosmon|pebble|Battery|mophie/i)!=-1&&(a=updateCTMMap(1,13,a)),!$undefinedOrNull(getEXTSearchTerms())&&getEXTSearchTerms()!==""&&(a=updateCTMMap(1,14,a));if(getIfInitialReferrer().search(/MAIL|GOOGLE|YAHOO|BING|DEAL|OFFER|BARGAIN|SAVER/i)!=-1){getIfInitialReferrer().search(/MAIL/i)!=-1&&(a=updateCTMMap(1,15,a)),getIfInitialReferrer().search(/GOOGLE/i)!=-1&&(a=updateCTMMap(1,16,a)),getIfInitialReferrer().search(/YAHOO/i)!=-1&&(a=updateCTMMap(1,17,a));if(getIfInitialReferrer().search(/YAHOO/i)!=-1||getIfInitialReferrer().search(/BING/i)!=-1)a=updateCTMMap(1,19,a);getIfInitialReferrer().search(/DEAL|OFFER|BARGAIN|SAVER/i)!=-1&&(a=updateCTMMap(1,20,a))}else getIfInitialReferrer().search(/BESTBUY/i)!=-1&&(a=updateCTMMap(1,18,a));getCurrentURL_concat_Title().search(/laptop|computer|Asus|Lenovo|Dell|Samsung.*laptop|Apple.*laptop|Toshiba|Macbooks|ultrabook|chromebook|netbook|desktop|all-in-one|monitors|printer|networking|hard-drive|computer-accessories/i)!=-1&&(a=updateCTMMap(1,21,a)),getCurrentURL_concat_Title().search(/tablet|ipad|galaxy-tab|iPad-Tablets-EReaders-Accessories/i)!=-1&&(a=updateCTMMap(1,22,a)),getCurrentURL_concat_Title().search(/Refrigerator|microwave|washer|heater|vacuum|frigidaire|clock|dryer|cooler|freezer|cleaner|brush|blender|juicer|mixer|brewer|shaver|grill|weather|trimmer|kettle|cellar|steamer|cooktop|grinder|carpet|fireplace|chopper|disposer|cookware|slicer|compactor|icemaker/i)!=-1&&(a=updateCTMMap(1,23,a)),getCurrentURL_concat_Title().search(/Video Games|Movies|Music|Sony-PS4|Xbox|Blu-ray disc|PlayStation|Nintendo|Wii|iPod|mp3|cameras|camcorders|digital-slr|Binoculars|Telescopes|Digital-Photo/i)!=-1&&(a=updateCTMMap(1,24,a)),getIfLandingPage().search(/CART/i)!=-1&&(a=updateCTMMap(1,25,a)),getCurrentPageTitle().search(/CART/i)!=-1?$undefinedOrNull(getValueFromCTCookie("confused"))||getValueFromCTCookie("confused")==""?updateCtCookie("confused","1"):getValueFromCTCookie("confused")=="2"&&(updateCtCookie("confused","3"),a=updateCTMMap(1,26,a)):getValueFromCTCookie("confused")=="1"&&updateCtCookie("confused","2"),updateCtCookie("ctmMap",a)}function getCTMMap(a){var b=getValueFromCTCookie("ctmMap");if(!$undefinedOrNull(b)&&b!=""){var c=b.split("");return c[a]}}function isCCQButton(){var a=location.host.indexOf("espanol")==0?"espanol":"english";return(parent.document.getElementById("px-span-checkout1-chat-now")||parent.document.getElementById("px-span-checkout2-chat-now")||parent.document.getElementById("px-span-checkout3-chat-now")||parent.document.getElementById("px-span-checkout4-chat-now"))&&a=="english"?"1":"0"}function ccqSuppression(){return getUserIsCCQHotLead()=="1"||parseInt(getValueFromCTCookie("cSessInvite")||"0",10)>=1?parseInt(getValueFromCTCookie("cSessInvite")||"0",10)<2&&getTSLI()>=240&&getCaPCCount()<4&&macSafariSuppression()==0?"0":"1":getCaPCCount()<4?"0":"1"}function isMobileQueue(){var a=getChatQueue();return a=="bestbuy-queue-mobile"||a=="bestbuy-queue-mobile-1"||a=="bestbuy-queue-mobile-2"||a=="bestbuy-queue-mobile-3"?1:0}function isRepeatVisitor(){return $isRepeatVisitor()?"Y":"N"}function lastIntraxnPoller(){return getPageIdExpression()==="bestbuy_chat_window"&&setLIInChat(),1}function setLIInChat(){var a=(new Date).getTime();updateCtCookie("li",a.toString())}function isCheckoutSuppressionPage(){return getCurrentURL().search(/pcat17010/i)!=-1?(caPCCount=5,!0):!1}function proactiveOverride(){isOverridePCOffered||(isOverridePCOffered=!0,isOverridePCDismissed=!1,triggerPCInvite())}function getProactiveOverrideFlag(){return isOverridePCOffered?1:0}function triggerPCInvite(){setUserAsHotLead();if(chatWindowId!=null&&chatWindowId.closed==0||isCheckoutSuppressionPage())return;var a=getPageDivId();if((SN.ConfigurationManager.getTargetPopulationId()==1||SN.ConfigurationManager.getTargetPopulationId()==3||SN.ConfigurationManager.getTargetPopulationId()==4||SN.ConfigurationManager.getTargetPopulationId()==5)&&pxHTMLCode[a]["queue"]=="bestbuy-queue-mobile"||(SN.ConfigurationManager.getTargetPopulationId()==1||SN.ConfigurationManager.getTargetPopulationId()==3||SN.ConfigurationManager.getTargetPopulationId()==4||SN.ConfigurationManager.getTargetPopulationId()==5)&&pxHTMLCode[a]["queue"]=="bestbuy-queue-cart")checkAvailPC=1,checkAvailability({ruleId:"proactive"});else if(SN.ConfigurationManager.getTargetPopulationId()==2&&pxHTMLCode[a]["queue"]=="bestbuy-queue-mobile"||SN.ConfigurationManager.getTargetPopulationId()==2&&pxHTMLCode[a]["queue"]=="bestbuy-queue-cart"){setLI(),caPCCount=5;var b="BBY_PR_NV";$isRepeatVisitor()&&(b="BBY_PR_RV"),$setData("svdri",b)}setLI(),incWTICount()}function triggerPQPCInvite(a){pqRule=a,setUserAsHotLead("PQ");if(chatWindowId!=null&&chatWindowId.closed==0||isCheckoutSuppressionPage())return;var b=getPageDivId();SN.ConfigurationManager.getTargetPopulationId()!=1&&SN.ConfigurationManager.getTargetPopulationId()!=3&&SN.ConfigurationManager.getTargetPopulationId()!=4&&SN.ConfigurationManager.getTargetPopulationId()!=5||pxHTMLCode[b]["queue"]!="bestbuy-queue-computing"&&pxHTMLCode[b]["queue"]!="bestbuy-queue-tablets-ereaders"&&pxHTMLCode[b]["queue"]!="bestbuy-queue-home-theater"&&pxHTMLCode[b]["queue"]!="bestbuy-queue-appliances"?SN.ConfigurationManager.getTargetPopulationId()==2&&(pxHTMLCode[b]["queue"]=="bestbuy-queue-computing"||pxHTMLCode[b]["queue"]=="bestbuy-queue-tablets-ereaders"||pxHTMLCode[b]["queue"]=="bestbuy-queue-home-theater"||pxHTMLCode[b]["queue"]=="bestbuy-queue-appliances")&&(setLI(),caPCCount=5,$setData("svdri",a)):(checkAvailPC=1,checkAvailability({ruleId:"proactive"})),setLI(),incWTICount()}function triggerCCQPCInvite(a){ccqRule=a,setUserAsHotLead("CCQ");if(chatWindowId!=null&&chatWindowId.closed==0||isCheckoutSuppressionPage())return;var b=getPageDivId();if((SN.ConfigurationManager.getTargetPopulationId()==1||SN.ConfigurationManager.getTargetPopulationId()==3||SN.ConfigurationManager.getTargetPopulationId()==4||SN.ConfigurationManager.getTargetPopulationId()==5)&&pxHTMLCode[b]["queue"]=="bestbuy-queue-mobile"||(SN.ConfigurationManager.getTargetPopulationId()==1||SN.ConfigurationManager.getTargetPopulationId()==3||SN.ConfigurationManager.getTargetPopulationId()==4||SN.ConfigurationManager.getTargetPopulationId()==5)&&pxHTMLCode[b]["queue"]=="bestbuy-queue-cart")checkAvailPC=1,checkAvailability({ruleId:"proactive"});else if(SN.ConfigurationManager.getTargetPopulationId()==2&&pxHTMLCode[b]["queue"]=="bestbuy-queue-mobile"||SN.ConfigurationManager.getTargetPopulationId()==2&&pxHTMLCode[b]["queue"]=="bestbuy-queue-cart")setLI(),caPCCount=5,$setData("svdri",a);incWTICount()}function offerProactiveChat(){incSessionInviteCount(),setLI(),isCCQButton()=="1"?setUserAsHotLead("CCQ"):isProductQueue()?setUserAsHotLead("PQ"):setUserAsHotLead(),setWidgetShown(),checkAvailPC=0,clids.proclid=randomUUID(),$setData("clid",clids.proclid),isOverridePCOffered&&!isOverridePCDismissed?pcRuleId="BBY_PR_OR1":isCCQButton()=="1"?pcRuleId=ccqRule:isProductQueue()?pcRuleId=pqRule:$isRepeatVisitor()?pcRuleId="BBY_PR_RV":pcRuleId="BBY_PR_NV";var a=parent.document.getElementById("proactiveChat"),b=parent.document.getElementsByTagName("body")[0];if($undefinedOrNull(a)){a=document.createElement("div");var c=parent.document.body.clientWidth/2,d=c-150;a.id="proactiveChat",a.innerHTML="<div id='proactive-invite' style='position:fixed;bottom:50px;left:"+d+"px;width:300px;height:210px;z-index:1000;background:url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/pc-invite-ccq.png) no-repeat 0px; -moz-box-shadow: 0 5px 10px #ccc;-webkit-box-shadow: 0 5px 10px #ccc;box-shadow: 0 5px 10px #ccc;zoom: 1;filter:progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=0,strength=1),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=45,strength=1),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=90,strength=2),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=135,strength=3),progid:DXImageTransform.Microsoft.Shadow(color=#cccccc,direction=180,strength=10),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=225,strength=3),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=270,strength=2),progid:DXImageTransform.Microsoft.Shadow(color=#dddddd,direction=315,strength=1);'><div id='cancel-proactive' style='position: relative; top: 12px; left: 278px; width: 10px; height: 10px; cursor: pointer;' title='Close Chat'></div><div id='proactive-chat-now' style='height: 35px; width: 90px;  top: 88px; left: 20px; position: relative;  cursor: pointer;' title='Chat Now'></div></div>",b.appendChild(a),isProactiveShown=!0,fireInviteEvent("11103",pcRuleId,"InviteOffered",clids.proclid),resetDockButton(),setDockButtonStatus("1"),checkAvailabilityFlag=!0;var e=setTimeout(function(){b.removeChild(a),checkAvailPC=0,unsetWidgetShown(),setLI(),isOverridePCDismissed=!0,fireInviteEvent("11106",pcRuleId,"InviteIgnored",clids.proclid),isProactiveShown=!1,setDockButtonStatus("1"),checkAvailabilityFlag=!0,checkAvailability({ruleId:"dockInvite"})},45e3),f=parent.document.getElementById("proactive-chat-now");f&&(Event.observe(f,"click",function(){clearTimeout(e),Event.stopObserving(f,"click"),unsetWidgetShown(),$setData("ruleId",pcRuleId),fireInviteEvent("11104",pcRuleId,"InviteAccepted",clids.proclid),$setData("clid",clids.proclid),launchChat(pcRuleId,clids.proclid),b.removeChild(a),checkAvailPC=0}),singleDoubleClick(f,singleDoubleClickCallback,singleDoubleClickCallback));var g=parent.document.getElementById("cancel-proactive");g&&Event.observe(g,"click",function(){clearTimeout(e),Event.stopObserving(g,"click"),unsetWidgetShown(),fireInviteEvent("11105",pcRuleId,"InviteIgnored",clids.proclid),b.removeChild(a),setLI(),isOverridePCDismissed=!0,isProactiveShown=!1,setDockButtonStatus("1"),checkAvailabilityFlag=!0,checkAvailability({ruleId:"dockInvite"})})}}function dismissProactiveChatInvite(){var a=parent.document.getElementById("proactiveChat"),b=parent.document.getElementsByTagName("body")[0];$undefinedOrNull(a)||b.removeChild(a),checkAvailPC=0}function showDockButton(a){if(isCheckoutSuppressionPage())return;var b=ruleId;checkAvailabilityFlag=!0;var c=parent.document.getElementById("dockButton"),d=parent.document.getElementsByTagName("body")[0],e=getPageDivId();$undefinedOrNull(c)&&!isProactiveShown&&(c=document.createElement("div"),c.id="dockButton",d.appendChild(c));if(!!isProactiveShown)return;e=="px-gift"?c.innerHTML=pxHTMLCode[e][a]:c.innerHTML=dockButtonState[a],a==="agent-online"&&isDockButtonOffered==0?(clids.proclid=randomUUID(),$setData("clid",clids.proclid),fireInviteEvent("11103",b,"InviteOffered",clids.proclid),isDockButtonOffered=!0):a==="agent-offline"&&isGreyButtonOffered==0&&(fireInviteEvent("400100",b,"GreyChatButton",clids.proclid),isGreyButtonOffered=!0);var f=parent.document.getElementById("dock-chat-now");f&&(Event.observe(f,"click",function(){Event.stopObserving(f,"click"),$setData("ruleId",b),fireInviteEvent("11104",b,"InviteAccepted",clids.proclid),$setData("clid",clids.proclid),launchChat(b,clids.proclid),resetDockButton()}),singleDoubleClick(f,singleDoubleClickCallback,singleDoubleClickCallback));var g=parent.document.getElementById("dock-chat-now-disabled");g&&Event.observe(g,"click",function(){fireInviteEvent("400101",b,"GreyChatButtonClicked",clids.proclid)})}function dismissDockButton(){var a=parent.document.getElementById("dockButton"),b=parent.document.getElementsByTagName("body")[0];$undefinedOrNull(a)||b.removeChild(a)}function getDockButtonStatus(){var a=getValueFromCTCookie("shwDckBtn");return $undefinedOrNull(a)||a==""?"0":a}function setDockButtonStatus(a){updateCtCookie("shwDckBtn",a)}function dockCheckAvailability(){return dockCheckAvailabilityCount<8&&checkAvailabilityFlag&&!chatInProgress&&!isProactiveShown&&(clearAgentOfflinePoller(),checkAvailability({ruleId:"dockInvite"}),dockCheckAvailabilityCount++),"0"}function resetDockButton(){dismissDockButton(),dockCheckAvailabilityCount=0,isDockButtonOffered=!1,isGreyButtonOffered==0}function getLastNavPath(){var a=parent.jQuery,b=getCurPageNavPath();return a.trim(a("#breadcrumb-list").find("li:last").text())}function getPageCategory(){var a="default";return getCurrentPageTitle().search(/No-Contract/i)>-1?a="nocontract":getCurrentPageTitle().search(/Cart/i)>-1?a="cart":getCurrentPageTitle().search(/Checkout - Payment Information|Checkout - Shipping & Pickup Options|Checkout - Billing and Contact Information|Checkout - Submit Order|Checkout - Thank You/i)>-1?a="checkout":getCurrentPageTitle().search(/BestBuy.com - Sign In/i)>-1?a="signin":getCurrentPageTitle().search(/BestBuy.com - Create An Account/i)>-1?a="account":getLastNavPath().search(/Product Info/i)>-1||getCurrentURL().search(/Samsung|Apple|HTC|Nokia|Motorola|Blackberry|LG|Google/i)>-1&&getCurrentURL().search(/AT(&|%26)T|Sprint|Virgin|T-Mobile|Verizon/i)>-1?a="productinfo":getCurrentPageTitle().search(/Mobile - Carrier Application/i)>-1||getCurrentURL().search(/^((?!(Samsung|Apple|HTC|Nokia|Motorola|Blackberry|LG|Google)).*)$/i)>-1&&getCurrentURL().search(/AT(&|%26)T|Sprint|Virgin|T-Mobile|Verizon/i)>-1?a="carrier":getCurrentPageTitle().search(/Mobile - Plan Options/i)>-1||getLastNavPath().search(/Mobile Plans/i)>-1||getLastNavPath().search(/All Mobile Phones with Plans/i)>-1?a="plans":getCurrentPageTitle().search(/Cell Phones: Smartphone, Mobile Phone - Best Buy/i)>-1?a="home":getCurrentPageTitle().search(/Best Buy Mobile: Mobile Phones, Tablets, Accessories - Best Buy/i)>-1?a="offer":getCurrentPageTitle().search(/2-yr. extension|New 2-yr. contract|Mobile Phones: Check Upgrade Eligibility - Best Buy/i)>-1?a="ols":getCurrentPageTitle().search(/BestBuy.com - Store Finder/i)>-1?a="storefinder":getCurrentPageTitle().search(/Trade-In/i)>-1?a="tradein":getCurrentPageTitle().search(/Mobile Phone Accessories: Cell Phone Accessories - Best Buy/i)>-1?a="accesssories":getCurrentPageTitle().search(/Mobile - Number Porting/i)>-1?a="numberporting":getCurrentPageTitle().search(/Learning Center/i)>-1&&(a="learningcenter"),a}function setUserHLFromRvNv(){setUserAsHotLead(),setTOS_SHL()}function setTOS_SHL(){var a=(new Date).getTime();updateCtCookie("tosShl",a.toString())}function getTOS_SHL(){var a=getValueFromCTCookie("tosShl"),b=(new Date).getTime(),c;return!$undefinedOrNull(a)&&a!=""&&a!="0"?(a=parseInt(a),c=Math.floor((b-a)/1e3)):c=0,c}function initWTICount(){$undefinedOrNull(getValueFromCTCookie("wtiCount"))&&updateCtCookie("wtiCount","0")}function incWTICount(){var a=getValueFromCTCookie("wtiCount");if($undefinedOrNull(a)||a=="")a="0";updateCtCookie("wtiCount",(parseInt(a)+1).toString())}function getWTICount(){return parseInt(getValueFromCTCookie("wtiCount")||"0",10)}function onBootstrapLoaded(){getPageIdExpression()=="bestbuyExpertService"&&expertServiceChat();if(getPageIdExpression()==="bestbuy_directchat_window"){appid="BBY_APP02_01";return}if(getPageIdExpression()=="bbfb_tagged_page"||getPageIdExpression()=="bbfb_tagged_page_gs"){appid="BBFB_APP01_01",resetCookiesOnASChange(),syncTfsOnChatFromLocalStorage(),updatePageDivId();return}getPageIdExpression()=="bestbuyServices"&&(appid="BBY_APP02_01"),resetQueueId(),setVisitedFlag(),initializeCCQModelVars(),parent.SN.MetaLayer.bindStateChangeEvent(),getCartValueFrmStore(),resetCookiesOnASChange(),initializeModelVars(),makeUserHLOverride(),syncTfsOnChatFromLocalStorage(),updatePageDivId()}function directChat(){var a="directchatgschatappjs",b="directchatgschatapp.gz.js";parent.location.href.indexOf("id=scheduler")>0?(nemoChatConfig.queue="bestbuy-Scheduler",nemoChatConfig.avqueue="bestbuy-Scheduler",a="directchatschedulerchatappjs",b="directchatschedulerchatapp.gz.js"):parent.location.href.indexOf("id=trainingApp")>0?(nemoChatConfig.queue="bestbuy-Training",nemoChatConfig.avqueue="bestbuy-Training",a="directchattrainingchatappjs",b="directchattrainingchatapp.gz.js",inviteOfferedFlag=!1):(nemoChatConfig.queue="bestbuy-Service-Queue",nemoChatConfig.avqueue="bestbuy-Service-Queue"),appid="BBY_APP02_01";var c="directchat";clids.btnclid=randomUUID(),$setData("clid",clids.btnclid),parent.location.href.indexOf("id=trainingApp")==-1&&(fireInviteEvent("11103",c,"InviteOffered",clids.btnclid),inviteOfferedFlag=!1,fireInviteEvent("11104",c,"InviteAccepted",clids.btnclid)),$setData("ruleId",c),getContextData(c,clids.btnclid);var d=parent.document.createElement("script");d.id=a,d.src="//"+SN.Conf.CDN_DOMAIN+SN.Conf.CONST_PSP_KEY+"/"+SN.Conf.CONST_PSP_VERSION+"/"+SN.Conf.CONST_CDN_VERSION+"/"+b,parent.document.getElementsByTagName("head")[0].appendChild(d)}function expertServiceChat(){appid="BBY_APP01_01",ruleId="BBY_ExpertService",caPCCount=5,clids.btnclid=randomUUID(),$setData("clid",clids.btnclid),nemoChatConfig.queue="expertService-queue",nemoChatConfig.avqueue="expertService-queue",fireInviteEvent("11103",ruleId,"InviteOffered",clids.btnclid),inviteOfferedFlag=!1,checkAvailabilityFlag=!1,$setData("ruleId",ruleId),expertServiceClickHandler()}function expertServiceClickHandler(){var a={tfsHeaderChat:"bestbuy-queue-cart",tfsOnlineAdvisor:"bestbuy-queue-cart",tfsTablets:"bestbuy-queue-tablets-ereaders",tfsHometheater:"bestbuy-queue-home-theater",tfsLaptops:"bestbuy-queue-computing",tfsCellPhones:"bestbuy-queue-mobile-3",tfsMajorAppliances:"bestbuy-queue-appliances",tfsDesktops:"bestbuy-queue-computing"};for(var b in a)if(a.hasOwnProperty(b)){var c=parent.document.getElementById(b);(function(a){$undefinedOrNull(c)||(c.addEventListener?c.addEventListener("click",function(b){launchExpertService(a),cancelEvent(b)},!1):c.attachEvent("onclick",function(b){launchExpertService(a),cancelEvent(b)}))})(a[b])}}function cancelEvent(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function launchExpertService(queueId){nemoChatConfig.queue=queueId,nemoChatConfig.avqueue=queueId,$setData("queue",queueId),chatInProgress||fireInviteEvent("11104",ruleId,"InviteAccepted",clids.btnclid),launchChat(ruleId,clids.btnclid);var bbyEvent=eval(bbyEvents["px-expertService"])}var utils=SN.Utils,SN_CONSTANTS=SN.Constants,pspCustomTrackingUtil=SN.PSPCustomTrackingUtil,cookiejar=new SN.CookieManager,LOGLVL_NONE=1e3,LOGLVL_ERROR=400,LOGLVL_INFO=200,LOGLVL_DEBUG=100,eventManager=SN.EventManager,CONST_BOOTSTRAP_COMPLETED_EVENT="bootstrapDone";eventManager.observe(CONST_BOOTSTRAP_COMPLETED_EVENT,function(){window.setTimeout(onBootstrapLoaded,10)}),eventManager.observe(SN_CONSTANTS.CONST_PERIODICAL_EXECUTION_TIMER_EVENT,syncTfsOnChatFromLocalStorage),location.host=="espanol.bestbuy.com"?document.domain="bestbuy.com":location.host=="espanol-ssl.bestbuy.com"&&(document.domain=location.host);var webpageFilter=SN.WebPageFilter,filterType=webpageFilter.filterTypeEnum.NONE,includeFilterMap={},excludeFilterMap={},includeFilterRegexList=[],excludeFilterRegexList=[];customInitialization();var tfsonChatLS="0",appid="BBY_APP01_01",isPurchased=!1,nemoChatConfig={queue:"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d",avqueue:"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d",accountId:"bestbuy-account-1",server:SN.Conf.CONST_ASSIST_VS_ROOT,caserver:SN.Conf.CONST_ASSIST_CA_ROOT},clids={clid:""},bbyEvents={"px-mobile-help":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: parent.track.page }); }","px-span-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: parent.track.page }); }","px-span-checkout1-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout'}); }","px-span-checkout2-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart'}); }","px-span-checkout5-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile'}); }","px-span-checkout6-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }","px-chat-online":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: parent.track.page }); }","px-span-checkout4-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart'}); }","px-span-checkout3-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout'}); }","px-mobile-misc":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: parent.track.page }); }","px-service-page-chat":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Service Page'}); }","px-my-account":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: My Account Page'}); }","px-product-launch":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: New Product Launch'}); }","px-appliance-1":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 1'}); }","px-appliance-2":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 2'}); }","px-computing":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Computing'}); }","px-tablets-ereaders":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: TabletsEreaders'}); }","px-home-theater":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: HomeTheater'}); }","px-appliances":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliances'}); }","px-pe-entertainment":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: PeEntertainment'}); }","px-services":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Services'}); }","px-gift":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Gift'}); }","px-scheduler":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Scheduler'}); }","px-expertService":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: ExpertService'}); }"},bbyPrechatEvents={"px-mobile-help":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Prechat', prevPage: parent.track.page }); }","px-span-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: ''Mobile Click to Chat PDP: Prechat', prevPage: parent.track.page }); }","px-span-checkout1-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Prechat'}); }","px-span-checkout2-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Prechat'}); }","px-span-checkout5-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile: Prechat'}); }","px-span-checkout6-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile: Prechat'}); }","px-chat-online":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Prechat', prevPage: parent.track.page }); }","px-span-checkout4-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Prechat'}); }","px-span-checkout3-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Prechat'}); }","px-mobile-misc":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Prechat', prevPage: parent.track.page }); }","px-service-page-chat":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Service Page :Prechat'}); }","px-my-account":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: My Account Page :Prechat'}); }","px-product-launch":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: New Product Launch :Prechat'}); }","px-appliance-1":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 1:Prechat'}); }","px-appliance-2":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 2:Prechat'}); }","px-computing":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Computing :Prechat'}); }","px-tablets-ereaders":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: TabletsEreaders :Prechat'}); }","px-home-theater":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: HomeTheater :Prechat'}); }","px-appliances":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliances :Prechat'}); }","px-pe-entertainment":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: PeEntertainment :Prechat'}); }","px-services":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Services :Prechat'}); }","px-gift":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Gift :Prechat'}); }","px-scheduler":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Scheduler :Prechat'}); }","px-expertService":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: ExpertService :Prechat'}); }"},bbyChatConnectedEvents={"px-mobile-help":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Fullchat', prevPage: parent.track.page }); }","px-span-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: ''Mobile Click to Chat PDP: Fullchat', prevPage: parent.track.page }); }","px-span-checkout1-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Fullchat'}); }","px-span-checkout2-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Fullchat'}); }","px-span-checkout5-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile: Fullchat'}); }","px-span-checkout6-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile: Fullchat'}); }","px-chat-online":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Fullchat', prevPage: parent.track.page }); }","px-span-checkout4-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Fullchat'}); }","px-span-checkout3-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Fullchat'}); }","px-mobile-misc":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Fullchat', prevPage: parent.track.page }); }","px-service-page-chat":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Service Page :Fullchat'}); }","px-my-account":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: My Account Page :Fullchat'}); }","px-product-launch":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: New Product Launch :Fullchat'}); }","px-appliance-1":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 1:Fullchat'}); }","px-appliance-2":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 2:Fullchat'}); }","px-computing":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Computing :Fullchat'}); }","px-tablets-ereaders":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: TabletsEreaders :Fullchat'}); }","px-home-theater":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: HomeTheater :Fullchat'}); }","px-appliances":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliances :Fullchat'}); }","px-pe-entertainment":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: PeEntertainment :Fullchat'}); }","px-services":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Services :Fullchat'}); }","px-gift":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Gift :Fullchat'}); }","px-scheduler":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Scheduler :Fullchat'}); }","px-expertService":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: ExpertService :Fullchat'}); }"},bbyInteractiveChatEvents={"px-mobile-help":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Interactivechat', prevPage: parent.track.page }); }","px-span-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: ''Mobile Click to Chat PDP: Interactivechat', prevPage: parent.track.page }); }","px-span-checkout1-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Interactivechat'}); }","px-span-checkout2-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Interactivechat'}); }","px-span-checkout5-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile: Interactivechat'}); }","px-span-checkout6-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile: Interactivechat'}); }","px-chat-online":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Interactivechat', prevPage: parent.track.page }); }","px-span-checkout4-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Interactivechat'}); }","px-span-checkout3-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Interactivechat'}); }","px-mobile-misc":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Interactivechat', prevPage: parent.track.page }); }","px-service-page-chat":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Service Page :Interactivechat'}); }","px-my-account":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: My Account Page :Interactivechat'}); }","px-product-launch":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: New Product Launch :Interactivechat'}); }","px-appliance-1":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 1:Interactivechat'}); }","px-appliance-2":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 2:Interactivechat'}); }","px-computing":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Computing :Interactivechat'}); }","px-tablets-ereaders":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: TabletsEreaders :Interactivechat'}); }","px-home-theater":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: HomeTheater :Interactivechat'}); }","px-appliances":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliances :Interactivechat'}); }","px-pe-entertainment":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: PeEntertainment :Interactivechat'}); }","px-services":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Services :Interactivechat'}); }","px-gift":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Gift :Interactivechat'}); }","px-scheduler":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Scheduler :Interactivechat'}); }","px-expertService":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: ExpertService :Interactivechat'}); }"},bbyFeedbackSubmitEvents={"px-mobile-help":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Postchat', prevPage: parent.track.page }); }","px-span-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: ''Mobile Click to Chat PDP: Postchat', prevPage: parent.track.page }); }","px-span-checkout1-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Postchat'}); }","px-span-checkout2-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Postchat'}); }","px-span-checkout5-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile: Postchat'}); }","px-span-checkout6-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile: Postchat'}); }","px-chat-online":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Postchat', prevPage: parent.track.page }); }","px-span-checkout4-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Postchat'}); }","px-span-checkout3-chat-now":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Postchat'}); }","px-mobile-misc":"if(parent.trackEvent) { parent.trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: parent.track.uberCatName, d_category: parent.track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Mobile Click to Chat PDP: Postchat', prevPage: parent.track.page }); }","px-service-page-chat":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Service Page :Postchat'}); }","px-my-account":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: My Account Page :Postchat'}); }","px-product-launch":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: New Product Launch :Postchat'}); }","px-appliance-1":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 1:Postchat'}); }","px-appliance-2":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliance 2:Postchat'}); }","px-computing":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Computing :Postchat'}); }","px-tablets-ereaders":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: TabletsEreaders :Postchat'}); }","px-home-theater":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: HomeTheater :Postchat'}); }","px-appliances":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Appliances :Postchat'}); }","px-pe-entertainment":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: PeEntertainment :Postchat'}); }","px-services":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Services :Postchat'}); }","px-gift":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Gift :Postchat'}); }","px-scheduler":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: Scheduler :Postchat'}); }","px-expertService":"if(parent.trackEvent) { parent.trackEvent.event('event.view',{page:'Click to Communicate: Chat: ExpertService :Postchat'}); }"},bbyHTMLCodeEs={"px-mobile-help":"<div id='px-mobile-help' class='content-box'><style type='text/css'>.moblie_help {background-image: url('//images.bestbuy.com/BestBuy_US/en_US/images/global/misc/help_mobile_v2.jpg');background-repeat:no-repeat;height:170px;}.moblie_help .help-content {position:relative;left:120px;width:180px;}.moblie_help .help-content p{padding:0;margin:0;}.moblie_help .help-content h3{font-family:Arial, Helvetica, sans-serif; font-size:14px;font-weight:bold;color:#49494A;padding-bottom:5px;}.moblie_help .help-content h4{font-family:Arial, Helvetica, sans-serif; font-size:16px;font-weight:bold; color:#49494A;padding-bottom:5px;}.moblie_help .help-content img{padding-bottom:5px;}.moblie_help .help-content small{font-family:Arial, Helvetica, sans-serif; font-size:10px;line-height:11px;color:#fff;}</style></script><div class='moblie_help'><div class='help-content'><h3>Have Mobile Questions?</h3><p>CALL US AT</p><h4>1<span style='display:none;'>-</span>-877-702-2211</h4><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/global/misc/btn_b_or_c2c.png' alt='Click to chat' title='Click to chat'></a><br><small>Mobile consultants are available 7 days a week, 8 a.m. to 2 a.m. CT.</small></div></div></div>","px-span-chat-now":"<span class='css-mt-checklist-heading-help'><!-- fl18 -->Need help?<a href='' class='css-mt-mpb-chatnow'><!-- pt40 --></a><a class='?css-mt-mpb-chatnow?' id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'>Chat now</a><br></span>","px-span-checkout1-chat-now":"<div id='px-span-checkout1-chat-now' class='cartHelpSection'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com:80/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a></div>","px-span-checkout2-chat-now":"<div id='px-span-checkout2-chat-now' class='m8content' style='display: block;'><div class='estaratop'>&nbsp;</div><div class='estarachat'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img border='0' id='click2chat' alt='Click to Chat' src='//images-ssl.bestbuy.com:443/BestBuy_US/en_US/images/global/inno/estara/mobile/checkout/mobile_bottom.gif'></a></div></div>","px-chat-online":"<div><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/pof/cat/btn_chatonline1.gif' width='79' height='16' border='0' style='margin:2px 0 5px 0;'></a></div>","px-span-checkout4-chat-now":"<div class='cartHelpSection'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/checkout.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a></div>","px-span-checkout3-chat-now":"<div class='cartHelpSection'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images-ssl.bestbuy.com:443/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a></div>","px-mobile-misc":"<div id='px-mobile-misc' class='content-box'><div class='content-main content-bordered'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2011/pof/pcon/hdr_mobile.gif' title='Mobile' alt='Mobile'><div class='cblist cbtop'><div class='cb'><h4><strong>Have a Mobile Phone Question? </strong><br>Call us at <strong>1<span style='display:none;'>-</span>-877-702-2211</strong></h4><div class='first'><p>Mobile consultants are available 7 days a week, 8 a.m. to 2 a.m. CT.</p><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'>Chat online  .</a></div><div class='second'><div class='space'><p>E-mails will be answered within 24 hours of receipt, 7 days a week.</p><a href='mailto:bbmobile@bestbuy.com'>E-mail us  .</a></div></div></div><div style='clear:both'></div></div></div></div>","px-span-checkout5-chat-now":"<a id='estara_chat_link' href='//espanol.bestbuy.com/sdimages/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//espanol.bestbuy.com/img/bestbuy/ES_263277.png' border='0' alt='Haga clic para chatear' id='click2chat'></a>","px-span-checkout6-chat-now":"<div class='estaratop'>&nbsp;</div><div class='estarachat'><a id='estara_chat_link' href='//espanol.bestbuy.com/sdimages/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img border='0' id='click2chat' alt='Haga clic para chatear' src='//espanol-ssl.bestbuy.com/img/bestbuy/ES_264491.gif'></a></div>"},bbyHTMLCode={"px-mobile-help":"<style type='text/css'>.moblie_help {background-image: url('//images.bestbuy.com/BestBuy_US/en_US/images/global/misc/help_mobile_v2.jpg');background-repeat:no-repeat;height:170px;}.moblie_help .help-content {position:relative;left:120px;width:180px;}.moblie_help .help-content p{padding:0;margin:0;}.moblie_help .help-content h3{font-family:Arial, Helvetica, sans-serif; font-size:14px;font-weight:bold;color:#49494A;padding-bottom:5px;}.moblie_help .help-content h4{font-family:Arial, Helvetica, sans-serif; font-size:16px;font-weight:bold; color:#49494A;padding-bottom:5px;}.moblie_help .help-content img{padding-bottom:5px;}.moblie_help .help-content small{font-family:Arial, Helvetica, sans-serif; font-size:10px;line-height:11px;color:#fff;}</style></script><div class='moblie_help'><div class='help-content'><h3>Have Mobile Questions?</h3><p>CALL US AT</p><h4>1<span style='display:none;'>-</span>-877-702-2211</h4><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/global/misc/btn_b_or_c2c.png' alt='Click to chat' title='Click to chat'></a><br><small>Mobile consultants are available 7 days a week, 8 a.m. to 2 a.m. CT.</small></div></div>","px-span-chat-now":"<span class='css-mt-checklist-heading-help'><!-- fl18 -->Need help?<a href='' class='css-mt-mpb-chatnow'><!-- pt40 --></a><a class='?css-mt-mpb-chatnow?' id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'>Chat now</a><br></span>","px-span-checkout1-chat-now":"<a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com:80/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a>","px-span-checkout2-chat-now":"<div class='estaratop'>&nbsp;</div><div class='estarachat'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img border='0' id='click2chat' alt='Click to Chat' src='//images-ssl.bestbuy.com:443/BestBuy_US/en_US/images/global/inno/estara/mobile/checkout/mobile_bottom.gif'></a></div>","px-chat-online":"<a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/pof/cat/btn_chatonline1.gif' width='79' height='16' border='0' style='margin:2px 0 5px 0;'></a>","px-span-checkout4-chat-now":"<a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/checkout.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a>","px-span-checkout3-chat-now":"<a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images-ssl.bestbuy.com:443/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a>","px-mobile-misc":"<div class='content-main content-bordered'><img src='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2011/pof/pcon/hdr_mobile.gif' title='Mobile' alt='Mobile'><div class='cblist cbtop'><div class='cb'><h4><strong>Have a Mobile Phone Question? </strong><br>Call us at <strong>1<span style='display:none;'>-</span>-877-702-2211</strong></h4><div class='first'><p>Mobile consultants are available 7 days a week, 8 a.m. to 2 a.m. CT.</p><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view', {page: 'Mobile Click to Chat', d_uberCat: track.uberCatName, d_category: track.d_category, templateName: 'LogMeIn Chat', clickAction: 'Click to Communicate: Chat: Mobile', prevPage: track.page }); }\" onclick='return popNew(this, 600, 600);'>Chat online  .</a></div><div class='second'><div class='space'><p>E-mails will be answered within 24 hours of receipt, 7 days a week.</p><a href='mailto:bbmobile@bestbuy.com'>E-mail us  .</a></div></div></div><div style='clear:both'></div></div></div>","px-span-checkout5-chat-now":"<!-- <a id='estara_chat_link' href=\"javascript:webISChatPop('Template=859889','webeventguiloaded=https://smetrics.bestbuy.com/b/ss/bbymainprod/5/H.20.2?AQB=1&pccr=true&g=none&pageName=Click+to+Communicate:+Chat:+Cart:+Mobile&AQE=1');\" title='Click To Chat'> --><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Cart: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img src='//images.bestbuy.com:80/BestBuy_US/en_US/images/global/inno/estara/cart/ClickToChat.png' border='0' alt='Click to Chat' id='click2chat'></a>","px-span-checkout6-chat-now":"<div class='estaratop'>&nbsp;</div><div class='estarachat'><a id='estara_chat_link' href='//images.bestbuy.com/BestBuy_US/en_US/images/abn/2008/global/cat/chat/mobile.htm' target='_blank' onmousedown=\"if(trackEvent) { trackEvent.event('event.view',{page:'Click to Communicate: Chat: Checkout: Mobile'}); }\" onclick='return popNew(this, 600, 600);'><img border='0' id='click2chat' alt='Click to Chat' src='//images-ssl.bestbuy.com:443/BestBuy_US/en_US/images/global/inno/estara/mobile/checkout/mobile_bottom.gif'></a></div>"},pxHTMLCode={"px-mobile-help":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-span-chat-now":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout1-chat-now":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout2-chat-now":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-chat-online":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout4-chat-now":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout3-chat-now":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-mobile-misc":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout5-chat-now":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout6-chat-now":{queue:"bestbuy-queue-mobile","queue-tp-1":"bestbuy-queue-mobile-3","queue-tp-2":"bestbuy-queue-mobile-3","queue-tp-3":"bestbuy-queue-mobile-3","queue-tp-4":"bestbuy-queue-mobile-3","queue-tp-5":"bestbuy-queue-mobile-3","agent-online":"","agent-offline":"","out-of-office":""},"px-service-page-chat":{queue:"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","queue-tp-1":"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","queue-tp-2":"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","queue-tp-3":"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","queue-tp-4":"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","queue-tp-5":"e93b0e25-ae60-48e3-9e1a-26e5cda49c9d","agent-online":"","agent-offline":"","out-of-office":""},"px-my-account":{queue:"bestbuy-queue-my-account","queue-tp-1":"bestbuy-queue-my-account","queue-tp-2":"bestbuy-queue-my-account","queue-tp-3":"bestbuy-queue-my-account","queue-tp-4":"bestbuy-queue-my-account","queue-tp-5":"bestbuy-queue-my-account","agent-online":"","agent-offline":"","out-of-office":""},"px-product-launch":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-appliance-1":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-appliance-2":{queue:"bestbuy-queue-cart","queue-tp-1":"bestbuy-queue-cart","queue-tp-2":"bestbuy-queue-cart","queue-tp-3":"bestbuy-queue-cart","queue-tp-4":"bestbuy-queue-cart","queue-tp-5":"bestbuy-queue-cart","agent-online":"","agent-offline":"","out-of-office":""},"px-computing":{queue:"bestbuy-queue-computing","queue-tp-1":"bestbuy-queue-computing","queue-tp-2":"bestbuy-queue-computing","queue-tp-3":"bestbuy-queue-computing","queue-tp-4":"bestbuy-queue-computing","queue-tp-5":"bestbuy-queue-computing","agent-online":"","agent-offline":"","out-of-office":""},"px-tablets-ereaders":{queue:"bestbuy-queue-tablets-ereaders","queue-tp-1":"bestbuy-queue-tablets-ereaders","queue-tp-2":"bestbuy-queue-tablets-ereaders","queue-tp-3":"bestbuy-queue-tablets-ereaders","queue-tp-4":"bestbuy-queue-tablets-ereaders","queue-tp-5":"bestbuy-queue-tablets-ereaders","agent-online":"","agent-offline":"","out-of-office":""},"px-home-theater":{queue:"bestbuy-queue-home-theater","queue-tp-1":"bestbuy-queue-home-theater","queue-tp-2":"bestbuy-queue-home-theater","queue-tp-3":"bestbuy-queue-home-theater","queue-tp-4":"bestbuy-queue-home-theater","queue-tp-5":"bestbuy-queue-home-theater","agent-online":"","agent-offline":"","out-of-office":""},"px-appliances":{queue:"bestbuy-queue-appliances","queue-tp-1":"bestbuy-queue-appliances","queue-tp-2":"bestbuy-queue-appliances","queue-tp-3":"bestbuy-queue-appliances","queue-tp-4":"bestbuy-queue-appliances","queue-tp-5":"bestbuy-queue-appliances","agent-online":"","agent-offline":"","out-of-office":""},"px-pe-entertainment":{queue:"bestbuy-queue-pe-entertainment","queue-tp-1":"bestbuy-queue-pe-entertainment","queue-tp-2":"bestbuy-queue-pe-entertainment","queue-tp-3":"bestbuy-queue-pe-entertainment","queue-tp-4":"bestbuy-queue-pe-entertainment","queue-tp-5":"bestbuy-queue-pe-entertainment","agent-online":"","agent-offline":"","out-of-office":""},"px-services":{queue:"bestbuy-Service-Queue","queue-tp-1":"bestbuy-Service-Queue","queue-tp-2":"bestbuy-Service-Queue","queue-tp-3":"bestbuy-Service-Queue","queue-tp-4":"bestbuy-Service-Queue","queue-tp-5":"bestbuy-Service-Queue","agent-online":"","agent-offline":"","out-of-office":""},"px-gift":{queue:"bestbuy-Gift-Queue","queue-tp-1":"bestbuy-Gift-Queue","queue-tp-2":"bestbuy-Gift-Queue","queue-tp-3":"bestbuy-Gift-Queue","queue-tp-4":"bestbuy-Gift-Queue","queue-tp-5":"bestbuy-Gift-Queue","agent-online":"<div id='dock-invite' style='position:fixed;bottom: "+((parent.window.innerHeight||parent.document.documentElement.clientHeight||parent.document.body.clientHeight)/2-62)+"px;right: 0px;width:65px;height:143px;float:right;z-index:1000;background:white url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/gift-available.png) no-repeat 0px;'><div id='dock-chat-now' style='height: 92px; width: 104px;  top: 51px; left: 0px; position: relative;  cursor: pointer;' title='Chat Now'></div></div>","agent-offline":"<div id='dock-invite' style='position:fixed;bottom: "+((parent.window.innerHeight||parent.document.documentElement.clientHeight||parent.document.body.clientHeight)/2-62)+"px;right: 0px;width:65px;height:143px;float:right;z-index:1000;background:white url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/gift-busy.png) no-repeat 0px;'><div id='dock-chat-now-disabled' style='height: 92px; width: 104px;  top: 51px; left: 0px; position: relative;  cursor: pointer;' title='Our chat representatives are assisting other customers. Please try again later or call 1-888-BEST BUY (1-888-237-8289).'></div></div>","out-of-office":""},"px-scheduler":{queue:"bestbuy-Scheduler","queue-tp-1":"bestbuy-Scheduler","queue-tp-2":"bestbuy-Scheduler","queue-tp-3":"bestbuy-Scheduler","queue-tp-4":"bestbuy-Scheduler","queue-tp-5":"bestbuy-Scheduler","agent-online":"<div id='px-scheduler-main' style='width:210px;height:30px;background:url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/scheduler-available.png) no-repeat 20px;'>"+" <div id='px-scheduler-chat-now' title='Chat Now' style='width:190px;height:30px;float: left;cursor:pointer;'></div></div>","agent-offline":"<div id='px-scheduler-main' style='width:210px;height:30px;background:url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/scheduler-busy.png) no-repeat 20px;'>"+" <div id='px-scheduler-chat-now-disabled' title='All our chat representatives are currently helping other customers. Please try chat again later. We apologize for the inconvenience' style='width:190px;height:30px;float: left;cursor:pointer;'></div></div>","out-of-office":"<div id='px-scheduler-main' style='width:210px;height:30px;background:url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/scheduler-busy.png) no-repeat 20px;'>"+" <div id='px-scheduler-chat-now-disabled' title='Our chat program is currently closed. Chat is available 7 days a week, 8 a.m. ET to 12 a.m. ET. Please try chat during our open hours' style='width:190px;height:30px;float: left;cursor:pointer;'></div></div>"},"px-button-chat":{queue:"bestbuy-BBFB-Sales-queue","queue-tp-1":"bestbuy-BBFB-Sales-queue","queue-tp-2":"bestbuy-BBFB-Sales-queue","queue-tp-3":"bestbuy-BBFB-Sales-queue","queue-tp-4":"bestbuy-BBFB-Sales-queue","queue-tp-5":"bestbuy-BBFB-Sales-queue","agent-online":"Chat <div style='position: absolute; top: 6px; left: 38px;'><img src='//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/bbfbchatapp/img/available.png'></div>","agent-offline":"","out-of-office":"",cssProperties:{borderLeft:"0px",borderRight:"1px solid #878177",margin:"0px 10px 0px 0px",padding:"0 22px 0px 0",color:"#91D7EA",fontWeight:"bold",cursor:"pointer"}},"px-button-chat-gs":{queue:"bestbuy-BBFB-Sales-queue","queue-tp-1":"bestbuy-BBFB-Sales-queue","queue-tp-2":"bestbuy-BBFB-Sales-queue","queue-tp-3":"bestbuy-BBFB-Sales-queue","queue-tp-4":"bestbuy-BBFB-Sales-queue","queue-tp-5":"bestbuy-BBFB-Sales-queue","agent-online":"Chat <div style='position: relative;display: inline;top: 3px;'><img src='//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/bbfbgschatapp/img/available.png'></div>","agent-offline":"","out-of-office":"",cssProperties:{marginTop:"14px",cursor:"pointer",width:"70px"}}},pxHTMLCodeEs={"px-mobile-help":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-chat-now":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout1-chat-now":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout2-chat-now":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-chat-online":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout4-chat-now":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout3-chat-now":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-mobile-misc":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout5-chat-now":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-span-checkout6-chat-now":{queue:"bestbuy-queue-mobile-spanish","queue-tp-1":"bestbuy-queue-mobile-spanish","queue-tp-2":"bestbuy-queue-mobile-spanish","queue-tp-3":"bestbuy-queue-mobile-spanish","queue-tp-4":"bestbuy-queue-mobile-spanish","queue-tp-5":"bestbuy-queue-mobile-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-service-page-chat":{queue:"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","queue-tp-1":"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","queue-tp-2":"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","queue-tp-3":"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","queue-tp-4":"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","queue-tp-5":"75bf33c8-c5c4-4740-a7b6-cc47f28cacb6","agent-online":"","agent-offline":"","out-of-office":""},"px-my-account":{queue:"bestbuy-queue-my-account-spanish","queue-tp-1":"bestbuy-queue-my-account-spanish","queue-tp-2":"bestbuy-queue-my-account-spanish","queue-tp-3":"bestbuy-queue-my-account-spanish","queue-tp-4":"bestbuy-queue-my-account-spanish","queue-tp-5":"bestbuy-queue-my-account-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-product-launch":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-appliance-1":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""},"px-appliance-2":{queue:"bestbuy-queue-cart-spanish","queue-tp-1":"bestbuy-queue-cart-spanish","queue-tp-2":"bestbuy-queue-cart-spanish","queue-tp-3":"bestbuy-queue-cart-spanish","queue-tp-4":"bestbuy-queue-cart-spanish","queue-tp-5":"bestbuy-queue-cart-spanish","agent-online":"","agent-offline":"","out-of-office":""}},chatWindowId,preChatFlag=0,chatConnectFlag=0,feedBackFlag=0,inviteOfferedFlag=!0,agentOfflineFlag=!0,checkAvailabilityFlag=!1,agentAvailableBBFB=!0,isBBFBPageFlag=!1,pollerCounter=0,pollerInterval=5e3,divPoller,numPolls=0,ln,value=[],phase="3",ruleId,checkAvailPC,caPCCount=0,pcRuleId="BBY_PR_NV",productRemoved="",rewardCertificate="",promotionalCode="";Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1),b=new Date(this.getFullYear(),6,1);return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var widgetShown=0,ccqSessnLifetime=31536e6,previousSessions={lv:"",lpf:"",lpt:""},lastSession=new ccqSession,thisSession=new ccqSession,sessnValue={asid:"",tsov:"",tos:"",nop:"",clv:"",clvpc:"",clvp:"",letv:""},cartProductItems,isOverridePCOffered=!1,isOverridePCDismissed=!0,pqRule="",ccqRule="",isProactiveShown=!1,dockButtonState={"agent-online":"<div id='dock-invite' style='position:fixed;top:50%;margin-top:-62px;right: 0px;width:44px;height:124px;float:right;z-index:1000;background:white url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/dock-available.png) no-repeat 0px;'><div id='dock-chat-now' style='height: 124px; width: 44px;  top: 0px; left: 0px; position: relative;  cursor: pointer;' title='Chat Now'></div></div>","agent-offline":"<div id='dock-invite' style='position:fixed;top:50%;margin-top:-62px;right: 0px;width:44px;height:124px;float:right;z-index:1000;background:white url(//"+SN.Conf.CDN_DOMAIN+"bestbuy/"+SN.Conf.CONST_CDN_VERSION+"/chatapp/img/dock-busy.png) no-repeat 0px;'><div id='dock-chat-now-disabled' style='height: 124px; width: 44px;  top: 0px; left: 0px; position: relative;  cursor: pointer;' title='Our chat representatives are assisting other customers. Please try again later or call 1-888-BEST BUY (1-888-237-8289).'></div></div>"},isDockButtonOffered=!1,isGreyButtonOffered=!1,dockRuleFired=!1,singleDoubleClick=function(a,b,c,d){var e=0,f=a;a.addEventListener?a.addEventListener("click",function(a){e++,e==1&&setTimeout(function(){e==1?b.call(f,a):c.call(f,a),e=0},d||300)},!1):a.attachEvent("onclick",function(a){e++,e==1&&setTimeout(function(){e==1?single_click_callback.call(f,a):double_click_callback.call(f,a),e=0},d||300)})},singleDoubleClickCallback=function(){var divIds=value[value.length-1],bbyEvent=eval(bbyEvents[divIds])},dockCheckAvailabilityCount=0,chatInProgress=!1,me={renderInitcall:renderInitcall,getContextData:getContextData,checkAvailability:checkAvailability,agentAvailabilityCallback:agentAvailabilityCallback,setQueueId:setQueueId,getChatQueue:getChatQueue,getUrlId:getUrlId,getEncodedValue:getEncodedValue,getDecodedValue:getDecodedValue,insertHtmlCode:insertHtmlCode,generateActionUrl:generateActionUrl,setVisitedFlag:setVisitedFlag,captureConversions:captureConversions,getShippingCharge:getShippingCharge,getDeliveryOption:getDeliveryOption,getIfProductRemovedCart:getIfProductRemovedCart,getRewardCertificate:getRewardCertificate,getPromotionalCode:getPromotionalCode,getSKUNumber:getSKUNumber,getCartValueFrmStore:getCartValueFrmStore,chatConfigDecider:chatConfigDecider,getInviteTypeFromRuleId:getInviteTypeFromRuleId,objectifyCookie:objectifyCookie,stringifyCookieObj:stringifyCookieObj,isMobileQueue:isMobileQueue,isRepeatVisitor:isRepeatVisitor,getScoreBitMap:getScoreBitMap,getHOD:getHOD,proactiveOverride:proactiveOverride,getProactiveOverrideFlag:getProactiveOverrideFlag,triggerPCInvite:triggerPCInvite,triggerCCQPCInvite:triggerCCQPCInvite,triggerPQPCInvite:triggerPQPCInvite,getCaPCCount:getCaPCCount,lastIntraxnPoller:lastIntraxnPoller,getTSLI:getTSLI,getUserIsHotLead:getUserIsHotLead,getUserIsCCQHotLead:getUserIsCCQHotLead,getSessionInviteCount:getSessionInviteCount,ccqSuppression:ccqSuppression,pqSuppression:pqSuppression,getDockButtonStatus:getDockButtonStatus,dockCheckAvailability:dockCheckAvailability,getValueForCCQSessn:getValueForCCQSessn,setValueForCCQSessn:setValueForCCQSessn,getCTMMap:getCTMMap,getOSName:getOSName,getBrowserName:getBrowserName,isCCQButton:isCCQButton,getPageCategory:getPageCategory,setUserHLFromRvNv:setUserHLFromRvNv,getTOS_SHL:getTOS_SHL,getWTICount:getWTICount,getVCCount:getVCCount,getProductName:getProductName,getProductModel:getProductModel,getProductSKU:getProductSKU,getProductRating:getProductRating,getProductPrice:getProductPrice,getCurPageNavPath:getCurPageNavPath,getIfInitialReferrer:getIfInitialReferrer,getProductReview:getProductReview,directChat:directChat,mpqSuppression:mpqSuppression,fireStateChangeEvent:fireStateChangeEvent,fireSchedulerStateChangeEvent:fireSchedulerStateChangeEvent,isIPBlocked:isIPBlocked};return me}(),typeof SN.Custom=="undefined"&&(SN.Custom={}),SN.Custom.getGlobalHotSpots=function(){},SN=SN||{},SN.Session=function(a){function d(a){if($undefinedOrNull(a))throw"Invalid key: "+a;return a}function e(e,f){return $undefined(f)?b.warn("Ignored key(",e,") value(",f,"), call was to set in session with id:(",a,")"):c.set(d(e),JSON.stringify(f)),f}function f(e){var f=c.remove(d(e));return $undefined(f)?(b.warn("SN.SessionManager: Removed key(",e,") from session with id:(",a,")"),f):(b.debug("SN.SessionManager: Removed key(",e,") value(",f,") from session with id:(",a+")"),JSON.parse(f))}function g(a){var b=c.get(d(a));return!$undefinedOrNull(b)&&b.isJSON()?JSON.parse(b):b}function h(){return a}function i(){c.clear()}var b=SN.Utils,c=SN.Store.getStore(a),j={set:e,remove:f,get:g,getSessionId:h,destroy:i};return j};var SN=SN||{};SN.SessionUtils=function(){function createWindowId(){return CONST_PSP_WINDOW+(new Date).getTime()}function assembleUrlParams(urlParams,original){var result=original||{},sessionManager=SN.SessionManager,globalSession=sessionManager.getGlobalSession();if(globalSession!=null){result.vi=globalSession.getVisitorId();var visitorGroup=globalSession.getVisitorGroup();$undefinedOrNull(visitorGroup)||(result.vg=visitorGroup);var targetId=globalSession.getTargetId();$undefinedOrNull(targetId)||(result.ti=targetId);var targetPopulationId=globalSession.getTargetPopulationId(),tpId=$cookieGet("sn.tp");$undefinedOrNull(tpId)||(targetPopulationId=tpId),$undefinedOrNull(targetPopulationId)||(result.tp=targetPopulationId);var tpRandomNumber=globalSession.getTPRandomNumber();$undefinedOrNull(tpRandomNumber)||(result.rt=tpRandomNumber);var vgRandomNumber=globalSession.getVGRandomNumber();$undefinedOrNull(vgRandomNumber)||(result.rv=vgRandomNumber),result.v=parent.SN.Conf.CONST_PSP_VERSION}if($undefinedOrNull(urlParams))return result;for(var i=0;i<urlParams.length;i++){var param=urlParams[i];try{var value=encodeURIComponent(eval(param.expr));!$undefinedOrNull(value)&&!$isEmpty(value)&&(result[encodeURIComponent(param.key)]=value)}catch(err){utils.error("Failed to evaluate expression: "+param.expr,err)}}return result}var CONST_PSP_WINDOW="wid",utils=SN.Utils,me={createWindowId:createWindowId,assembleUrlParams:assembleUrlParams};return me}(),SN=SN||{},SN.GlobalSession=function(){function w(){return o}function x(){return p}function y(){return q}function z(){return r}function A(){var a=c.getWindowName();if($undefinedOrNull(a)||$isEmpty(a))a=d.createWindowId(),c.setWindowName(a)}function B(){parent.SN.Conf.viStore=="cookie"?v=new SN.CookieManager:v=new SN.LocalStorageWrapper,o=v.getValueFromStore(a.SN_VI_STORE_NAME,e),p=b.getValueFromStore(a.SN_AS_STORE_NAME,g),$undefinedOrNull(p)||(q=b.getValueFromStore(a.SN_AS_STORE_NAME,h),r=b.getValueFromStore(a.SN_AS_STORE_NAME,i)),j=b.getValueFromStore(a.SN_RN_STORE_NAME,a.TP_RANDOM_NUMBER),k=b.getValueFromStore(a.SN_RN_STORE_NAME,a.VG_RANDOM_NUMBER),l=b.getValueFromStore(a.SN_VI_STORE_NAME,a.ACTIVE_SESSION),A()}function C(){m=c.getStoreLifetime(a.SN_VI_STORE_NAME)}function D(d,f,u,v,w,x,y,z,A){var B=!1;s=y,t=z*1e3,m<t&&(t=m,s=m),c.setStoreLifetime(a.SN_AS_STORE_NAME,s),c.setStoreLifetime(a.SN_RN_STORE_NAME,t),o=d;var C=b.isActiveSessionPresent(),D=b.getValueFromStore(a.SN_VI_STORE_NAME,a.PREVIOUS_ACTIVE_SESSION_TIME),H=(new Date).getTime();b.setValueInStore(a.SN_VI_STORE_NAME,e,o),$undefinedOrNull(k)&&(b.setValueInStore(a.SN_RN_STORE_NAME,a.VG_RANDOM_NUMBER,w,t),k=w),$undefinedOrNull(j)&&(b.setValueInStore(a.SN_RN_STORE_NAME,a.TP_RANDOM_NUMBER,x,t),j=x);var I=(new Date).getTime();n=I,C||($undefinedOrNull(l)&&(l=0),D=b.getValueFromStore(a.SN_VI_STORE_NAME,a.CURRENT_ACTIVE_SESSION_TIME),$undefinedOrNull(D)||b.setValueInStore(a.SN_VI_STORE_NAME,a.PREVIOUS_ACTIVE_SESSION_TIME,D),l=parseInt(l)+1,b.setValueInStore(a.SN_VI_STORE_NAME,a.ACTIVE_SESSION,l),b.setValueInStore(a.SN_VI_STORE_NAME,a.ACTIVE_SESSION_START_TIME,I),G(),E()),parent.SN.Conf.dataStore!="server"&&b.setValueInStore(a.SN_VI_STORE_NAME,a.CURRENT_ACTIVE_SESSION_TIME,H);if($undefinedOrNull(p)||$undefinedOrNull(r)||$undefinedOrNull(q))B=!0;if(p!=f||r!=u)B=!0;B&&(b.setValueInStore(a.SN_AS_STORE_NAME,g,f),b.setValueInStore(a.SN_AS_STORE_NAME,i,u),b.setValueInStore(a.SN_AS_STORE_NAME,h,v),p=f,r=u,q=v),G(),b.setValueInStore(a.SN_RN_STORE_NAME,a.VG_RANDOM_NUMBER,w,t),F()}function E(){c.info("SN.GlobalSession: firing tracking events for eventId - ",a.SESSION_START_EVENT_ID);var b={eventId:a.SESSION_START_EVENT_ID,sessionStartEvent:!0,previousActivesession:$getPreviousActiveSessionStartTime(),data:{f:{v:{geo:{loc:[$geoLongitude(),$geoLatitude()],co:$geoCountry(),cc:$geoCountryCode(),ci:$geoCity(),wr:$geoRegion(),isp:$geoIsp(),ip:$geoIPAddress(),org:$geoOrganization(),zip:$geoPostalCode()}}}}};$undefinedOrNull(b.data.f.v)&&(b.data.f.v={}),$undefinedOrNull(b.data.f.v.geo)&&(b.data.f.v.geo={}),parent.SN.Conf.browserGeoLocationFlag?(b.data.f.v.geo.lt="b",$getGeoBrowserLocationError().length!=2?b.data.f.v.geo.loc=[parseFloat($getGeoLongitudeBrowser()),parseFloat($getGeoLatitudeBrowser())]:(b.data.f.v.geo.le=$getGeoBrowserLocationError(),b.data.f.v.geo.lt="s",b.data.f.v.geo.loc=[parseFloat($geoLongitude()),parseFloat($geoLatitude())])):(b.data.f.v.geo.lt="s",b.data.f.v.geo.loc=[parseFloat($geoLongitude()),parseFloat($geoLatitude())]),u.fire(a.SESSION_START_EVENT,b),c.debugTrack("fired:"+a.SESSION_START_EVENT_ID)}function F(){var c=b.getValueFromStore(a.SN_VI_STORE_NAME,a.PAGE_LOAD_COUNTER);$undefinedOrNull(c)&&(c=0),c=parseInt(c)+1,b.setValueInStore(a.SN_VI_STORE_NAME,a.PAGE_LOAD_COUNTER,c)}function G(){b.createASStore()}function H(){return j}function I(){return k}function J(){return SN.StoreManager.getValueFromStore(a.SN_VI_STORE_NAME,a.ACTIVE_SESSION)}function K(){return(new Date).getTime()-n}var a=SN.Constants,b=SN.StoreManager,c=SN.Utils,d=SN.SessionUtils,e="vi",f="as",g="vg",h="ti",i="tp",j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=null,r=null,s=null,t=null,u=SN.EventManager,v=null,L={load:C,updateVisitorInfo:D,initialize:B,getVisitorId:w,getVisitorGroup:x,getTargetId:y,getTargetPopulationId:z,getTPRandomNumber:H,getVGRandomNumber:I,getActiveSessionId:J,keepAliveActiveSession:G,getTimeOnPage:K};return B(),L},SN=SN||{},SN.SessionManager=function(){function onControllerInit(){var a=configStore.isActionPage();a&&parent.focus()}function initializeOnLoad(){if(sessionManagerInitialized)return;globalSession=new SN.GlobalSession,xdsession=new SN.Session(CONST_XDSESSION_ID),sessionManagerInitialized=!0}function load(){globalSession.load()}function getVisitorSession(){return{}}function getXDSession(){return xdsession}function getGlobalSession(){return globalSession}function doGetFSMVariable(a){var b=null,c=a.scope;return c==SCOPE_RUNTIME?b=configStore.getRuntimeFSMVarValue(a.key):b=storeManager.getValueFromStore(SN_CONSTANTS.SN_VARIABLE_STORE_NAME,a.key),b}function doUpdateFSMVariable(update){var value=null,strategy=update.strategy,scope=update.scope,doEval=strategy==STRATEGY_EVALUATE_ONCE&&updatedVarMap[update.key]!=CONST_UPDATED||strategy==STRATEGY_POLL;if(doEval)try{value=eval(update.expr),strategy==STRATEGY_EVALUATE_ONCE&&update.rollingcount==0&&(update.value=value),updatedVarMap[update.key]=CONST_UPDATED}catch(err){value=null,utils.error("Failed to evaluate expr: ",update.expr,err)}else strategy==STRATEGY_CONSTANT?value=update.expr:value=update.value;return scope==SCOPE_RUNTIME?($undefinedOrNull(value)&&(value=configStore.getRuntimeFSMVarValue(update.key)),configStore.setRuntimeFSMVarValue(update.key,value),value):(update.rollingcount>0&&doEval&&(value=doUpdateRollingFSMVariable(update,value)),$undefinedOrNull(value)||(scope=="a"?(oldValue=storeManager.getValueFromStore(SN_CONSTANTS.SN_AS_STORE_NAME,update.key),oldValue!=value&&(value=storeManager.setValueInStore(SN_CONSTANTS.SN_AS_STORE_NAME,update.key,value),parent.SN.Conf.dataStore=="server"&&eventManager.fire(SN_CONSTANTS.UPDATE_SN_AS_EVENT,null))):value=storeManager.setValueInStore(SN_CONSTANTS.SN_VARIABLE_STORE_NAME,update.key,value)),value)}function doUpdateRollingFSMVariable(a,b){var c=null;return a.scope=="a"?(c=storeManager.getValueFromStore(SN_CONSTANTS.SN_AS_STORE_NAME,a.key),parent.SN.Conf.dataStore=="server"&&eventManager.fire(SN_CONSTANTS.UPDATE_SN_AS_EVENT,null)):c=storeManager.getValueFromStore(SN_CONSTANTS.SN_VARIABLE_STORE_NAME,a.key),$undefinedOrNull(c)?c=[]:parent.SN.Conf.dataStore=="localstorage"&&(c=JSON.parse(c)),c.push(b),c.length>a.rollingcount&&c.shift(),parent.SN.Conf.dataStore=="localstorage"?JSON.stringify(c):c}var SN_CONSTANTS=SN.Constants,CONST_XDSESSION_ID="xdsession",storeManager=SN.StoreManager,STRATEGY_EVALUATE_ONCE="o",STRATEGY_POLL="p",STRATEGY_CONSTANT="c",SCOPE_RUNTIME="r",CONST_UPDATED=!0,globalSession=null,xdsession=null,updatedVarMap={},sessionManagerInitialized=!1,utils=SN.Utils,configStore=SN.ConfigurationManager,eventManager=SN.EventManager,me={onControllerInit:onControllerInit,load:load,getVisitorSession:getVisitorSession,getGlobalSession:getGlobalSession,getXDSession:getXDSession,doUpdateFSMVariable:doUpdateFSMVariable,doGetFSMVariable:doGetFSMVariable};return initializeOnLoad(),me}(),$undefined(SN)&&(SN={}),SN.WebTracker=function(){function l(){f=!1,j=parent.document.referrer.split("/")[2],u()}function m(a){var b=i.getValueFromStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k);return $undefinedOrNull(b)?!1:b.indexOf(a+SN.Constants.CONST_URL_SEPARATOR)==0?!0:b.indexOf(SN.Constants.CONST_URL_SEPARATOR+a+SN.Constants.CONST_URL_SEPARATOR)!=-1?!0:!1}function n(b){var d=0,e=i.getValueFromStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k);if($undefinedOrNull(e))return 0;b=c.removeDuplicates(b.split(a)).join(a);if(e.indexOf(a)==-1)if(b.indexOf(a)==-1)e==b&&(d=1);else{var f="#"+b.split(a).join("#|#")+"#";d=f.split("#"+e+"#").length-1}else{var g="#"+e.split(a).join("#|#")+"#",f=b.split(a);for(var h=0;h<f.length;h++)d+=g.split("#"+f[h]+"#").length-1}return d}function o(){var b=i.getValueFromStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k);if($undefinedOrNull(b))return 0;if(b.indexOf(a)==-1)return 1;var c=b.split(a);return c.length}function p(){return typeof j=="undefined"||j==null||j==""?!1:!0}function q(){if(p()){for(var a=0;a<d.length;a++)if(j.indexOf(d[a])!=-1)return!0;return!1}return!1}function r(){var b=i.getValueFromStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k),c=parent.SN.Conf.getUrlId();if($undefinedOrNull(b))b=c;else{b=b+a+c;var d=b.split(a);d!=null&&d.length>20&&(b=b.substring(b.indexOf(a)+1))}i.setValueInStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k,b)}function s(){return i.getValueFromStore(SN.Constants.SN_WEBTRACKER_STORE_NAME,k)}function t(a){f=!0,SN.Conf.dataStore!="server"&&r()}function u(){g.observe(b,t)}var a="|",b="bootstrapDone",c=SN.Utils,d=["google","yahoo","bing","aol","ask"],e=(new Date).getTime(),f=!1,g=SN.EventManager,h=SN.CustomScript,i=SN.StoreManager,j="",k="u",v={getPageVisitUrlSequence:s,isSiteReferrerASearchEngine:q,isSiteVisitedFromAReferrer:p,getTotalVisitCount:o,getVisitCount:n,hasVisited:m};return l(),v}(),$timeOnPage=function(){var a=SN.SessionManager.getGlobalSession();return Math.floor(a.getTimeOnPage()/1e3)},$isSiteVisitedFromAReferrer=function(){return SN.WebTracker.isSiteVisitedFromAReferrer()},$isSiteReferrerASearchEngine=function(){return SN.WebTracker.isSiteReferrerASearchEngine()},$getPageVisitUrlSequence=function(){return SN.WebTracker.getPageVisitUrlSequence()},$hasVisited=function(a){return SN.WebTracker.hasVisited(a)},$visitCount=function(a){return SN.WebTracker.getVisitCount(a)},$getTotalVisitCount=function(){return SN.WebTracker.getTotalVisitCount()},$previousPageId=function(){var a=$getPageVisitUrlSequence();if($undefinedOrNull(a))return null;var b=a.split(SN.Constants.CONST_URL_SEPARATOR);return b.length>1?b[b.length-2]:null},$allPagesVisited=function(a){var b=$getPageVisitUrlSequence();if($undefinedOrNull(b))return!1;var c=a.split(SN.Constants.CONST_URL_SEPARATOR),d=0;for(d=0;d<c.length;d++)if(b.indexOf(c[d])==-1)return!1;return!0},$AnyPagesVisited=function(a){var b=$getPageVisitUrlSequence();if($undefinedOrNull(b))return!1;var c=a.split(SN.Constants.CONST_URL_SEPARATOR),d=0;for(d=0;d<c.length;d++)if(b.indexOf(c[d])!=-1)return!0;return!1},$pageStrictSeqVisited=function(a){var b=$getPageVisitUrlSequence();return $undefinedOrNull(b)?!1:b==null?!1:b.indexOf(a)!=-1},$pageLooseSeqVisited=function(a){var b=$getPageVisitUrlSequence();if($undefinedOrNull(b))return!1;var c=a.split(SN.Constants.CONST_URL_SEPARATOR),d=b,e=0,f=0,g=0;for(e=0;e<c.length;e++){d=d.substring(g);var h=c[e];if(d.indexOf(h)==-1)return!1;if(d.indexOf(h+SN.Constants.CONST_URL_SEPARATOR)==0)f++;else if(d.indexOf(SN.Constants.CONST_URL_SEPARATOR+h+SN.Constants.CONST_URL_SEPARATOR)!=-1)f++;else if(d.indexOf(h)!=-1){var i=b.split(SN.Constants.CONST_URL_SEPARATOR);i[i.length-1]==h&&f++;break}g=d.indexOf(h+SN.Constants.CONST_URL_SEPARATOR)+h.length+1}return f==c.length?!0:!1},$getSpecificPagesVisitCount=function(a,b){var c=$getPageVisitUrlSequence();return $undefinedOrNull(c)||$undefinedOrNull(a)?0:a(c,b)?$visitCount(b):0},typeof SN=="undefined"&&(SN={}),SN.XDStorageHandler=function(){function j(d){$undefinedOrNull(d)&&a.error("cookieData is undefined: check the object");if($undefinedOrNull(localStorage)){a.error("Local Storage is not supported");return}for(var e in d){var f=d[e].cvalue;if(!$undefinedOrNull(f)){var g=(new Date).getTime(),h="",i=d[e].clifetime;i+=g,h=f+c.LOCALSTORAGE_VALUE_SEPARATOR+i;var j=b+c.LOCALSTORAGE_KEY_SEPARATOR+e;localStorage.setItem(j,h)}}}function k(){var a=[c.SN_VI_STORE_NAME,c.SN_WEBTRACKER_STORE_NAME,c.SN_RN_STORE_NAME,c.SN_VARIABLE_STORE_NAME],d={},e="";for(var f=0;f<a.length;f++){e=b+c.LOCALSTORAGE_KEY_SEPARATOR+a[f],console.warn(localStorage);if(e in localStorage){var g=(new Date).getTime();d[a[f]]={};var h=localStorage.getItem(e);if(!$undefinedOrNull(h)){d[a[f]].cvalue=h.split(c.LOCALSTORAGE_VALUE_SEPARATOR)[0];var i=h.split(c.LOCALSTORAGE_VALUE_SEPARATOR)[1],j=i-g;d[a[f]].clifetime=j}}}return d}function l(){var a={};cookieData=k();for(var d in cookieData){var e=cookieData[d].clifetime;if(e<0){var f=b+c.LOCALSTORAGE_KEY_SEPARATOR+d;localStorage.removeItem(f);if(d==c.SN_VI_STORE_NAME){for(var g in cookieData)f=b+LOCALSTORAGE_KEY_SEPARATOR+g,localStorage.removeItem(f);break}}}}function m(){g=setInterval(l,e)}function n(){var a=document.location.href,c=a.split("#"),d=c[1].split("&"),e="clientkey";for(var f=0;f<d.length;f++){var g=d[f].split("=");if(g[0]==e){b=g[1];return}}}function o(){document.domain==d&&(n(),m())}var a=SN.Utils,b=null,c=SN.Constants,d=parent.SN.Conf.CONST_PSP_ROOT,e=1e4,f=3e4,g=null,h=!0,i=null,p={storeData:j,retrieveData:k,checkCookieLifetime:l,initialize:o};return o(),p}(),$undefined(SN)&&(SN={}),SN.XD={},SN.XD.XDCommand=Class.create({initialize:function(a,b){this.name=a,this.params=b},getCommand:function(){return this.name},getParamObj:function(){return this.params}}),SN.XD.Sender=Class.create({_TIMEOUT:10,CONST_XD_UPDATE_SESSION:"updatesession",CONST_XD_SAVE_STATE:"savestate",CONST_XD_BOOTSTRAP:"bootstrap",CONST_XD_WIDGET_CMD:"widgetcmd",WIDGET_ACTION:"action",WIDGET_NAME:"name",CONST_XD_SAVE_VAR:"savevar",CONST_XD_REDIRECT:"redirect",CONST_XD_RULE_EVENT:"ruleevent",initialize:function(a){this._proxyUrl=a,this._commands=[],this._ready=!0,this.processCommands();var b=this},processCommands:function(){var a=this._TIMEOUT/5;if(this._commands.length!=0&&this._ready){var b=this._commands.shift();this.createReqIFrame(b.getCommand(),b.getParamObj()),a=2*this._TIMEOUT}var c=this;window.setTimeout(function(){c.processCommands()},a)},sendUpdateSessionReq:function(a){this._commands.push(new SN.XD.XDCommand(this.CONST_XD_UPDATE_SESSION,a))},sendSaveStateReq:function(a){if($undefined(a))throw"new state cannot be empty";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_SAVE_STATE,a))},sendBootstrapReq:function(a){if($undefined(a))throw"bootstrapConfig cannot be empty";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_BOOTSTRAP,a))},sendWidgetReq:function(a,b){if($undefined(b))throw"widget name cannot be empty";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_WIDGET_CMD,{action:a,name:b}))},sendSaveVarReq:function(a){if(!$isArray(a)||a.size()===0)throw"not an array of (key, value) pairs";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_SAVE_VAR,a))},sendRedirectReq:function(a){if($undefined(a))throw"url cannot be empty";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_REDIRECT,a))},sendRulesEngineReq:function(a){if($undefined(a))throw"parameters cannot be empty";this._commands.push(new SN.XD.XDCommand(this.CONST_XD_RULE_EVENT,a))},sendXDRequest:function(a,b){if($undefined(a))throw"command cannot be empty";this._commands.push(new SN.XD.XDCommand(a,b))},makeAServerCall:function(a,b){if($undefined(a))throw"command cannot be empty";this._commands.push(new SN.XD.XDCommand("serverCall",b))},createReqIFrame:function(a,b){if($undefined(a))throw"No command defined";var c=new Element("iframe");c.hide();var d=this;c.observe("load",function(){Event.stopObserving(c),window.setTimeout(function(){d._ready=!0,c.remove()},2e3)});var e=this._proxyUrl+"#cmd="+a;$undefined(b)||(e+="&params="+JSON.stringify(b)),c.src=e,document.body.appendChild(c)}}),SN.XD.Proxy=function(){function p(a){var b=null,c=location.hash;c=c.replace(e,"");var d=c.split("&");for(var f=0;f<d.length;f++){var g=d[f].split("=");if(g[0]==a){b=g[1];break}}return b}function s(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:null;for(var b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(c){SN.Utils.error("exception while trying to get new activeXobject  : ",c)}}function t(a,b){if(a==c){v(b);return}if(a==m.SEND_SERVER_DATA)return;a==m.SET_XD_DATA?o.storeData(b):SN.Utils.info("SN.XD.runProxy:Nothing to do")}function u(){var a=SN.Utils,b=a.readParam("cmd"),c=a.readParam("params");t(b,c)}function v(a){var b=new s;b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200||window.location.href.indexOf(k)==-1){var a="cmd="+j;a=a+"&params="+b.responseText;try{window.setTimeout(function(){SN.XDFrameMessagingUtils.postMessage(a,r,parent)},5)}catch(c){SN.Utils.error("errorWhileMakingPostMessage call to XD Iframe",c)}}else SN.Utils.error("SN.XD : An error has occured making the request")};var c=a,d="",e=!0;for(var f in c)e?(e=!1,d=f+"="+c[f]):d=d+"&"+f+"="+c[f];b.open(l,q,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(d)}function w(a){var b=new s;b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200||window.location.href.indexOf(k)==-1){var a="cmd="+j;a=a+"&params="+b.responseText;try{window.setTimeout(function(){SN.XDFrameMessagingUtils.postMessage(a,r,parent)},5)}catch(c){SN.Utils.error("errorWhileMakingPostMessage call to XD Iframe",c)}}else SN.Utils.error("SN.XD : An error has occured making the request")};var c=a,d="",e=!0;for(var f in c)e?(e=!1,d=f+"="+c[f]):d=d+"&"+f+"="+c[f];b.open(l,i,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(d)}function x(){try{if($undefinedOrNull(p("n")))return;var a={};a.loaded=p("caller"),o.checkCookieLifetime(),a.data=o.retrieveData();var b="cmd="+m.IFRAME_LOADED+"&params="+JSON.stringify(a);SN.XDFrameMessagingUtils.postMessage(b,r,parent)}catch(c){SN.Utils.error("Error while notifying load event to parent:"+c),SN.Utils.errorTrack("Error while notifying load event to parent:"+c)}}function y(){try{n=p(m.PSP_VERSION_KEY),q=location.protocol+f+p(a)+"/"+n+g,i=location.protocol+f+p(a)+"/"+n+h}catch(b){SN.Utils.error("Error while initializing pspVersion and PSP_RUN_CALL:"+b)}}function z(){SN.XDFrameMessagingUtils.receiveMessage(function(a){var b="",c="";try{var d=a.data,e=d.split("&");for(var f=0;f<e.length;f++)e[f].indexOf("cmd")==0&&(b=e[f].replace("cmd=","")),e[f].indexOf("params")==0&&(c=e[f].replace("params=",""));c=c.evalJSON()}catch(g){SN.Utils.error("Badly formed JSON, the request is not meant for this listener","error: ",g)}t(b,c)},r)}var a="clientkey",b="parentdomain",c="serverCall",d="sendSeverData",e="#",f="//"+parent.SN.Conf.CONST_PSP_ROOT+"/psp/",g="/run",h="/v0/setdatatoserver/",i=null,j="serverResponse",k="http",l="POST",m=SN.Constants,n=null,o=SN.XDStorageHandler,q=null,r=p(b),A={runProxy:u};return y(),x(),A}(),$undefined(SN)&&(SN={}),SN.WindowLifecycleManager=function(){function g(){if(f)return;f=!0}function h(b,f,g){if($undefinedOrNull(b)){var h="Invalid Input: URL is  undefined or null";throw h}f[e.PSP_STATIC_SERVER_ID]=c.getPSPStaticRoot(),d.setValueInStore("sn.t","t",JSON.stringify(f)),b+="&",b+=e.PSP_STATIC_SERVER_ID,b+="=",b+=encodeURIComponent(c.getPSPStaticRoot()),a.info("SN.WindowLifecycleManager: Opening a new window with url = "+b),window.open(b,"pxoewindow",g||"width=570,height=395,scrollbars=0")}var a=SN.Utils,b=SN.SessionUtils,c=SN.ConfigurationManager,d=SN.StoreManager,e=SN.Constants,f=!1,i={init:g,openNewWindow:h};return i}(),function(a){"use strict";var b=function(a){var b=Array.prototype.forEach,c=Array.prototype.map;this.each=function(a,c,d){if(a===null)return;if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(c.call(d,a[e],e,a)==={})return}else for(var g in a)if(a.hasOwnProperty(g)&&c.call(d,a[g],g,a)==={})return},this.map=function(a,b,d){var e=[];return a==null?e:c&&a.map===c?a.map(b,d):(this.each(a,function(a,c,f){e[e.length]=b.call(d,a,c,f)}),e)},typeof a=="object"?(this.hasher=a.hasher,this.canvas=a.canvas):typeof a=="function"&&(this.hasher=a)};b.prototype={get:function(){var b=[];b.push(navigator.userAgent),b.push(navigator.language),b.push(screen.colorDepth),b.push((new Date).getTimezoneOffset()),b.push(!!a.sessionStorage),b.push(this.hasLocalStorage()),b.push(!!window.indexedDB),b.push(typeof document.body.addBehavior),b.push(typeof window.openDatabase),b.push(navigator.cpuClass),b.push(navigator.platform),b.push(navigator.doNotTrack);var c=this.map(navigator.plugins,function(a){var b=this.map(a,function(a){return[a.type,a.suffixes].join("~")}).join(",");return[a.name,a.description,b].join("::")},this).join(";");return b.push(c),this.canvas&&this.isCanvasSupported()&&b.push(this.getCanvasFingerprint()),this.hasher?this.hasher(b.join("###"),31):this.murmurhash3_32_gc(b.join("###"),31)},murmurhash3_32_gc:function(a,b){var c,d,e,f,g,h,i,j;c=a.length&3,d=a.length-c,e=b,g=3432918353,h=461845907,j=0;while(j<d)i=a.charCodeAt(j)&255|(a.charCodeAt(++j)&255)<<8|(a.charCodeAt(++j)&255)<<16|(a.charCodeAt(++j)&255)<<24,++j,i=(i&65535)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(i&65535)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i,e=e<<13|e>>>19,f=(e&65535)*5+(((e>>>16)*5&65535)<<16)&4294967295,e=(f&65535)+27492+(((f>>>16)+58964&65535)<<16);i=0;switch(c){case 3:i^=(a.charCodeAt(j+2)&255)<<16;case 2:i^=(a.charCodeAt(j+1)&255)<<8;case 1:i^=a.charCodeAt(j)&255,i=(i&65535)*g+(((i>>>16)*g&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(i&65535)*h+(((i>>>16)*h&65535)<<16)&4294967295,e^=i}return e^=a.length,e^=e>>>16,e=(e&65535)*2246822507+(((e>>>16)*2246822507&65535)<<16)&4294967295,e^=e>>>13,e=(e&65535)*3266489909+(((e>>>16)*3266489909&65535)<<16)&4294967295,e^=e>>>16,e>>>0},hasLocalStorage:function(){try{return!!a.localStorage}catch(b){return!0}},isCanvasSupported:function(){var a=document.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},getCanvasFingerprint:function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c="http://valve.github.io";return b.textBaseline="top",b.font="14px 'Arial'",b.textBaseline="alphabetic",b.fillStyle="#f60",b.fillRect(125,1,62,20),b.fillStyle="#069",b.fillText(c,2,15),b.fillStyle="rgba(102, 204, 0, 0.7)",b.fillText(c,4,17),a.toDataURL()}},a.Fingerprint=b}(window),$undefined(SN)&&(SN={}),SN.Controller=function(){function L(){t.debug("doing clearDomStateRetry: ",(new Date).getTime()),I!=null&&(clearInterval(I),I=null)}function M(a){O(),I=setInterval(function(){N()},a)}function N(){var b=parent.document.readyState;if(b!=F&&E<D){E++,t.info("Retrying for doc ready,docReadyStatus : "+b+", retryCount:"+E);return}L(),SN.Utils.setDomready(!0),v.fire(a.DOMLOADED,{fireImmediately:!0,data:{}}),t.debug("dom is ready: ",(new Date).getTime()),SN.CustomScript.renderInitcall(J)}function O(){t.debug("doing clearRetry: ",(new Date).getTime()),z!=null&&(clearTimeout(z),z=null)}function P(a){O(),retryTimout=setTimeout(function(){S()},a)}function Q(){t.info("SN.Controller:Clearing the psp load timer"),y!=null&&(clearTimeout(y),y=null)}function R(a){try{a!=null&&($(a).remove(),a=null)}catch(b){t.error("Couldn't remove script id : "+a,b)}}function S(){try{if(k){t.info("SN.Controller::service next ready, clearing retry timer"),O();return}if(A>=a.BOOTSRTAP_RETRY_INTERVALS.length){O();return}A++;if(i&&!j){t.infoTrack("inDoRetry:bootstrapRecvd="+j+",retryAttemptCount="+A);var b=s.getGlobalSession();b.initialize(),T(),P(a.BOOTSRTAP_RETRY_INTERVALS[A])}else j?k||(t.infoTrack("inDoRetry:bootstrapRecvd="+j+",bootstrapCompleted="+k+",retryAttemptCount="+A),ab()):t.warn("No retry conditions satisfied, should not be here!!")}catch(c){t.error("exception in doRetry : ",c),t.errorTrack("errorIndoRetry",c)}}function T(){if(t.isCrossDomainSupported()&&r.isXDChannelReady()&&r.isMigrationDone()){var b=s.getGlobalSession();b.initialize()}var c=r.getPageId();if($undefinedOrNull(c)){t.info("SN.Controller: Configuration error, pageId is undefined."),t.info("SN.Controller: Firing a psptrackingupdate event"),t.errorTrack("errorInPageIdUndefined"),v.fireException(null,"pageId is undefined");return}var d=r.getPSPKey(),e=r.getPSPRoot(),f=parent.SN.Conf.CONST_PSP_VERSION,g={};g=u.assembleUrlParams(r.getHotSpots(c),g);var h=r.isBootstrapCachingOn();if($undefinedOrNull(h)||h==0)g[a.PARAM_UUIT]=(new Date).getTime();g[a.ACTIVE_SESSION_START_TIME]=(new Date).getTime(),g[a.PARAM_KEY_ACC_KEY]=d,g[a.PARAM_KEY_PAGEID]=c,g[a.PARAM_KEY_CDN_VERSION]=parent.SN.Conf.CONST_CDN_VERSION,r.isActionPage()&&(g[a.PARAM_ACTION_CONTEXT]=r.getActionContext()),g[a.PARAM_KEY_VI_MAINTAINANCE]=parent.SN.Conf.shouldMaintainVi,g[a.PARAM_KEY_DATA_STORE]=parent.SN.Conf.dataStore,g[a.PARAM_KEY_UNIQUE_TIMESTAMP]=parent.SN.Tracker.getUniquePageId(),g[a.PARAM_KEY_URL_ID]=parent.SN.Conf.getUrlId(),g[a.FINGER_PRINT_ID]=(new Fingerprint).get(),g[a.BROWSER_DETAILS]=encodeURIComponent(navigator.userAgent),r.setBootstrapParams(g);var i=t.appendUrlParams(e+"/"+d+"/"+f+a.BOOTSTRAP_CONTEXT,g);t.info("SN.Controller:bootstrap request url: ",i);var j=a.BOOTSTRAP_ID_PREFIX+(new Date).getTime();t.loadJs(i,j),B=j,t.info(new Date,": SN.Controller: Made bootstrap call: id = ",j),t.info("SN.Controller:bootstrap call made at : ",(new Date).getTime())}function U(a){if(g)return;g=!0,h=(new Date).getTime(),B=null;try{r.saveInitConfiguration(a)}catch(b){throw O(),t.info("SN.Controller: Firing a psptrackingupdate event"),v.fireException(null,"pageId evaluation failed."),t.errorTrack("InvalidConfigurationErrorInInitialize,",b),"Invalid configuration: ("+b+")"+a[r.INIT_JS_PAGE_ID]}X()}function V(){n=window.setInterval(function(){++o;if(r.isXDChannelReady()||o>a.MAX_XD_RETRY_COUNT)W(),T(),P(a.BOOTSRTAP_RETRY_INTERVALS[A])},a.XD_RETRY_INTERVAL)}function W(){$undefinedOrNull(n)||clearInterval(n)}function X(){try{t.info(new Date,": SN.Controller: initializing on focus"),s.load(),i=!0,r.isXDChannelReady()||!t.isCrossDomainSupported()?(T(),P(a.BOOTSRTAP_RETRY_INTERVALS[A])):V()}catch(b){O(),W(),t.info("Exception occured in SN.Controller.initializeOnlyWhenInFocus:,",b),t.errorTrack("errorInInitializeOnlyWhenInFocus",b)}}function Y(b,c){t.info("SN.Controller:bootstrap response: ",b);if(j)return;j=!0,B=null;if(b.code==a.BOOTSTRAP_VISITOR_GROUP_NOT_FOUND){t.errorTrack("VisitorGroupNotFound:"+b.code),O();return}if(b.code==a.BOOTSTRAP_TARGET_ERROR_CODE){t.errorTrack("OutOfTargetGeo:"+b.code),O();return}if($undefinedOrNull(b.bsdata)){t.errorTrack("bootstrap configuration is undefined"),O();return}try{r.saveBootstrapConfiguration(b),w.saveBootstrapData(b)}catch(d){throw t.info("SN.Controller: Firing a psptrackingupdate event"),t.errorTrack("errorInSaveBootstrapConfiguration",d),O(),"Invalid bootstrap configuration: ("+d+")"}v.fire(a.BOOTSTRAP_RECEIVED_EVENT,{data:{psi:c}});var e=r.getRuleGroupId(),f=r.shouldStartRE();!$undefinedOrNull(b.bsdata)&&!$undefinedOrNull(b.bsdata.newState)&&(K=b.bsdata.newState.state),f&&!$undefinedOrNull(e)&&e!=""&&(t.info("SN.Controller:GetRules response: ",b),r.saveGetRulesConfiguration(b)),Q(),ab(c)}function Z(b,c){t.info("SN.Controller:stateChange response: ",b),!$undefinedOrNull(b.bsdata)&&!$undefinedOrNull(b.bsdata.newState)&&(K=b.bsdata.newState.state);try{r.saveBootstrapConfiguration(b)}catch(d){throw t.info("SN.Controller: Firing a psptrackingupdate event"),v.fireException(null,"Invalid statechange configuration."),t.errorTrack("doStateChangeUpdate:InvalidConfigurationException",d),"Invalid bootstrap configuration: ("+d+")"}var e=s.getGlobalSession(),f=r.getVisitorId();e.updateVisitorInfo(f,r.getVisitorGroup(),r.getTargetPopulationId(),r.getTargetId(),r.getVGRandomNumber(),r.getTPRandomNumber(),r.getActiveSessionLifeTime(),r.getRandomNoLifeTime(),r.getSamplingStorage()),t.info("SN.Controller: Updated visitor and visitor session info"),bb();var g={},h={};h.newState=K,h.newVid=f;var i=r.getBootstrapParams();$undefinedOrNull(i)||(h.ed=i),g.data=h,g.eventId=a.STATE_CHANGE_COMPLETED_EVENT,v.fire(a.STATE_CHANGE_COMPLETED_EVENT,g),t.info("SN.Controller: Fired state change event"),cb(c)}function _(){v.fire(a.BOOTSTRAP_UPDATE_COMPLETED_EVENT,{eventId:a.BOOTSTRAP_UPDATE_COMPLETED_EVENT})}function ab(b){if(k)return;var c=s.getGlobalSession();t.info("SN.Controller : Session creation start time : ",(new Date).getTime());var d=r.getVisitorId(),e=r.getVisitorGroup(),f=r.getTargetPopulationId(),g=r.getTargetId();t.info("SN.Controller: ####### doBootstrapUpdates: updating visitor Info with newVisitorId:",d,", visGroup:",e,"targetPopulationId:",f,"targetId:",g),c.updateVisitorInfo(d,e,f,g,r.getVGRandomNumber(),r.getTPRandomNumber(),r.getActiveSessionLifeTime(),r.getRandomNoLifeTime(),r.getSamplingStorage());var h={},i={};i.newState=K,i.newVid=d;var j=r.getBootstrapParams();$undefinedOrNull(j)||(i.ed=j),h.data=i,h.eventId=a.BOOTSTRAP_COMPLETED_EVENT,v.fire(a.BOOTSTRAP_COMPLETED_EVENT,h),k=!0,t.info(new Date,": SN.Controller: bootstrap update completed. firing onload events next"),bb(),db(),cb(b),hb(),t.isCrossDomainSupported()&&_(),t.debugTrack("bootstrapUpdatesLoaded")}function bb(){var b=r.getFSMUpdateVariables();if($undefinedOrNull(b)){t.info("There are no update variables defined for this page");return}for(var c=0;c<b.length;c++){var d=b[c];try{var e=s.doUpdateFSMVariable(d);r.updateMappedRuleVariables(d,e)}catch(f){t.error("SN.Controller: error occurred while evaluating/updating mapped rule variables using update :",d,f)}}v.fire(a.UPDATE_FSMVARIABLES_EVENT,{eventId:a.UPDATE_FSMVARIABLES_EVENT})}function cb(b){var c=r.getOnLoadEvent();$undefinedOrNull(c)||(t.info("SN.Controller: firing on load event: ",c),v.fire(a.PAGE_TRIGGER,{eventId:a.PAGE_TRIGGER,data:{psi:b,ruleId:c}}))}function db(){var b=SN.ExitHistory?SN.ExitHistory.getLastExitLink():null,c=null;t.info("SN.Controller: firing tracking events for eventId - ",a.PAGE_EVENT_VISIT_TO_TAGGED_PAGE);var d={eventId:a.PAGE_EVENT_VISIT_TO_TAGGED_PAGE,data:{f:r.getTrackableFSMVariables(a.PAGE_EVENT_VISIT_TO_TAGGED_PAGE)},sr:"PAGE_LOAD",x:!1};$undefinedOrNull(SN.CustomScript.getDecodedValue)||(c=SN.CustomScript.getDecodedValue(b),$undefinedOrNull(c)||(d.data.ed={},d.data.ed.el=c)),$undefinedOrNull(d.data.f.v)&&(d.data.f.v={}),$undefinedOrNull(d.data.f.v.geo)&&(d.data.f.v.geo={}),parent.SN.Conf.browserGeoLocationFlag?(d.data.f.v.geo.lt="b",$getGeoBrowserLocationError().length!=2?d.data.f.v.geo.loc=[parseFloat($getGeoLongitudeBrowser()),parseFloat($getGeoLatitudeBrowser())]:(d.data.f.v.geo.le=$getGeoBrowserLocationError(),d.data.f.v.geo.lt="s",d.data.f.v.geo.loc=[parseFloat($geoLongitude()),parseFloat($geoLatitude())])):(d.data.f.v.geo.lt="s",d.data.f.v.geo.loc=[parseFloat($geoLongitude()),parseFloat($geoLatitude())]),v.fire(a.VISITOR_EVENT,d),t.debugTrack("fired:"+a.PAGE_EVENT_VISIT_TO_TAGGED_PAGE)}function eb(b,c,d,e){t.debugTrack("processRuleTrigger: ruleFired:"+b);var f=r.getPageId(),g=r.getRuleConfig(b);if($undefinedOrNull(g)){v.fire(a.VISITOR_EVENT,{eventId:a.PAGE_EVENT_RULE_TRIGGER_DROPPED,data:{psi:d,ssi:c,ed:{pageid:f,reason:"ruleConfig is undefined or null",ruleId:b}},sr:"RULE_TRIGGERED",x:!0}),t.errorTrack("ruleConfigIsNotDefinedForRule:"+b);return}var h=e;$undefinedOrNull(h)&&(h={}),h.psi=d,h[a.SOURCE_SEQUENCE_ID]=c,h.ruleId=b,t.info("SN.Controller: processing (",b,")");var i=r.getHandlerConfig(b),j=r.getEventhandlerConfig(i),k=j.handlerType;if($undefinedOrNull(k)||p[k]!=1){v.fire(a.EXCEPTION_EVENT,{eventId:a.RULE_TRIGGERED_EXCEPTION_EVENT,data:{psi:d,ssi:c,ed:{pageid:f,reason:"handlerConfig is either not defined or invalid"}},sr:"RULE_TRIGGERED",x:!0}),t.errorTrack("ruleHandlerIsInvalidForRule:"+b);return}h.handlerType=k;var l={};l.data=e,$undefinedOrNull(l.data.f)&&(l.data.f={}),$undefinedOrNull(l.data.f.v)&&(l.data.f.v={}),$undefinedOrNull(l.data.f.a)&&(l.data.f.a={}),$undefinedOrNull(l.data.f.p)&&(l.data.f.p={}),l.data.f.v.rc=SN.CustomScript.getInviteTypeFromRuleId(b),l.data.f.a.qu=SN.CustomScript.getChatQueue(),l.data.f.p.cp=parent.document.location.href,l.data.f.v.ri=h.ruleId,l.data.f.v.rn=h.ruleId,l.eventId=G,v.fire(H,l),k==a.EVENT_HANDLER_JS?(t.info("SN.Controller: Firing a custom js handler event for rule ",b),v.fire(a.PAGE_ACTION_EVENT,{eventId:a.EVENT_HANDLER_JS,data:h})):(t.info("SN.Controller: Firing a show UI event for rule ",b),v.fire(a.PAGE_ACTION_EVENT,{eventId:a.SHOW_UI,data:h}))}function fb(){bb(),v.fire(a.PERIODICAL_EXECUTION_TIMER_EVENT,{data:{iterationId:++d}}),l=(new Date).getTime()}function gb(){c!=null&&(clearInterval(c),c=null)}function hb(){gb();var a=r.getPollingInterval();fb(),c=setInterval(function(){fb()},a*1e3)}function ib(){x.init()}function jb(a,b){try{m=b,r.setPSPKey(a),f=parent.SN.Conf.CONST_PSP_VERSION,r.setPSPVersion(f),r.setPSPStaticRoot(b);if(C==1){t.warn("SN.Controller.doInit: controller already started");return}t.info(new Date,": SN.Controller: SN loaded, starting initialization procedure"),t.infoTrack("inDoInit"),C=!0,s.onControllerInit(),ib(),J=a,M(200)}catch(c){t.error("Exception in SN.Controller.doInit(),",c),t.errorTrack("errorInDoInit",c)}}function kb(){return e||{location:{},isp:{}}}function mb(a){a.indexOf("http://")==0?top.location.href=a:top.location.href=t.getContext(top.location.href)+"/"+a}function nb(b){var c=b.memo,d=c.eventId,e=c.data,f=c.s;if(d==a.PAGE_EVENT_INITIALIZE)U(e);else if(d==a.PAGE_EVENT_BOOTSTRAP)Y(e,f);else if(d==a.PAGE_EVENT_STATE_CHANGE_UPDATE)Z(e,f);else if(d==a.RULES_TRIGGERED&&SN.CustomScript.isIPBlocked()=="0"){var g=c.data.ruleId,h=e.ssi;eb(g,h,f,e)}}function ob(){v.observe(a.PAGE_TRIGGER,function(b){var c=b.memo.data,d=c.ruleId,e=r.getTrackableFSMVariables(a.PAGE_TRIGGER,d),f=c.ssi,g=b.memo.s;v.fire(a.PAGE_EVENT,{eventId:a.RULES_TRIGGERED,sr:a.PAGE_TRIGGER,data:{psi:g,ssi:f,ruleId:d,f:e}})}),v.observe(a.CUSTOM_RULE_TRIGGER_EVENT,function(b){var c=b.memo.data,d=c.ruleId,e=r.getTrackableFSMVariables(a.CUSTOM_RULE_TRIGGERED,d),f=c.ssi,g=b.memo.s;v.fire(a.PAGE_EVENT,{eventId:a.RULES_TRIGGERED,sr:a.CUSTOM_RULE_TRIGGER_EVENT,data:{psi:g,ssi:f,ruleId:d,f:e}})}),v.observe(a.PAGE_EVENT,nb)}var a=SN.Constants,b="bsid",c=null,d=0,e=null,f=null,g=!1,h=-1,i=!1,j=!1,k=!1,l=-1,m=null,n=null,o=0,p={};p[a.EVENT_HANDLER_CHAT]=!0,p[a.EVENT_HANDLER_CHAT_INVITE]=!0,p[a.EVENT_HANDLER_PP]=!0,p[a.EVENT_HANDLER_VIDEO]=!0,p[a.EVENT_HANDLER_JS]=!0,p[a.EVENT_HANDLER_SHOW_CHAT_WINDOW]=!0,p[a.EVENT_HANDLER_SCC]=!0,p[a.EVENT_HANDLER_WOWPX]=!0,p[a.EVENT_HANDLER_ADP]=!0;var q=SN.WebTracker,r=SN.ConfigurationManager,s=SN.SessionManager,t=SN.Utils,u=SN.SessionUtils,v=SN.EventManager,w=SN.StoreManager,x=SN.WindowLifecycleManager,y=null,z=null,A=0,B=null,C=!1,D=15,E=0,F="complete",G=11e4,H="RULE_ENGINE_EVENT",I=null,J=null,K="",lb={start:hb,doInit:jb,getGeoInfo:kb};return ob(),window.setTimeout(function(){gb()},SN.Constants.POLLER_TIMEOUT),lb}(),typeof SN=="undefined"&&(SN={}),SN.DecisionMaker=function(){function e(){var e=parent.location.hostname+parent.location.pathname;SN.WebPageFilter.shouldServeURL(e)?a.doInit(c,d):b.info("This url is filtered out : "+e)}var a=SN.Controller,b=SN.Utils,c=b.getClientKey(),d=b.getPSPCDNRoot();e()}(),$undefinedOrNull(SN)&&(SN={}),SN.JSEventController=function(){var SN_CONSTANTS=SN.Constants,utils=SN.Utils,eventManager=SN.EventManager,configStore=SN.ConfigurationManager;eventManager.observe(SN_CONSTANTS.PAGE_ACTION_EVENT,function(event){var eventContext=event.memo,eventId=eventContext.eventId,ruleId=eventContext.data[SN_CONSTANTS.RULE_ID];if(eventId!=SN_CONSTANTS.EVENT_HANDLER_JS)return;try{var ruleConfig=configStore.getRuleConfig(ruleId);if($undefinedOrNull(ruleConfig)){utils.error("SN.JSEventController: ruleConfig is null, returning..without being able to process the custom JS..");return}eval(ruleConfig.js),utils.debug("SN.JSEventController: Sucessfully executed custom javascript for rule: ",ruleId)}catch(err){utils.errorTrack("SN.JSEventControllerJSExecutionFailedForRule:"+ruleId,err)}})}(),$undefined(SN)&&(SN={}),SN.Executer=function(){function u(a){if(!v(a)){var c="invalid input, invalid senderObject";throw c}var b=a.getName();k[b]=a,f.info("SN.Executer:senderName- ",b," registered as a Data Sender")}function v(a){return a.getName&&a.getRequestDataCallback&&a.putResponseDataCallback&&!$undefinedOrNull(a.getName())&&a.getName().length>0}function w(){var a="rr-"+q;return q++,a}function x(a,b,c){f.info("SN.Executer: runRules call post params = ",b),lastPostCallTs=(new Date).getTime(),p!=null&&(clearTimeout(p),p=null,f.warn("SN.Execuer: runRulesTimeoutTimer was not null just before making the runRules call, could be a potential issue!")),p=window.setTimeout(y,o),l=!0,n=!1,m=c,r=!1,s=[],h.makeXDRequest(a,b,function(a){var b=null,c=a.data.split("&");for(var g=0;g<c.length;g++)if(c[g].indexOf("params")==0){b=c[g].replace("params=","");break}if(b==null){f.warn("SN.Executer: null Response received from server");return}var h=b.evalJSON(),j=h.s,k=h.response;if(j==0){var l=h.code,m=h.category;f.error("SN.Executer: Error Response received from server with (errorCode, Category) = (",l,", ",m,"); Msg: ",a)}else i.fire(d,{data:{cmd:e,params:k}})}),f.infoTrack("makeRunRulesCallLoaded")}function y(){l&&(f.warn("SN.Executer:RunRules timed out, setting runRulesGoingOn to false "),C(),D())}function z(a,b){for(var c in b)a[c]=b[c]}function A(d){var e=s,g=j.getPSPRoot(),h=j.getPSPKey(),i=j.getPSPVersion();if($undefinedOrNull(g)||$undefinedOrNull(h)){var l="pspRoot ("+g+") or pspKey ("+h+") not available";throw f.error(l),l}var m={};m[b]=h;var n=w();m[c]=n;var o=!1;if(d)for(var p in k){var q=k[p],r=q.getRequestDataCallback();$undefinedOrNull(r)||(f.info("SN.Executor: received sender data from sender name - "+p),z(m,r),t.push(p),o=!0)}else while(e.length>0){var p=e.pop(),q=k[p],r=q.getRequestDataCallback();$undefinedOrNull(r)||(f.info("SN.Executor: received sender data from sender name - "+p),z(m,r),t.push(p),o=!0)}o&&x(g+"/"+h+"/"+i+a,m,n)}function B(a){f.info("SN.Executer: runRules response ",a);while(t.length>0){var b=t.pop(),c=k[b];$undefinedOrNull(c)||c.putResponseDataCallback(a)}C(),D()}function C(){t=[],l=!1,m=null,clearTimeout(p),p=null}function D(){n&&A(r)}function E(){i.observe(g.CONST_PERIODICAL_EXECUTION_TIMER_EVENT,function(a){if(l)n=!0,r=!0;else{var b=!0;A(b)}}),i.observe(d,function(a){var b=a.memo;if($undefinedOrNull(b)||$undefinedOrNull(b.data))return;var c=b.data.cmd;if($undefinedOrNull(b.data)||$undefinedOrNull(b.data.params)||$undefinedOrNull(b.data.params.response))return;var d=b.data.params.response;if($undefinedOrNull(c)||$undefinedOrNull(d))return;if(c==e){var g=d.req;l&&g==m?B(d):f.info("SN.Executer: received a late response from the server, so, ignoring it.")}})}var a="/run.js?",b="key",c="req",d="xdevent",e="ruleevent",f=SN.Utils,g=SN.Constants,h=SN.CrossXHR,i=SN.EventManager,j=SN.ConfigurationManager,k={},l=!1,m=null,n=!1,o=4e3,p=null,q=1,r=!1,s=[],t=[],F={registerAsDataSender:u};return E(),F}(),$undefined(SN)&&(SN={}),SN.PSPTracker=function(){function u(){k.observe(b,v),k.observe(c,v),k.observe(e,v),k.observe(d,v),k.observe(f,v),k.observe(h,w),k.observe(g,v),k.observe(i,v),k.observe(j,v)}function v(a){var b=a.memo;l.debug("SN.PSPTracker: Recieved a tracking event, eventId - ",b.eventId);var c=b.data,d=b[q],e=c.ruleId,f=!1,g={};g[r]=d,$undefinedOrNull(b.trackingSecured)||(f=b.trackingSecured),$undefinedOrNull(b.sessionStartEvent)||(g.fpid=(new Fingerprint).get()),$undefinedOrNull(b.previousActivesession)||(g.pat=b.previousActivesession),$undefinedOrNull(b[o])?g[o]=(new Date).getTime():g[o]=b[o];var h=c.r;$undefinedOrNull(h)||(g.r=h);var i;i=navigator.userAgent,g.bd=encodeURIComponent(i);var j=c.f;$undefinedOrNull(j)||(g.f=j);var k=c.ed;if(!$undefinedOrNull(e)){$undefinedOrNull(k)&&(k={}),k.rn=e;if(!$undefinedOrNull(parent.SN.Conf.ruleTypeMapping))for(var n in parent.SN.Conf.ruleTypeMapping)if(e.indexOf(n)!=-1){g.f.v.rc=parent.SN.Conf.ruleTypeMapping[n];break}}$undefinedOrNull(parent.SN.Conf.tnt)||(g.tnt=parent.SN.Conf.tnt),$undefinedOrNull(parent.SN.Conf.stnt())||(g.stnt=parent.SN.Conf.stnt()),$undefinedOrNull(k)||(g.ed=k),b.s>t?t=b.s:l.error("SN.PSPTracker: received an older seqId event, its a bug !"),l.info("SN.PSPTracker: eventId: ",d,"trackableData: ",g);var p={};p.key=m.getPSPKey(),parent.SN.Tracker.constructAndMakeTrackingCall(p,g,null,f)}function w(a){var b={},c=a.memo,d=!1;l.copyParams(c,b),$undefinedOrNull(b.trackingSecured)||(d=b.trackingSecured,delete b.trackingSecured),b.tseq=s,s++,l.info("SN.PSPTracker: generic trackableData: ",b);var e={};e.key=l.getClientKey(),parent.SN.Tracker.constructAndMakeTrackingCall(e,b,null,d)}function x(a,b,c,d,e,f){l.debug("SN.PSPTracker: Recieved a tracking event, eventId - ",a);var g={};g[r]=a,g[o]=(new Date).getTime(),$undefinedOrNull(c)||(g.r=c),$undefinedOrNull(b)||(g.f=b),$undefinedOrNull(d)||(g.ed=d),$undefinedOrNull(parent.SN.Conf.tnt)||(g.tnt=parent.SN.Conf.tnt),$undefinedOrNull(parent.SN.Conf.stnt())||(g.stnt=parent.SN.Conf.stnt()),l.info("SN.PSPTracker: eventId: ",a,"trackableData: ",g);var h={};return h.key=m.getPSPKey(),parent.SN.Tracker.constructAndMakeTrackingCall(h,g,e,f)}function y(){return a}var a="psptrackersender",b="VISITOR_EVENT",c="RULE_ENGINE_EVENT",d="CUSTOM_EVENT",e="exceptionevent",f="WOWPXAPP_EVENT",g="MULTIPLE_RULES_SATISFIED_EVENT",h="CUSTOM_TRACK_EVENT",i="exitLinkEvent",j="SESSION_START_EVENT",k=SN.EventManager,l=SN.Utils,m=SN.ConfigurationManager,n=SN.Constants,o="st",p="s",q="eventId",r="ec",s=0,t=-1,z={getName:y,trackEventData:x};return u(),z}(),$undefined(SN)&&(SN={}),SN.RulesRuntime=function(){function appendOnlyRules(a,b,c){var d=!0;for(var e in c)d===!0?(d=!1,a[b]=""):a[b]+=",",a[b]+=e}function appendRuleEngineDataToRunRulesParams(a){var b=configStore.getRuleGroupId();$undefinedOrNull(activatedRules)||appendOnlyRules(a,PARAM_KEY_PC_SATSIFIED_RULES,activatedRules),$undefinedOrNull(b)||(a[CONST_PARAM_KEY_RULE_GROUP_ID]=configStore.getRuleGroupId());var c=configStore.getGeneratedRuleVariables();if(!$undefinedOrNull(c))for(var d in c){var e=c[d];$undefinedOrNull(e.value)||(a[d]=encodeURIComponent(e.value))}var f=configStore.getMappedRuleVariables();if(!$undefinedOrNull(f))for(var d in f){var g=f[d];!$undefinedOrNull(g)&&!$undefinedOrNull(g.value)&&(a[d]=encodeURIComponent(g.value))}var h=configStore.getFSMUpdateVariables();for(var i=0;i<h.length;i++){var j=h[i];a[j.key]=encodeURIComponent(sessionManager.doGetFSMVariable(j))}return a[SN.Constants.VISITOR_ID]=configStore.getVisitorId(),a[SN.Constants.VG_RANDOM_NUMBER]=configStore.getVGRandomNumber(),a[SN.Constants.TP_RANDOM_NUMBER]=configStore.getTPRandomNumber(),a[SN.Constants.VERSION]=configStore.getPSPVersion(),a[SN.Constants.ACTIVE_SESSION]=storeManager.getValueFromStore(SN.Constants.SN_VI_STORE_NAME,SN.Constants.ACTIVE_SESSION),a[CONST_EVENT_CODE]=CONST_MODEL_EVALUATION,a[CONST_PXOE_VERSION]=SN.Conf.PXOE_VERSION,a[CONST_TRACKER_VERSION]=SN.Conf.TRACKING_VERSION,a[CONST_VISITOR_GRUOP]=configStore.getVisitorGroup(),a[CONST_TARGET_ID]=configStore.getTargetId(),a[CONST_TARGET_POPULATION]=configStore.getTargetPopulationId(),a[CONST_BROWSER_DATA]=encodeURIComponent(navigator.userAgent),a}function getName(){return CONST_RULES_RUNTIME_SENDER_NAME}function processRules(){if(configStore.getRules()==null)return;computeGeneratedRuleVariables();var a={};a[CONST_ACTIVATED_RULES]={},a[CONST_LAST_EXECUTION_TS_SERVER]=lastExecutionTsServer;var b=!1,c=configStore.getRules();if(!$undefinedOrNull(c))for(var d in c)preconditionsSatisfied(d)&&(a[CONST_ACTIVATED_RULES][d]=!0,b=!0);return b?(activatedRules=a[CONST_ACTIVATED_RULES],lastExecutionTsServer=a[CONST_LAST_EXECUTION_TS_SERVER],a):null}function getRequestDataCallback(){var a=Math.floor(((new Date).getTime()-lastCheckPointTS)/1e3);if(a<configStore.getPollingInterval()-1)return utils.info("SN.RulesRuntime: Time diff between this call and previous call is less than ",configStore.getPollingInterval()," So returning NULL"),null;var b=processRules();if(b==null)return null;var c={};return appendRuleEngineDataToRunRulesParams(c),lastCheckPointTS=(new Date).getTime(),c}function putResponseDataCallback(a){utils.infoTrack("runRulesResponseReceivedByRulesRuntime","");var b=a.fire;if($undefined(b))return;window.setTimeout(function(){lastExecutionTsServer=a.timestamp;var b=a.fire;processRulesFired(b)},1)}function evaluateInCondition(a,b){var c=b.split(",");for(var d=0;d<c.length;d++)if(c[d]==a)return!0;return!1}function evaluateTimerCondition(a,b){var c=getOperandValue(b[0]),d=getOperandValue(b[1]);switch(a){case OPERATOR_EQ:return c==d;case OPERATOR_LT:return c<d;case OPERATOR_LTE:return c<=d;case OPERATOR_GT:return c>d;case OPERATOR_GTE:return c>=d;case OPERATOR_NOTEQ:return c!=d;default:return!1}}function evaluateExists(a){return $undefinedOrNull(configStore.getMappedRuleVariableValue(a))?!1:!0}function getOperandValue(a){var b;if(a.type===CONSTANT_TYPE)return b=a.expr,b;if(a.type===VARIABLE_TYPE){var c=a.expr;b=configStore.getGeneratedRuleVariableValue(c)}return $undefinedOrNull(b)&&(b=configStore.getMappedRuleVariableValue(a.expr)),b}function evaluateVariableCondition(a,b){if(b.length==1&&a==OPERATOR_EXISTS)return evaluateExists(b[0]);var c=getOperandValue(b[0]),d=getOperandValue(b[1]);switch(a){case OPERATOR_EQ:return c==d;case OPERATOR_LT:return c<d;case OPERATOR_LTE:return c<=d;case OPERATOR_GT:return c>d;case OPERATOR_GTE:return c>=d;case OPERATOR_NOTEQ:return c!=d;case OPERATOR_CONTAINS:return $contains(c,d);case OPERATOR_NOT_CONTAINS:return!$contains(c,d);case OPERATOR_STARTS_WITH:return $startsWith(c,d);case OPERATOR_NOT_STARTS_WITH:return!$startsWith(c,d);case OPERATOR_ENDS_WITH:return $endsWith(c,d);case OPERATOR_NOT_ENDS_WITH:return!$endsWith(c,d);case OPERATOR_REGEX:return $patternMatch(c,d);case OPERATOR_IN:return evaluateInCondition(c,d);default:return!1}}function evaluatePreconditions(a){if(a==null||a.length==0)return!0;var b=!0;for(var c=0;c<a.length;c++){var d=a[c],e=d.type||"",f=d.operator,g=d.operands,h=!1;f=f.toLowerCase(),e=e.toLowerCase(),f==OPERATOR_EXISTS?b=b&&!$undefined(configStore.getMappedRuleVariableValue(g[0])):(e==CONDITION_TYPE_TIMER?h=evaluateTimerCondition:h=evaluateVariableCondition,b=b&&h.call(this,f,g));if(b===!1)return b}return b}function computeGeneratedRuleVariables(){var generatedRuleVariables=configStore.getGeneratedRuleVariables();if(!$undefinedOrNull(generatedRuleVariables))for(var key in generatedRuleVariables){var variable=generatedRuleVariables[key];try{variable.value=eval(variable.expr),configStore.updateGeneratedRuleVariable(variable.key,variable.value)}catch(err){utils.error("SN.RulesRuntime.computeGeneratedRuleVariables : failed to evaluate & update generated rule variable : ",variable,"error:",err)}}}function trackMultipleRule(a){var b=a[0],c={},d=CONST_MULTIPLE_RULES_SATISFIED;c.eventId=d;var e={},f={};f.rtf=b,f.rcs=a,e.ed=f,c.data=e,utils.info("SN.RulesRuntime: Firing tracking event for  MULTIPLE_RULES_SATISFIED"),eventManager.fire(CONST_MULTIPLE_RULES_SATISFIED_EVENT,c)}function processRulesFired(a){utils.info("SN.RulesRuntime: Fired ruleset: ",a);var b=CONST_RULES_TRIGGERED,c={};c.eventId=b;var d=a.length;if(d<1){utils.info("SN.RulesRuntime: No rules to fire ");return}d>1&&trackMultipleRule(a);var e={},f={},g=a[0];f.ruleId=g,e.ed=f,e.ruleId=g;var h=configStore.getTrackableRuleVariables(b,g);$undefinedOrNull(h)||(e.r=h);var i=configStore.getTrackableFSMVariables(b,g);$undefinedOrNull(i)||(e.f=i),c.data=e,c.sr=CONST_RULE_ENGINE_SOURCE,utils.info("SN.RulesRuntime: FIRING_TRACKING_EVENT for eventId - ",b),eventManager.fire(CONST_PAGE_EVENT,c),utils.debugTrack("firedRule",{ruleId:g})}function preconditionsSatisfied(a){var b=configStore.getRules(),c=b[a];if($undefined(c))return!1;var d=c.preconditions||[],e=!0;return $undefinedOrNull(d)||(e=evaluatePreconditions(d)),utils.info("SN.RulesRuntime: result is: ",e," for rule: ",a),e}var CONST_BOOTSTRAP_RECEIVED_EVENT="bootstrapRecvd",CONST_MULTIPLE_RULES_SATISFIED=110004,CONST_RULES_TRIGGERED=11e4,CONST_MULTIPLE_RULES_SATISFIED_EVENT="MULTIPLE_RULES_SATISFIED_EVENT",CONST_RULE_ENGINE_SOURCE="rule",CONST_PAGE_EVENT="pageevent",CONST_PXOE_VERSION="vp",CONST_TRACKER_VERSION="vt",CONST_VISITOR_GRUOP="vg",CONST_TARGET_ID="ti",CONST_TARGET_POPULATION="tp",CONST_BSID="bsid",CONST_BROWSER_DATA="bd",CONST_EVENT_CODE="ec",CONST_MODEL_EVALUATION="110005",OPERATOR_EQ="eq",OPERATOR_NOTEQ="noteq",OPERATOR_CONTAINS="contains",OPERATOR_NOT_CONTAINS="notcontains",OPERATOR_STARTS_WITH="startswith",OPERATOR_NOT_STARTS_WITH="notstartswith",OPERATOR_ENDS_WITH="endswith",OPERATOR_NOT_ENDS_WITH="notendswith",OPERATOR_REGEX="regex",OPERATOR_LT="lt",OPERATOR_GT="gt",OPERATOR_LTE="lteq",OPERATOR_GTE="gteq",OPERATOR_IN="in",OPERATOR_EXISTS="exists",CONDITION_TYPE_TIMER="timer",CONST_ACTIVATED_RULES="activatedrules",CONST_LAST_EXECUTION_TS_SERVER="l",VARIABLE_TYPE="v",CONSTANT_TYPE="c",CONST_RULES_RUNTIME_SENDER_NAME="rulesruntime",PARAM_KEY_PC_SATSIFIED_RULES="pc",CONST_PARAM_KEY_RULE_GROUP_ID="rg",activatedRules={},lastExecutionTsServer=-1,eventManager=SN.EventManager,sessionManager=SN.SessionManager,storeManager=SN.StoreManager,utils=SN.Utils,configStore=SN.ConfigurationManager,lastCheckPointTS=-1,me={getName:getName,getRequestDataCallback:getRequestDataCallback,putResponseDataCallback:putResponseDataCallback};return eventManager.observe(CONST_BOOTSTRAP_RECEIVED_EVENT,function(){lastCheckPointTS=-1e4,SN.Executer.registerAsDataSender(me)}),me}();var WoWPxApp=function(a,b){function f(a,b){a.indexOf("#")==-1&&(a+="#");for(var c in b)a=a+c+"="+b[c]+"&";return a.slice(0,a.length-1)}function g(){var c=parent.document.createElement("iframe");c.id=a+"_iframe",c.scrolling="no",c.frameBorder="0",c.allowTransparency="true";var d=b.iframeStyle||{width:"200px",height:"200px"};c.width=d.width,c.height=d.height,Element.setStyle(c,d),Element.hide(c);var e=b.url,g=b.params||{};return g.id=a,c.src=f(e,g),c}function h(){var c=b.url,d=b.params||{};d.id=a;var e=b.popupStyle||{width:"400px",height:"300px",left:"100px"},g="width="+e.width+", height="+e.height+", left="+e.left+", location=0, scrollbars=0, status=0, titlebar=0, toolbar=0";return window.open(f(c,d),a+"_window",g)}function i(){this.isLoaded=!0,Element.hide(this.loadingDiv),this.type==0&&Element.show(this.widgetRef)}this.id=a,this.type=b.type||0,this.widgetRef=null,this.isLoaded=!1,this.widget=parent.document.createElement("div"),this.widget.id=a+"_container",Element.hide(this.widget);var c=b.popupStyle||{width:"400px",height:"300px",left:"100px"};Element.setStyle(this.widget,c),parent.document.body.appendChild(this.widget),this.tab=parent.document.createElement("div"),this.tab.id=a+"_icon",Element.setStyle(this.tab,b.tabStyle||{}),Element.hide(this.tab),parent.document.body.insertBefore(this.tab,this.widget),Event.observe(this.tab,"click",this.show.bindAsEventListener(this)),this.minimizer=parent.document.createElement("a"),this.minimizer.innerHTML="-",this.minimizer.href="#",this.minimizer.id=a+"_minimize",this.minimizer.style["float"]="left",this.minimizer.style.width="10px",this.minimizer.style.textDecoration="none";var d=b.minimizerStyle||{};Element.setStyle(this.minimizer,d),Event.observe(this.minimizer,"click",this.hide.bindAsEventListener(this)),Element.insert(this.widget,this.minimizer),this.closer=parent.document.createElement("a"),this.closer.id=a+"_close",this.closer.href="#",this.closer.innerHTML="X",this.closer.style["float"]="right",this.closer.style.width="10px",this.closer.style.textDecoration="none";var e=b.closerStyle||{};Element.setStyle(this.closer,e),Event.observe(this.closer,"click",this.close.bindAsEventListener(this)),Element.insert(this.widget,this.closer),this.loadingDiv=parent.document.createElement("div"),this.loadingDiv.id=this.id+"_loader",b.loadingStyle&&Element.setStyle(this.loadingDiv,b.loadingStyle),Element.insert(this.widget,this.loadingDiv);if(this.type==0){this.widgetRef=g(),this.widget.appendChild(this.widgetRef);var j=this.widgetRef.contentWindow||this.widgetRef.contentDocument;j.document?this.widgetRefWin=j:this.widgetRefWin=j.getParentNode(),Event.observe(this.widgetRefWin,"load",i.bindAsEventListener(this))}else this.type==1&&(this.widgetRef=h(),this.widgetRefWin=this.widgetRef,Event.observe(this.widgetRefWin,"load",i.bindAsEventListener(this)),window.focus())};WoWPxApp.prototype.move=function(a,b){this.type==0?(this.widget.style.left=a,this.widget.style.top=b):this.type==1&&this.widgetRef.moveTo(a,b)},WoWPxApp.prototype.style=function(a){if(this.type==0)Element.setStyle(this.widget,a);else if(this.type==1){var b=document.viewport.getDimensions(),c=a.width||b.width,d=a.height||b.height;this.widgetRef.resizeTo(c,d)}},WoWPxApp.prototype.hide=function(){return this.type==1?self.focus():this.type==0&&(Element.hide(this.widget),Element.show(this.tab)),!1},WoWPxApp.prototype.show=function(){return this.type==1?this.widgetRef.focus():this.type==0&&(Element.hide(this.tab),Element.show(this.widget)),!1},WoWPxApp.prototype.close=function(){this.type==1&&this.widgetRef.close(),Element.remove(this.widget),Element.remove(this.tab),delete __wowpx[this.id]},WoWPxApp.prototype.setContext=function(a){this.widgetRefWin.WOWPx.setContext(a)},WoWPxApp.prototype.isLoaded=function(){return this.isLoaded},$undefined(SN)&&(SN={}),$undefined(SN.WOWPx)&&(SN.WOWPx={}),SN.WOWPx.Events={CONST_PAGE_EVENT:"pageevent",CONST_PAGE_ACTION_EVENT:"pageactionevent",CONST_BOOTSTRAP_COMPLETED_EVENT:"bootstrapDone",CONST_STATE_CHANGE_COMPLETED_EVENT:"statechangecompleted",CONST_WIDGET_EVENT:"widgetevent",CONST_APP_CONTROL_EVENT:"appcontrol",CONST_APP_INTERACTION_EVENT:"appinteraction",CONST_CHAT_APP_EVENT:"chatappevent",CONST_INVITE_USER:"inviteuser"},SN.WOWPx.EventIds={CONST_CHATAPP_STARTED:"chatappstarted",CONST_CHATAPP_UPDATESTATE_QUEUE:"updatestatequeue",CONST_CHATAPP_UPDATESTATE_CLOSE:"updatestateclose",CONST_CHATAPP_MOVEDTO_PRECHAT:"movedtoprechat",CONST_CHATAPP_MOVEDTO_QUEUE:"movedtoqueue",CONST_CHATAPP_MOVEDTO_CHAT:"movedtochat",CONST_CHATAPP_MOVEDTO_POSTCHAT:"movedtopostchat",CONST_CHATAPP_SHUTDOWN:"chatappshutdown",CONST_CHATAPPLISTENER_INIT:"chatlibinit",CONST_AGENT_AVAILABLE:"agentavailable",CONST_AGENT_NOT_AVAILABLE:"agentunavailable",CONST_CHAT_STARTED:"chatstarted",CONST_CHAT_ENDED:"chatended",CONST_CHAT_ERROR:"chaterror",CONST_CHATAPP_SHUTDOWN_DONE:"chatappshutdowndone",CONST_CHAT_STATE_CHANGE:"chatstatechange",CONST_CHAT_AGENT_TYPING:"agenttyping",CONST_AGENT_TO_CUSTOMER_TEXT:"agenttocusttext",CONST_CUSTOMER_TO_AGENT_TEXT:"custtoagenttext",CONST_AGENT_FORM_PUSH:"agentformpush",CONST_AGENT_URL_PUSH:"agenturlpush",CONST_AGENT_NOTIFY_MESSAGE:"agentnotifymessage",CONST_AGENT_WARN_MESSAGE:"agentwarnmessage",CONST_AGENT_ERROR_MESSAGE:"agenterrormessage",CONST_AGENT_HELP_COMMAND:"agenthelpcommand",CONST_CHAT_LIB_NOTIFICATION:"chatlibnotification",CONST_USER_FORM_SUBMITTED:"userformsubmitted",CONST_AGENT_ENDED_CHAT:"agentendedchat",CONST_INVALID_AGENT_COMMAND:"invalidagentcommand",CONST_FORM_PUSH:"formpush",CONST_USER_HAD_INTERACTIVE_CHAT:"userhadinteractivechat",CONST_LOAD_CHAT_APP_CONFIGS:"loadchatconfigs",CONST_INVITATION_ACCEPTED:"invitationAccepted",CONST_INVITATION_DECLINED:"invitationDeclined",CONST_INVITATION_IGNORED:"invitationIgnored"},$undefined(SN)&&(SN={}),$undefined(SN.WOWPx)&&(SN.WOWPx={}),SN.WOWPx.Controller=function(){function i(e){var f=e.memo,h=f.data,i=h.handlerType;if(i==a){var j=h[b],k=g.getHandlerConfig(j),m=k.appId,n={};n.ruleId=j,n.r=m+".js",n.key=parent.SN.Conf.CONST_PSP_KEY,n.pspVersion=parent.SN.Conf.CONST_PSP_VERSION,n.version=parent.SN.Conf.CONST_CDN_VERSION;var o=parent.SN.Tracker.getUniquePageId();n.up=o;var p=g.getWowpxAppConfigs(),q=p[m],r=g.getWowpxWidgetConfigs(q.widgetConfigName),s=o+"_"+m;if(typeof __wowpx[s]=="undefined"||__wowpx[s]==null)r.type=r.type||0,r.url=q.appConfigUrl,n.src=r.type,r.params=n,__wowpx[s]=new WoWPxApp(s,r);__wowpx[s].show(),d.debug("SN.WOWPx.Controller: Sucessfully executed wowpx handler for rule: ",j)}else if(i==c){var j=h[b],k=g.getHandlerConfig(j),m=k.appId;if(m=="undefined"||m==null)return;var t={};t.key=parent.SN.Conf.CONST_PSP_KEY,t.pspVersion=parent.SN.Conf.CONST_PSP_VERSION,t.version=parent.SN.Conf.CONST_CDN_VERSION;var o=parent.SN.Tracker.getUniquePageId();t.client_page_url=l(),t.up=o,t.p=h.p;if(typeof __adp[m]=="undefined"||__adp[m]==null)__adp[m]=new ADPApp(m,t);__adp[m].show(),d.debug("SN.ADP.AppLauncher: Sucessfully launched aplication : ",m)}}function j(a,b){__wowpx[a]&&__wowpx[a].setContext(b)}function k(a){return __wowpx[a]?__wowpx[a].isLoaded():!1}function l(){var a=location.href,b=a.split("#"),c=b[1].split("&");for(var d=0;d<c.length;d++)if(c[d].indexOf("documentDomain")!=-1){var e=c[d].split("="),f=e[1];return location.protocol+"//"+f}}function m(){e.observe(h.PAGE_ACTION_EVENT,i),e.observe(f.CONST_INVITE_USER,i)}var a="START_WOWPX_APP",b="ruleId",c="START_ADP_APP",d=SN.Utils,e=SN.EventManager,f=SN.WOWPx.Events,g=SN.ConfigurationManager,h=SN.Constants;window.__wowpx={},window.__adp={},m();var n={isLoaded:k,setContext:j};return n}(),SN.CustomScript.captureConversions(),SN.CustomScript.chatConfigDecider()