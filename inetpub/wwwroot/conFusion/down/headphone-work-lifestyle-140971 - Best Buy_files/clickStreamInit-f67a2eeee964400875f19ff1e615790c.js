/* Src File:"clickstream-dotcom/javascript/clickStreamInit-f67a2eeee964400875f19ff1e615790c.js" @ Mon Oct 19 2015 14:14:51 GMT-0500 (CDT) Group_ID: com.bestbuy.frontend.clickstream GIT_BRANCH: origin/release/1.3.5 BUILD_CAUSE: MANUALTRIGGER Build Version: 1.3.5 */

define("sc-clickstream-core/javascript/clickStreamTracker",[],function(){function e(e){var t=this;$.extend(!0,this.options,{DEVMODE:!1,data:_.clone(window.track)||{},supportedHosts:["www.bestbuy.com","www-ssl.bestbuy.com"],escapeBlacklist:["path","pageTitle","itemType","orderId"],pageNameProperties:["uberCatName","parentCatName","catName"],siteName:"Dotcom",defaultParameters:{src:t._getSiteName,path:encodeURIComponent(window.location.href),pageTitle:encodeURIComponent(document.title),action:"pageView",pageName:t._getPageName,itemType:t._getTemplateName,clientTime:t._getClientTime,rand:t._getRandomString},overrideAnalytics:!1},e)}return e.prototype={options:{},isReadyToPost:!1,pendingToPost:[],startTracking:function(e){var t={},a=this;$.when.apply(this,this._executePageArray(e)).done(function(){_.each(arguments,function(e){_.isEmpty(e)||_.extend(t,e)}),a.postToContext(t),a.options.overrideAnalytics&&a._overrideAnalytics()}).done(function(){for(;a.pendingToPost.length;){var e=a.pendingToPost.shift();a.postToContext(e)}a.isReadyToPost=!0})},sendContext:function(e){this.isReadyToPost?this.postToContext(e):this.pendingToPost.push(e)},postToContext:function(e){e=e||{},(new Image).src=this._getBaseUrl()+this._buildQueryString(e)},setOptions:function(e){return $.extend(!0,this.options,e),this},getData:function(e){return this.options.data[e]||!1},_executePageArray:function(e){var t=[];return _.each(e,function(e){t.push(e())}),t},_getClientTime:function(){return(new Date).toString()},_getRandomString:function(){return(new Date).getTime().toString()+_.random(1,1e3)},_getPageName:function(){return _.values(_.pick(this.options.data,this.options.pageNameProperties)).join(": ")},_getBaseUrl:function(){var e=this.options.DEVMODE||-1===_.indexOf(this.options.supportedHosts,window.location.host);return e?"//pl.context.bestbuy.com/_.gif":"//context.bestbuy.com/_.gif"},_getSiteName:function(){return this.options.siteName},_getTemplateName:function(){return this.getData("templateName")},_buildQueryString:function(e){var t=[],a=_.extend(_.clone(this.options.defaultParameters),e),r=this;return _.each(a,function(e,a){"function"==typeof e&&(e=e.call(r)),-1===_.indexOf(r.options.escapeBlacklist,a)&&(e=escape(e)),t.push(a+"="+e)}),"?"+t.join("&")},_overrideAnalytics:function(){window.Lm&&window.Lm.clickStream&&(window.Lm.clickStream.SEND=$.noop)}},new e}),define("clickstream-dotcom/javascript/modules/queryParameterEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){var e=a();e&&e.eapi&&(e.action="recClick",c.sendContext(e)),e&&e.qp&&c.setOptions({defaultParameters:{facets:e.qp}})}function a(){return _.pick(r(),["track","eapi","ep","qp"])}function r(){var e=window.location.search,t={};return e?(e=e.slice(1,e.length).split("&"),_.each(e,function(e,a){e=e.split("="),t[e[0]]=e[1]}),t):!1}var c=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/homePageEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){var t=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){if("cat00000"===t.getData("catId")){var e={itemType:"GHP"};t.setOptions({defaultParameters:e})}return $.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/carouselEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){EventManager.when("experiencePlatform:carouselInit",function(){var e=$(".carousel-wrapper"),t=[],c={action:"recLoad",track:"recLoad"};e.each(function(){var e,r,i=$(this).find(".carousel-container").find("li"),n=$(this).find(".parent-container .parent-item");n.length&&(e=n.data("ep-value"),t.push(e),r=a(e),c[r+"Sku"]=n.data("skuId")),e=i.first().data("ep-value"),t.push(e),r=a(e),c[r+"Sku"]=i.map(function(){return $(this).data("skuId")}).toArray().join(",")});for(var i=0,n=t.length;n>i;i++)c["ep"+(i+1)]=t[i];r.sendContext(c),EventManager.on("experiencePlatform:productClick",function(e){r.sendContext({action:"uiClick",track:"recClick",actionLabel:e.carouselType||"",itemId:e.skuId||"",ep:e.epId||""})})}),EventManager.on("recommendations:load",function(e){for(var t=e.epValue||"",c=a(t),i={action:"recLoad",track:"recLoad",actionLabel:e.type||""},n=t.split(":"),o=0,s=n.length;s>o;o++)i["ep"+(o+1)]=n[o];i[c+"Sku"]=(e.skuIds||[]).join(","),r.sendContext(i)}),EventManager.on("recommendations:productClick",function(e){r.sendContext({action:"uiClick",track:"recClick",actionLabel:e.type||"",itemId:e.skuId||"",ep:e.epValue||""})})}function a(e){var t=_.filter(e.split(","),function(e){return 0===e.indexOf("rc-")});return t.length>0?t[0].slice(3):""}var r=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/searchEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){var t=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){var e={},a=t.getData("pageType"),r=t.getData("searchTerm")||t.getData("searchTermPromo")||t.getData("searchTermSOLR");return r&&(/^redirect:/.test(r)?_.extend(e,{searchTerm:r.replace("redirect:","").trim(),searchRedirect:!0}):a&&a.indexOf("list")>-1?(_.extend(e,{searchResultsNum:t.getData("searchResultsNum")||"",searchPageNum:t.getData("listPageNum")||"",searchSort:t.getData("listSort")||"",searchListView:t.getData("listView")||""}),a.indexOf("category")>-1?_.extend(e,{searchCategory:r}):a.indexOf("promo")>-1?_.extend(e,{searchPromo:r,pageName:"promo"}):a.indexOf("failed")>-1?_.extend(e,{searchTerm:r,searchFailed:!0,pageName:"no results"}):_.extend(e,{searchTerm:r,pageName:"search results"})):_.extend(e,{searchTerm:r}),t.setOptions({defaultParameters:e})),$.Deferred().resolve(e)}}),define("clickstream-dotcom/javascript/modules/listPageEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(e){var t={itemType:e||"",itemId:""},c=[];$(".list-item").each(function(){c.push($(this).data("skuId"))}),c.length&&(t.itemId=c.join(",")),a.setOptions({defaultParameters:t}),EventManager.on("List:Facet:Add",function(e){a.sendContext({action:"uiClick",track:"facet",actionLabel:"Facet Add",facetId:e.facet?e.facet.id||"":"",facetValue:e.facetValue?e.facetValue.value||"":""})}),$("body").on("click",'a[data-rank="pdp"]',function(){var e=$(this).parents(".list-item").data("skuId");a.sendContext({action:"uiClick",actionLabel:"Product",skuId:e||""})}),$("body").on("click",'a[data-rank="reviews"]',function(){var e=$(this).parents(".list-item").data("skuId");a.sendContext({action:"uiClick",actionLabel:"Reviews",skuId:e||""})}),$("body").on("click",'a[data-rank="availability"]',function(){var e=$(this).parents(".list-item").data("skuId");a.sendContext({action:"uiClick",actionLabel:"Availability",skuId:e||""})}),r.resolve()}var a=e("sc-clickstream-core/javascript/clickStreamTracker"),r=$.Deferred();return function(){var e=a.getData("pageType");return e&&e.indexOf("list")>-1?t(e):r.resolve(),r}}),define("clickstream-dotcom/javascript/modules/pdpEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){var e=a.getData("skuId"),t={itemType:"product"};e&&(t.itemId=e),a.options.pageNameProperties.push("catId"),a.setOptions({defaultParameters:t}),EventManager.on("pdp:tab:activated",function(e){var t=$("[data-fragment-id="+e.tabId+"-tab]").text();a.sendContext({action:"uiClick",actionLabel:t})})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return"pdp"===a.getData("catId")&&t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/cartEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){EventManager.when("cart:domReady",function(){var e=a().join(",");c.resolve({itemId:e}),EventManager.on("backbone:model:order:sync",function(e){var t=[];_.each(e.get("lineItems"),function(e){t.push(e.item.skuId)}),r.sendContext({itemId:t.join(","),actionLabel:"Order Updated",action:"orderUpdate"})}),EventManager.on("backbone:model:lineItem:remove",function(e,t){var a=[];_.each(t.models,function(e){a.push(e.get("item").skuId)}),r.sendContext({itemId:a.join(","),actionLabel:"Remove",action:"uiClick",removedSku:e.get("item").skuId})}),EventManager.on("backbone:model:order:change:zipcode",function(e,t){r.sendContext({itemId:r.getData("skuList")||window.track.skuList||a()||"",action:"uiClick",actionLabel:"Calculate",zipCode:t})})})}function a(e){var t=[];try{e=e||cart.app.orderModel,e.items.each(function(e){t.push(e.get("item").skuId)})}catch(a){}return t}var r=e("sc-clickstream-core/javascript/clickStreamTracker"),c=$.Deferred();return function(e){return"CRT"===r.getData("templateName")?t():c.resolve(),c}}),define("clickstream-dotcom/javascript/modules/checkoutEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){$("body").on("click","a",function(){a.sendContext({action:"uiClick",actionLabel:$(this).text()})}),EventManager.on("page:stateChange",function(e,t){var r={};"thank-you"===e&&(a.setOptions({data:window.track}),r={itemId:a.getData("skuList")||"",orderId:a.getData("orderId")||"",giftList:a.getData("giftList")||"",mobilePackage:a.getData("mobilePackage")||"",orderDiscAmt:a.getData("orderDiscAmt")||"",orderGCAmt:a.getData("orderGCAmt")||"",orderShipAmt:a.getData("orderShipAmt")||"",orderTaxAmt:a.getData("orderTaxAmt")||"",priceList:a.getData("priceList")||""},a.setOptions({defaultParameters:r}),a.sendContext({action:"pageView",actionLabel:"THX"}))})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return"Checkout"===a.getData("uberCatName")&&t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/thankYouEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){var e={itemId:a.getData("skuList")||"",orderId:a.getData("orderId")||"",giftList:a.getData("giftList")||"",mobilePackage:a.getData("mobilePackage")||"",orderDiscAmt:a.getData("orderDiscAmt")||"",orderGCAmt:a.getData("orderGCAmt")||"",orderShipAmt:a.getData("orderShipAmt")||"",orderTaxAmt:a.getData("orderTaxAmt")||"",priceList:a.getData("priceList")||"",searchRank:a.getData("searchRank")||"",searchTermRelevancy:a.getData("searchTermRelevancy")||""};a.setOptions({defaultParameters:e})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return"THX"===a.getData("templateName")&&t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/myAccountEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){$("body .offer-hub").on("click",".carousel-wrapper .product-list li",function(e){a.sendContext({action:"uiClick",track:"recClick",itemId:$(this).attr("data-sku-id")||"",ep:$(this).attr("data-ep-value")||""})})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return"MARH"===a.getData("templateName")&&t(),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/addToCartEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){var t=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){var e=!1;return EventManager.on("addToCart:done",function(a){e?e=!1:t.sendContext({action:"addToCart",actionLabel:"Add to Cart",addedItemId:a.skuId||a.sku||"",price:a.price||"",pType:a.pricingType||""})}),EventManager.on("recommendations:addTocart",function(a){e=!0,t.sendContext({action:"addToCart",track:"addTocart",actionLabel:"Add to Cart",addedItemId:a.skuId||a.sku||"",ep:a.epValue||""})}),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/dealsEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){for(var e,t=document.cookie.split(";"),r=0;r<t.length;r++){for(var c=t[r];" "==c.charAt(0);)c=c.substring(1);0===c.indexOf("bby_rdp=")&&(e=c.substring("bby_rdp=".length,c.length))}var i="DigitalInsert";i+=e?"-"+e:"",EventManager.on("deals:experiencePlatform:carouselInit",function(e){var t={action:"recLoad",track:"recLoad",ep:e.epId,src:i};try{var r=/^rc-([A-Za-z]{2})/,c=r.exec(e.epId);t[c[1]+"Sku"]=e.skuIds}catch(n){}a.sendContext(t)}),EventManager.on("deals:experiencePlatform:productClick",function(e){a.sendContext({action:"uiClick",track:"recClick",src:i,actionLabel:e.epCarouselType||"",itemId:e.skuId||"",ep:e.epId||""})});var n=!1;return EventManager.on("deals:addToCart:done",function(e){n?n=!1:a.sendContext({action:"addToCart",actionLabel:"Add to Cart",addedItemId:e.skuId||"",price:e.price||"",src:i,pType:e.pricingType||""})}),EventManager.on("deals:recommendations:addTocart",function(e){n=!0,a.sendContext({action:"addToCart",track:"addTocart",actionLabel:"Add to Cart",src:i,addedItemId:e.skuId||"",price:e.price||"",ep:e.epId||""})}),EventManager.on("deals:pageView",function(e){a.sendContext({action:"pageView",actionLabel:"product",src:i,itemId:e.skuIds||""})}),EventManager.on("deals:productDetailClick",function(e){a.sendContext({action:"pageView",actionLabel:"product",src:i,itemId:e.skuId||"",itemType:"product"})}),EventManager.on("deals:productReviewsClick",function(e){a.sendContext({action:"uiClick",actionLabel:"reviews",src:i,itemId:e.skuId||""})}),EventManager.on("deals:productAvailabilityClick",function(e){a.sendContext({action:"uiClick",actionLabel:"Availability",src:i,itemId:e.skuId||""})}),$.Deferred().resolve({src:i})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){var e=/deals.bestbuy.com$/;return e.test(window.location.hostname)?t():$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/blackFridayEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){function t(){for(var e,t=document.cookie.split(";"),r=0;r<t.length;r++){for(var c=t[r];" "==c.charAt(0);)c=c.substring(1);0===c.indexOf("bby_rdp=")&&(e=c.substring("bby_rdp=".length,c.length))}var i="BlackFriday";i+=e?"-"+e:"",EventManager.on("blackFriday:experiencePlatform:carouselInit",function(e){var t={action:"recLoad",track:"recLoad",ep:e.epId,src:i};try{var r=/^rc-([A-Za-z]{2})/,c=r.exec(e.epId);t[c[1]+"Sku"]=e.skuIds}catch(n){}a.sendContext(t)}),EventManager.on("blackFriday:experiencePlatform:productClick",function(e){a.sendContext({action:"uiClick",track:"recClick",src:i,actionLabel:e.epCarouselType||"",itemId:e.skuId||"",ep:e.epId||""})});var n=!1;return EventManager.on("blackFriday:addToCart:done",function(e){n?n=!1:a.sendContext({action:"addToCart",actionLabel:"Add to Cart",addedItemId:e.skuId||"",price:e.price||"",src:i,pType:e.pricingType||""})}),EventManager.on("blackFriday:recommendations:addTocart",function(e){n=!0,a.sendContext({action:"addToCart",track:"addTocart",actionLabel:"Add to Cart",src:i,addedItemId:e.skuId||"",price:e.price||"",ep:e.epId||""})}),EventManager.on("blackFriday:pageView",function(e){a.sendContext({action:"pageView",actionLabel:"product",src:i,itemId:e.skuIds||""})}),EventManager.on("blackFriday:productDetailClick",function(e){a.sendContext({action:"pageView",actionLabel:"product",src:i,itemId:e.skuId||"",itemType:"product"})}),EventManager.on("blackFriday:productReviewsClick",function(e){a.sendContext({action:"uiClick",actionLabel:"reviews",src:i,itemId:e.skuId||""})}),EventManager.on("blackFriday:productAvailabilityClick",function(e){a.sendContext({action:"uiClick",actionLabel:"Availability",src:i,itemId:e.skuId||""})}),$.Deferred().resolve({src:i})}var a=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){var e=/blackfriday.bestbuy.com$/;return e.test(window.location.hostname)?t():$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/modules/profileEvents",["require","sc-clickstream-core/javascript/clickStreamTracker"],function(e){var t=e("sc-clickstream-core/javascript/clickStreamTracker");return function(){return EventManager.on("addToList",function(e){e&&(e.sku||e.skuId)&&t.sendContext({action:"addToList",actionLabel:"Add to List",addedSkuId:e.skuId||e.sku})}),EventManager.on("addToRegistry",function(e){e&&(e.sku||e.skuId)&&t.sendContext({action:"addToRegistry",actionLabel:"Add to Registry",addedSkuId:e.skuId||e.sku})}),$.Deferred().resolve()}}),define("clickstream-dotcom/javascript/siteConfig",["require","sc-clickstream-core/javascript/clickStreamTracker","clickstream-dotcom/javascript/modules/queryParameterEvents","clickstream-dotcom/javascript/modules/homePageEvents","clickstream-dotcom/javascript/modules/carouselEvents","clickstream-dotcom/javascript/modules/searchEvents","clickstream-dotcom/javascript/modules/listPageEvents","clickstream-dotcom/javascript/modules/pdpEvents","clickstream-dotcom/javascript/modules/cartEvents","clickstream-dotcom/javascript/modules/checkoutEvents","clickstream-dotcom/javascript/modules/thankYouEvents","clickstream-dotcom/javascript/modules/myAccountEvents","clickstream-dotcom/javascript/modules/addToCartEvents","clickstream-dotcom/javascript/modules/dealsEvents","clickstream-dotcom/javascript/modules/blackFridayEvents","clickstream-dotcom/javascript/modules/profileEvents"],function(e){var t=e("sc-clickstream-core/javascript/clickStreamTracker"),a={assignCategory:function(){var e=t.getData("catId"),a=t.getData("catName"),r="";e&&-1===e.indexOf("pcat17")&&(r=a?e+"["+a+"]":e,t.setOptions({defaultParameters:{category:r}}))},assignWindowSize:function(){for(var e=document.cookie.split(";"),a="",r=0;r<e.length;r++){for(var c=e[r];" "==c.charAt(0);)c=c.substring(1);0==c.indexOf("bby_rdp=")&&(a=c.substring("bby_rdp=".length,c.length))}var i=t._getSiteName().replace(/(-[sml])+$/,"");t.setOptions({siteName:i+"-"+a})},getPageModules:function(){return[e("clickstream-dotcom/javascript/modules/queryParameterEvents"),e("clickstream-dotcom/javascript/modules/homePageEvents"),e("clickstream-dotcom/javascript/modules/carouselEvents"),e("clickstream-dotcom/javascript/modules/searchEvents"),e("clickstream-dotcom/javascript/modules/listPageEvents"),e("clickstream-dotcom/javascript/modules/pdpEvents"),e("clickstream-dotcom/javascript/modules/cartEvents"),e("clickstream-dotcom/javascript/modules/checkoutEvents"),e("clickstream-dotcom/javascript/modules/thankYouEvents"),e("clickstream-dotcom/javascript/modules/myAccountEvents"),e("clickstream-dotcom/javascript/modules/addToCartEvents"),e("clickstream-dotcom/javascript/modules/dealsEvents"),e("clickstream-dotcom/javascript/modules/blackFridayEvents"),e("clickstream-dotcom/javascript/modules/profileEvents")]}};return a}),require(["sc-clickstream-core/javascript/clickStreamTracker","clickstream-dotcom/javascript/siteConfig"],function(e,t){t.assignCategory(),t.assignWindowSize(),e.setOptions({supportedHosts:["www.bestbuy.com","blackfriday.bestbuy.com","www-ssl.bestbuy.com","espanol.bestbuy.com","deals.bestbuy.com","espanol-ssl.bestbuy.com"],defaultParameters:{transformed:!0},overrideAnalytics:!0}),e.startTracking(t.getPageModules())}),define("clickstream-dotcom/javascript/clickStreamInit",function(){});