/* Src File:"analytics-dotcom/externalTeams/parrot.min-b26fe32384183012de61322a553cd05d.js" @ Wed Dec 02 2015 13:59:36 GMT-0600 (CST) Group_ID: com.bestbuy.frontend.dio GIT_BRANCH: origin/release/15.50.1 BUILD_CAUSE: MANUALTRIGGER Build Version: 15.50.2 */

$(document).ready(function(){var e,n,t,r,o,u,a,i=[].slice;o="undefined"!=typeof module&&null!==module&&!("undefined"!=typeof window&&null!==window?window.module:void 0),o?(e=require("xmlhttprequest").XMLHttpRequest,a=function(){var e;return e=process.hrtime(),1e3*(e[0]+e[1]/1e9)}):a=function(){var e,n;return null!=(e=null!=(n=window.performance)&&"function"==typeof n.now?n.now():void 0)?e:+new Date},r=+new Date,t=function(){var e,n,t,r,o,u,a;for(e=arguments[0],r=2<=arguments.length?i.call(arguments,1):[],u=0,a=r.length;a>u;u++){t=r[u];for(n in t)o=t[n],e[n]=o}return e},u=function(){var e,n;return e=1<=arguments.length?i.call(arguments,0):[],null!=("undefined"!=typeof console&&null!==console&&null!=(n=console.log)?n.call:void 0)?console.log.apply(console,e):void 0},u.error=function(){var e,n;return e=1<=arguments.length?i.call(arguments,0):[],null!=("undefined"!=typeof console&&null!==console&&null!=(n=console.error)?n.call:void 0)?console.error.apply(console,e):void 0},n=function(){var n,l,s,c,d,f,p,m,g,v,w,y,h,T,q,S,P,L,R,x,M,b,E,K,k,X,H,I,A,C;if($.ajaxPrefilter(function(e,n,t){try{var r=new Date;n.method;t.always(function(){if(s){var e=new Date,o=e.getTime()-r.getTime(),u=h().requests.urlToKey(n.url,n.type);g(k+".ajax."+u,o,"timer"),g(k+".ajax."+u+"."+t.status,1,"counter")}})}catch(o){u.error("Parrot errored tracking AJAX call: "+o.message)}}),m={host:"/parrot",maxInterval:3e4,aggregationInterval:5e3,decimalPrecision:3,sendLatency:!1,sample:1,active:!0},b={},!o&&(n="function"==typeof document.querySelector?document.querySelector("[data-parrot-host],[data-parrot-page],[data-parrot-requests]"):void 0))for(b={host:n.getAttribute("data-parrot-host"),pagePerformanceKey:n.getAttribute("data-parrot-page"),requestsKey:n.getAttribute("data-parrot-requests")},I=["pagePerformanceKey","requestsKey"],X=0,H=I.length;H>X;X++)w=I[X],"true"===(null!=(A=b[w])?A.toString().toLowerCase():void 0)||""===b[w]?b[w]=!0:"false"===(null!=(C=b[w])?C.toString().toLowerCase:void 0)&&(b[w]=null);return S=t({},m,b),d={timer:"ms",gauge:"g",counter:"c"},l=S.active,s=!1,(E=function(){return s=S.ajax_active,l=S.active&&Math.random()<S.sample})(),c=[],M=function(e){return t(S,e),("sample"in e||"active"in e)&&E(),S},L=function(e,n){return null==n&&(n=S.decimalPrecision),Math.round(e*Math.pow(10,n))/Math.pow(10,n)},P={},g=function(e,n,t){var r,o;if(l)return r=1,e in P&&("counter"===t?n+=P[e].value:(r=null!=(o=P[e].count)?o:r,r++,n=P[e].value+(n-P[e].value)/r)),P[e]={value:n,type:t,count:r},p()},x=null,q=null,v=function(){return clearTimeout(x),clearTimeout(q),q=null,x=null,R()},p=function(){return clearTimeout(x),x=setTimeout(v,S.aggregationInterval),null==q?q=setTimeout(v,S.maxInterval):void 0},T=function(n){var t,r,u,i,l,s,c,d,f,p;r=o||window.XMLHttpRequest&&(window.XMLHttpRequest.defake||"withCredentials"in new window.XMLHttpRequest),o?c=!0:(u=/^(https?:\/\/[^\/]+)/i.exec(S.host),u?(l=u[1],c=l===""+document.location.protocol+"//"+document.location.host?!0:!1):c=!0),d=a(),t="";for(i in n)f=n[i],t+=""+i+":"+f+"\n";return s=c||r||null==("undefined"!=typeof window&&null!==window?window.XDomainRequest:void 0)?new(null!=(p="undefined"!=typeof window&&null!==window?window.XMLHttpRequest:void 0)?p:e):new window.XDomainRequest,s.parrot={track:!1},s.open("POST",""+S.host+"/v1/send",!0),s.setRequestHeader("Content-Type","text/plain"),s.addEventListener("load",function(){return K(a()-d)},!1),s.send(t),s},R=function(){var e,n,t,r;if(!l)return void u("Would send parrot queue");e={};for(w in P)n=P[w],c.push({path:w,count:n.count,type:n.type,value:n.value}),null!=d[n.type]?(t=n.value,("gauge"===(r=n.type)||"timer"===r)&&(t=L(t)),e[w]=""+t+"|"+d[n.type],1!==n.count&&(e[w]+="@"+L(1/n.count,5))):u.error("Type "+n.type+" not understood by Parrot");return T(e),P={}},y=!1,K=function(e){return S.sendLatency&&!y?(g("parrot.latency",e,"timer"),y=!0,setTimeout(function(){return y=!1},3e5)):void 0},h=function(e){function n(e,n){var t=new RegExp(e+"=([A-Za-z0-9-_]+)"),r=n.match(t);return void 0!=r?r[1]:!1}var t,o,s,d,f,p,m,y,T,q;null==e&&(e=""),t=function(n){return(null!=e?e.length:void 0)?e+"."+n:n},p=function(e,n,r){return null==r&&(r="gauge"),null==n||null==e?void u.error("Can't log "+e+":"+n):g(t(e),n,r)},T={TIMES:{},send:function(e,n){return p(e,n,"timer")},time:function(){var e,n,t,r,o;return o=arguments[0],e=arguments[1],t=arguments[2],n=4<=arguments.length?i.call(arguments,3):[],T.start(o),r=function(){return T.stop(o)},n.splice(0,0,r),e.apply(t,n)},timeSync:function(){var e,n,t,r,o;return r=arguments[0],e=arguments[1],t=arguments[2],n=4<=arguments.length?i.call(arguments,3):[],T.start(r),o=e.apply(t,n),T.stop(r),o},wrap:function(e,n){return null!=n?function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],T.timeSync.apply(T,[e,n,this].concat(i.call(t)))}:function(n){return function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],T.timeSync.apply(T,[e,n,this].concat(i.call(t)))}}},start:function(e){return T.TIMES[e]=a()},stop:function(e){var n;return null==T.TIMES[e]?void u.error("Timer "+e+" ended without having been started"):(n=a()-T.TIMES[e],T.TIMES[e]=void 0,T.send(e,n))},stopwatch:function(e,n){var t,r;return null!=n?r=function(){return+new Date}:(r=a,n=r()),t=n,{mark:function(t,o){var u;return null==o&&(o=0),u=r(),e&&(t=e+"."+t),T.send(t,u-n+o)},split:function(n,o){var u;return null==o&&(o=0),u=r(),e&&(n=e+"."+n),T.send(n,u-t+o),t=u}}},mark:function(e,n){var t;return null==n&&(n=+new Date),t=T.navigationStart(),T.send(e,n-t)},navigationStart:function(){var e,n,t;return null!=(e="undefined"!=typeof window&&null!==window&&null!=(n=window.performance)&&null!=(t=n.timing)?t.navigationStart:void 0)?e:r},responseEnd:function(){var e,n,t;return null!=(e="undefined"!=typeof window&&null!==window&&null!=(n=window.performance)&&null!=(t=n.timing)?t.responseEnd:void 0)?e:r},now:function(){return a()}},o=function(e,n){return null==n&&(n=1),p(e,n,"counter")},y=!1,m=function(e){var t,r,o,u,a,i=this,l=document.cookie,s=n("rumCask",l);if(!s&&n("kioskType",l)&&(s="kiosk"),s&&(e=e+"-"+s),null==("undefined"!=typeof window&&null!==window&&null!=(o=window.performance)?o.timing:void 0))return!1;if(y)return!1;if(e&&e!==!0||(e=f.urlToKey(document.location.toString())+".page"),k=e,"uninitialized"===(u=document.readyState)||"loading"===u)return"function"==typeof window.addEventListener&&window.addEventListener("load",function(){return setTimeout(function(){return m.call(i,e)},500)},!1),!1;y=!0,t=window.performance.timing.navigationStart,a=window.performance.timing;for(w in a)r=a[w],"number"==typeof r&&(r>0?T.send(""+e+"."+w,r-t):T.send(""+e+"."+w,r));return!0},f={transforms:{mapping:{guid:/\/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi,sha1:/\/[0-9a-f]{40}/gi,md5:/\/[0-9a-f]{32}/gi,id:/\/[0-9;_\-]+/g,email:/\/[^/]+@[^/]+/g,domain:[/\/[^/]+\.[a-z]{2,3}\//gi,"/"]},enabled:["guid","sha1","md5","id","email","domain"],enable:function(e,n,t){return null==t&&(t=""),null!=n&&(this.mapping[e]=[n,t]),this.enabled.splice(0,0,e)},disable:function(e){var n,t,r;r=this.enabled;for(n in r)if(t=r[n],t===e)return void this.enabled.splice(n,1)}},sendReadyStateTimes:function(e,n){var t,r,o,u,a,i,l,s;if(null!=n){r={1:"sending",2:"headers",3:"waiting",4:"receiving"},o={},u=null;for(t in n)i=n[t],null!=u&&null!=r[t]&&(o[r[t]]=i-u),u=i;s=[];for(a in o)l=o[a],s.push(T.send(""+e+"."+a,l));return s}},urlToKey:function(e,n,t){var r,o,a,i,l,s,c,d,p,m;for(e=e.replace(/https?:\/\//i,""),i=/([^/:]*)(?::\d+)?(\/[^\?#]*)?.*/i.exec(e),r=i[1],l=null!=(p=i[2])?p:"",m=f.transforms.enabled,c=0,d=m.length;d>c;c++)a=m[c],o=f.transforms.mapping[a],null!=o?"function"!=typeof o?(o instanceof RegExp&&(o=[o,""]),l=l.replace(o[0],o[1])):l=o(l,e,n,t):u.error("Parrot Error: Attempted to enable a mapping which is not defined: "+a);return l=decodeURIComponent(l),l=l.replace(/[^a-zA-Z0-9\-\.\/ ]+/g,"_"),s=r+l.replace(/[\/ ]/g,"."),s=s.replace(/(^\.)|(\.$)/g,""),s=s.replace(/\.com/,""),s=s.replace(/www\./,""),t&&(s=t+"."+s),n&&(s=s+"."+n.toLowerCase()),s=s.replace(/\.\./g,".")},getFullUrl:function(e,n){return null==n&&(n=document.location),/^\//.test(e)?n.hostname+e:/https?:\/\//i.test(e)?e:n.toString()+e},monitor:function(e){var n,t,r;return e&&e!==!0||(e=f.urlToKey(document.location.toString())+".requests"),t=this,n=function(n){var r,u,i,l,s,c,d,f;return d=n.type,f=n.url,u=n.event,l=n.request,i=n.readyStateTimes,s=n.startTime,null!=s?(r=a()-s,f=t.getFullUrl(f),c=t.urlToKey(f,d,e),p(c,r,"timer"),t.sendReadyStateTimes(c,i),null!=(null!=l?l.status:void 0)?(l.status>12e3?o(""+c+".0"):0!==l.status&&o(""+c+"."+l.status.toString().charAt(0)+"xx"),o(""+c+"."+l.status)):void 0):void 0},r=window.XMLHttpRequest,window.XMLHttpRequest=function(){var e,t,o,i,l,s;o=new r;try{i=null,t={},l=o.open,o.open=function(e,r,s){var c;try{t[0]=a(),o.addEventListener("readystatechange",function(){return t[o.readyState]=a()},!1),o.addEventListener("loadend",function(u){return null==o.parrot||o.parrot.track!==!1?n({type:e,url:r,event:u,startTime:i,readyStateTimes:t,request:o}):void 0},!1)}catch(d){c=d,u.error("Parrot error monitoring XHR open call",c)}return l.apply(o,arguments)},s=o.send,o.send=function(){return i=a(),s.apply(o,arguments)}}catch(c){e=c,u.error("Parrot error monitoring XHR",e)}return o}}},d=function(n){var t;return null==n&&(n=""),t=null!=e?e:"",t&&n&&(t+="."),n&&(t+=n),h(t)},s={send:p,count:o,timer:T,now:a,requests:f,sendPagePerformance:m,flush:v,setOptions:M,options:S,history:c,active:l};for(w in s)q=s[w],d[w]=q;return d},f=h(),S.pagePerformanceKey&&f.sendPagePerformance(S.pagePerformanceKey),S.requestsKey&&f.requests.monitor(S.requestsKey),f},"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n():window.Parrot=n()});